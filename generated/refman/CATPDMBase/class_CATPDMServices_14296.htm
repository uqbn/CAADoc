<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
 <meta http-equiv="Content-Language" content="en-us"> 
 <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
 <meta name="Generator" content="CppGene v1.1">
 <meta http-equiv="Expires" content="Tue, 04 Dec 1993 21:29:02 GMT">
 <title>CATPDMBase Class CATPDMServices</title>
<link rel="Stylesheet" type="text/css" href="../../../caav5.css">
<script language="Javascript" src="../_index/jslink.js"></script> 
<script language="Javascript" src="jsFwLink.js"></script> 
<script language="Javascript" type="text/javascript" src="../_index/jsTree.js"></script>  
</head>
<body>
<pre><a href="../_index/main.htm">All Frameworks</a>  <a href="../_index/tree.htm">Class Hierarchy</a>  <a href="../CATPDMBase.htm">This Framework</a>  <a href="../_index/HomeIdx.htm">Indexes</a>  <script type="text/javascript"> 
 var test=locateObject('CATPDMServices','class','0'); 
 if(test==1){ 
     document.write("<a href=\"#\" onclick=\"openLinkNP('CATPDMServices','class','0');return false\">Previous</a> "); 
 } 
 test=locateObject('CATPDMServices','class','1'); 
 if(test==1){ 
     document.write("<a href=\"#\" onclick=\"openLinkNP('CATPDMServices','class','1');return false\">Next</a> "); 
 } 
 </script> 
</pre>
<hr>
<h1>CATPDMBase Class CATPDMServices</h1>
<script type="text/javascript" > 
 generatedFatherClass('class_CATPDMServices_14296','CATPDMServices','0');</script>
<p><b>Usage: you must use this class as is. You should never derive it.</b></p>
<hr>
<p>
 public class <b>CATPDMServices</b>
</p>
<p>
<b><i> Class for PDM services.</i></b><br>

 <b>Role:</b>This class delivers services to be used either with ENOVIAvpm V4, either
 with ENOVIA V5 or both.
<ul>
 <li> <a href="#" onClick="openLink('CATPDMServices','LoadPDMDocument');return false">CATPDMServices.LoadPDMDocument</a> allows load in session a document coming from ENOVIAvpm V4 or ENOVIA V5. <li> 
<a href="#" onClick="openLink('CATPDMServices','CheckDocSave');return false">CATPDMServices.CheckDocSave</a> and 
<a href="#" onClick="openLink('CATPDMServices','GetDocumentsToSave');return false">CATPDMServices.GetDocumentsToSave</a> allows check if documents in session coming      from ENOVIAvpm V4 or ENOVIA V5 have been modified in session.
 <li> 
<a href="#" onClick="openLink('CATPDMServices','LoadNomadSession');return false">CATPDMServices.LoadNomadSession</a>, 
<a href="#" onClick="openLink('CATPDMServices','NomadDocumentProperties');return false">CATPDMServices.NomadDocumentProperties</a>,       
<a href="#" onClick="openLink('CATPDMServices','ReplicateDocument');return false">CATPDMServices.ReplicateDocument</a> and 
<a href="#" onClick="openLink('CATPDMServices','ReplaceDocument');return false">CATPDMServices.ReplaceDocument</a>       are methods dedicated to manage the Nomad session for ENOVIAvpm V4.
 <li> 
<a href="#" onClick="openLink('CATPDMServices','DisplayMessage');return false">CATPDMServices.DisplayMessage</a>, 
<a href="#" onClick="openLink('CATPDMServices','vDisplayMessage');return false">CATPDMServices.vDisplayMessage</a>       and 
<a href="#" onClick="openLink('CATPDMServices','KeepQuiet');return false">CATPDMServices.KeepQuiet</a> are methods to manage conditional display of error messages of the CATPDMBase framework. <li> 
<a href="#" onClick="openLink('CATPDMServices','ResetPDMDocuments');return false">CATPDMServices.ResetPDMDocuments</a> allows reset PDM properties on documents coming from ENOVIAvpm V4 or ENOVIA V5    to convert them as filebase documents.
</ul>
</p>
<hr>
 <h2>Constructor and Destructor Index</h2> <br>
<dl>
 <dt> o 
    <a href="#CATPDMServices()"><b>CATPDMServices</b></a>()
<dd>  <dt> o 
    <a href="#~CATPDMServices()"><b>~CATPDMServices</b></a>()
<dd> </dl>
 <h2>Method Index</h2> <br>
<dl>
 <dt> o 
    <a href="#CATAnalyseDocIdFromVPM(CATIDocId*,CATUnicodeString&amp;,CATUnicodeString&amp;,CATUnicodeString&amp;,CATUnicodeString&amp;)"><b>CATAnalyseDocIdFromVPM</b></a>(CATIDocId*,CATUnicodeString&amp;,CATUnicodeString&amp;,CATUnicodeString&amp;,CATUnicodeString&amp;)
<dd>  Returns the COID, COMPID, Table name and Environment name of a ENOVIAvpm V4 document.
 <dt> o 
    <a href="#CATAnalysePrintableIDFromVPM(CATUnicodeString,CATUnicodeString&amp;,CATUnicodeString&amp;,CATUnicodeString&amp;,CATUnicodeString&amp;,CATListOfCATUnicodeString&amp;)"><b>CATAnalysePrintableIDFromVPM</b></a>(CATUnicodeString,CATUnicodeString&amp;,CATUnicodeString&amp;,CATUnicodeString&amp;,CATUnicodeString&amp;,CATListOfCATUnicodeString&amp;)
<dd>  Parses a ENOVIAvpm V4 printable Id.
 <dt> o 
    <a href="#CheckDocSave(CATDocument*,CATBoolean&amp;)"><b>CheckDocSave</b></a>(CATDocument*,CATBoolean&amp;)
<dd>   Checks if a document in session and its pointed documents can be saved.
 <dt> o 
    <a href="#DisplayMessage(CATErrorType,char*,int,CATUnicodeString*,...)"><b>DisplayMessage</b></a>(CATErrorType,char*,int,CATUnicodeString*,...)
<dd>  Displays an error message.
 <dt> o 
    <a href="#GetDocumentsToSave(CATDocument*,CATLISTP(CATDocument)*)"><b>GetDocumentsToSave</b></a>(CATDocument*,CATLISTP(CATDocument)*)
<dd>   Retrieves the pointed documents that need to be saved before the reference document.
 <dt> o 
    <a href="#GetPrintableId(CATBaseUnknown*&amp;,CATUnicodeString&amp;)"><b>GetPrintableId</b></a>(CATBaseUnknown*&amp;,CATUnicodeString&amp;)
<dd>  Get a printable Id for a PDM instance or PDM document.
 <dt> o 
    <a href="#KeepQuiet(boolean*)"><b>KeepQuiet</b></a>(boolean*)
<dd>  Controls weither meaningfull error are to be displayed or not in user report.
 <dt> o 
    <a href="#LoadNomadSession(CATUnicodeString&amp;,CATLISTP(CATIDocId)*,CATLISTP(CATDocument)*)"><b>LoadNomadSession</b></a>(CATUnicodeString&amp;,CATLISTP(CATIDocId)*,CATLISTP(CATDocument)*)
<dd>     Loads in CATIA session a whole Nomad Session.
 <dt> o 
    <a href="#LoadPDMDocument(int,CATLISTP(CATIDocId)*,CATLISTP(CATDocument)*,CATLISTP(CATDocument)*)"><b>LoadPDMDocument</b></a>(int,CATLISTP(CATIDocId)*,CATLISTP(CATDocument)*,CATLISTP(CATDocument)*)
<dd>     Load in CATIA V5 session CATIA documents stored in a ENOVIA database.
 <dt> o 
    <a href="#NomadDocumentProperties(CATUnicodeString&amp;,CATLISTP(CATDocument)*&amp;,CATListOfCATBoolean*&amp;,CATListOfCATUnicodeString*&amp;)"><b>NomadDocumentProperties</b></a>(CATUnicodeString&amp;,CATLISTP(CATDocument)*&amp;,CATListOfCATBoolean*&amp;,CATListOfCATUnicodeString*&amp;)
<dd>    Returns information on documents of the Nomad session.
 <dt> o 
    <a href="#ReplaceDocument(CATDocument*)"><b>ReplaceDocument</b></a>(CATDocument*)
<dd>     Replaces in PDM a CATIA Document coming from a Nomad session.
 <dt> o 
    <a href="#ReplicateDocument(CATUnicodeString&amp;,CATDocument*)"><b>ReplicateDocument</b></a>(CATUnicodeString&amp;,CATDocument*)
<dd>     Exports a PDM Document in a filebase Nomad session.
 <dt> o 
    <a href="#ResetPDMDocuments(CATLISTP(CATDocument)*&amp;,CATLISTP(CATDocument)*&amp;)"><b>ResetPDMDocuments</b></a>(CATLISTP(CATDocument)*&amp;,CATLISTP(CATDocument)*&amp;)
<dd>  Resets PDM documents properties.
 <dt> o 
    <a href="#vDisplayMessage(CATErrorType,char*,char*,int,CATUnicodeString*,va_list)"><b>vDisplayMessage</b></a>(CATErrorType,char*,char*,int,CATUnicodeString*,va_list)
<dd>  Displays an error message.
</dl>
<dl>
</dl>
<dl>
</dl>
 <h2>Constructor and Destructor</h2> <br>
<a name="CATPDMServices"></a><a name="CATPDMServices()"></a> <dt> o <b>CATPDMServices</b>

<dt>  <table><tr><td>  public <script type="text/javascript"> activateLink('','')</script>  <b>CATPDMServices</b>(<td>)<script type="text/javascript"> activateLink('','')</script>  </table></dt>
<dl>
  <dd>
</dl>
<a name="~CATPDMServices"></a><a name="~CATPDMServices()"></a> <dt> o <b>~CATPDMServices</b>

<dt>  <table><tr><td>  public virtual <script type="text/javascript"> activateLink('','')</script>  <b>~CATPDMServices</b>(<td>)<script type="text/javascript"> activateLink('','')</script>  </table></dt>
<dl>
  <dd>
</dl>
 <h2>Methods</h2> <br>
<a name="CATAnalyseDocIdFromVPM"></a><a name="CATAnalyseDocIdFromVPM(CATIDocId*,CATUnicodeString&amp;,CATUnicodeString&amp;,CATUnicodeString&amp;,CATUnicodeString&amp;)"></a> <dt> o <b>CATAnalyseDocIdFromVPM</b>

<dt>  <table><tr><td>  public static <script type="text/javascript"> activateLink('HRESULT','HRESULT')</script>  <b>CATAnalyseDocIdFromVPM</b>(<td><script type="text/javascript"> activateLink('CATIDocId','CATIDocId*')</script> <td><tt>iDocID</tt>,<tr><td></td><td><script type="text/javascript"> activateLink('CATUnicodeString','CATUnicodeString&amp;')</script> <td><tt>oCoid</tt>,<tr><td></td><td><script type="text/javascript"> activateLink('CATUnicodeString','CATUnicodeString&amp;')</script> <td><tt>oCompid</tt>,<tr><td></td><td><script type="text/javascript"> activateLink('CATUnicodeString','CATUnicodeString&amp;')</script> <td><tt>oCaenv</tt>,<tr><td></td><td><script type="text/javascript"> activateLink('CATUnicodeString','CATUnicodeString&amp;')</script> <td><tt>oCatab</tt>)<script type="text/javascript"> activateLink('','')</script>  </table></dt>
<dl>
  <dd>
 Returns the COID, COMPID, Table name and Environment name of a ENOVIAvpm V4 document.

 <br><b>Role:</b>This method returns the Coid, Compid, Table name and Environment name of a document loaded in session.
<br>
 Use <tt>PSNInteroperability.CATComputeDocId</tt> to get a document Identifier for ENOVIAvpm V4. 
 <br> This method supports only documents coming from ENOVIAvpm V4.
<p>
 
<dl>
  <dt> <b>Parameters:</b>
  <dd>
    <dl>
    <dt><tt> iDocID</tt>
   <dd>    Document Identifier
 </dd>
    <dt><tt> oCoid</tt>
   <dd>    Coid of the document in ENOVIAvpm V4(Hexadecimal 16 crc long)
 </dd>
    <dt><tt> oCompid</tt>
   <dd>    Compid of the document in ENOVIAvpm V4(Hexadecimal 16 crc long)
 </dd>
    <dt><tt> oCatenv</tt>
   <dd>    the VPM environment name of the document  (8 crc long).
<br> For instance <tt>"VPMENV  "</tt>
 </dd>
    <dt><tt> oCatab</tt>
   <dd>    the VPM table name of the document (18 crc long). 
 <br> For instance <tt>"DOCUMENT         "</tt> for a V5 document
 </dd>
</dl>
  <dt> <b>Returns:</b> 
  <dd>     <ul>
   <li><tt>S_OK</tt>: All parameters are successfuly returned</li> 
   <li><tt>E_FAIL</tt>: The document is not a ENOVIAvpm V4 document</li>
   <li><tt>E_FAIL</tt>: The method has failed </li> 
   </ul>
</dl>
</dl>
<a name="CATAnalysePrintableIDFromVPM"></a><a name="CATAnalysePrintableIDFromVPM(CATUnicodeString,CATUnicodeString&amp;,CATUnicodeString&amp;,CATUnicodeString&amp;,CATUnicodeString&amp;,CATListOfCATUnicodeString&amp;)"></a> <dt> o <b>CATAnalysePrintableIDFromVPM</b>

<dt>  <table><tr><td>  public static <script type="text/javascript"> activateLink('HRESULT','HRESULT')</script>  <b>CATAnalysePrintableIDFromVPM</b>(<td> const <script type="text/javascript"> activateLink('CATUnicodeString','CATUnicodeString')</script> <td><tt>iPrintableID</tt>,<tr><td></td><td><script type="text/javascript"> activateLink('CATUnicodeString','CATUnicodeString&amp;')</script> <td><tt>oCoid</tt>,<tr><td></td><td><script type="text/javascript"> activateLink('CATUnicodeString','CATUnicodeString&amp;')</script> <td><tt>oCompid</tt>,<tr><td></td><td><script type="text/javascript"> activateLink('CATUnicodeString','CATUnicodeString&amp;')</script> <td><tt>oCaenv</tt>,<tr><td></td><td><script type="text/javascript"> activateLink('CATUnicodeString','CATUnicodeString&amp;')</script> <td><tt>oCatab</tt>,<tr><td></td><td><script type="text/javascript"> activateLink('CATListOfCATUnicodeString','CATListOfCATUnicodeString&amp;')</script> <td><tt>oClink</tt>)<script type="text/javascript"> activateLink('','')</script>  </table></dt>
<dl>
  <dd>
 Parses a ENOVIAvpm V4 printable Id.

 <br><b>Role:</b>This method parses a printable Id you have got using 
<a href="#" onClick="openLink('CATPDMServices','GetPrintableId');return false">CATPDMServices.GetPrintableId</a>  on a ENOVIAvpm V4 product structure instance (Product or document). It returns explicit information contained
 in the printable Id:
 <ul>
   <li>the Coid</li>
   <li>the Compid</li>
   <li>the Environment name</li>
   <li>the Table name</li>
   <li>the CLINK list Link information:
      <ul>
         <li>if the printable Id comes from the Root node of the product structure, the list is empty </li>
         <li>if the printable Id comes from an instance at level N of the product structure, 
             the list contains N elements</li>  
      </ul>
    </li>
 </ul>

<p>
 
<dl>
  <dt> <b>Parameters:</b>
  <dd>
    <dl>
    <dt><tt> iPrintableID</tt>
   <dd>    Printable Id as returned by </dd>
<a href="#" onClick="openLink('CATPDMServices','GetPrintableId');return false">CATPDMServices.GetPrintableId</a> 
    <dt><tt> oCoid</tt>
   <dd>    Coid of the entity in ENOVIAvpm V4(Hexadecimal 16 crc long)
 </dd>
    <dt><tt> oCompid</tt>
   <dd>    Compid of the entity in ENOVIAvpm V4(Hexadecimal 16 crc long)
 </dd>
    <dt><tt> oCatenv</tt>
   <dd>    the VPM environment name of the entity  (8 crc long).
<br> For instance <tt>"VPMENV  "</tt>
 </dd>
    <dt><tt> oCatab</tt>
   <dd>    the VPM table name of the entity (18 crc long). 
 <br> For instance <tt>"PART_LIST        "</tt> for a part 
 <br>           or <tt>"DOCUMENT         "</tt> for a V5 document
 <br>           or <tt>"CATIA_MODEL      "</tt> for a V4 document
 </dd>
    <dt><tt> oClink</tt>
   <dd>    List of CLINKs.
 <br>A CLINK is the Link Information stored in <tt>$EXT</tt> Table (Hexadecimal 16 crc long)

 </dd>
</dl>
  <dt> <b>Returns:</b> 
  <dd>     <ul>
    <li><tt>S_OK</tt>: Parsing is successfull</li> 
    <li><tt>E_FAIL</tt>: Invalid input argument</li> 
   </ul>
</dl>
</dl>
<a name="CheckDocSave"></a><a name="CheckDocSave(CATDocument*,CATBoolean&amp;)"></a> <dt> o <b>CheckDocSave</b>

<dt>  <table><tr><td>  public static <script type="text/javascript"> activateLink('HRESULT','HRESULT')</script>  <b>CheckDocSave</b>(<td><script type="text/javascript"> activateLink('CATDocument','CATDocument*')</script> <td><tt>iDoc</tt>,<tr><td></td><td><script type="text/javascript"> activateLink('CATBoolean','CATBoolean&amp;')</script> <td><tt>oSavePossible</tt>)<script type="text/javascript"> activateLink('','')</script>  </table></dt>
<dl>
  <dd>
  Checks if a document in session and its pointed documents can be saved.

 <br><b>Role:</b>This method allows check if a document in session has 
 pointed documents that are dirty.
 In case some pointed documents are dirty (return code=<tt>S_FALSE</tt>), 
 a dialog panel is displayed asking the user to confirm if he wants
 or not to save the document:
	<ul>
	<li><tt>YES</tt> button to proceed with save</li>
	<li><tt>NO</tt> button to not proceed with save</li>
	</ul>
	In batch mode, the panel is not displayed and <tt>oSavePossible</tt> value is <tt>S_FALSE</tt>.
 <br><b>Note:</b> This method doesn't perform the Save. It does only the check.
 <br> This method supports documents coming from ENOVIAvpm V4 or ENOVIA V5.
<p>
    
<dl>
  <dt> <b>Parameters:</b>
  <dd>
    <dl>
    <dt><tt> iDoc</tt>
   <dd>      Document to be checked for save.
    </dd>
    <dt><tt> oSavePossible</tt>
   <dd>		Only in case some pointed documents are dirty:
		<ul>
      <li><tt>S_OK</tt>: The user has selected YES in the confirmation panel.</li>
      <li><tt>S_FALSE</tt>:  The user has selected NO in the confirmation panel.</li> 
		</ul>
		In batch mode, <tt>S_FALSE</tt> only possible value.

    </dd>
</dl>
  <dt> <b>Returns:</b> 
  <dd>    <ul>
   <li><tt>S_OK</tt>: No pointed document is dirty. </li>
   <li><tt>S_FALSE</tt>: Some pointed documents are dirty.</li>
   <li><tt>E_FAIL</tt>: NULL pointer as input document.</li>
   <li><tt>E_FAIL</tt>: The method failed.</li>
   </ul>
</dl>
</dl>
<a name="DisplayMessage"></a><a name="DisplayMessage(CATErrorType,char*,int,CATUnicodeString*,...)"></a> <dt> o <b>DisplayMessage</b>

<dt>  <table><tr><td>  public static <script type="text/javascript"> activateLink('void','void')</script>  <b>DisplayMessage</b>(<td><script type="text/javascript"> activateLink('CATErrorType','CATErrorType')</script> <td><tt>iLevel</tt>,<tr><td></td><td> const <script type="text/javascript"> activateLink('char','char*')</script> <td><tt>iMsgKey</tt>,<tr><td></td><td><script type="text/javascript"> activateLink('int','int')</script> <td><tt>nbArgs</tt><td><tt>=0</tt>,<tr><td></td><td> const <script type="text/javascript"> activateLink('CATUnicodeString','CATUnicodeString*')</script> <td><tt>iArgs</tt><td><tt>=NULL</tt>,<tr><td></td><td><script type="text/javascript"> activateLink('...','...')</script> <td><tt></tt>)<script type="text/javascript"> activateLink('','')</script>  </table></dt>
<dl>
  <dd>
 Displays an error message.
 <br><b>Role:</b>This method displays an error message if the 
<a href="#" onClick="openLink('CATPDMServices','KeepQuiet');return false">CATPDMServices.KeepQuiet</a> current mode is <tt>FALSE</tt>. This message is displayed either:
 <ul>
   <li> in the session error reporter if the environment variable <tt>CV5_EV5_ErrorReporter</tt>
      is not active
   <li> in error dialog box, if not in batch mode
   <li> only in the output window, if in batch mode
 </ul>
 <br><b>Note:</b> This method has the same purpose as 
<a href="#" onClick="openLink('CATPDMServices','vDisplayMessage');return false">CATPDMServices.vDisplayMessage</a> with   <tt>iMsgCtlg = "CATPDMBase"</tt>.
 
<dl>
  <dt> <b>See also:</b> 
  <dd> <a href="#" onClick="openLink('CATPDMServices','vDisplayMessage');return false">CATPDMServices.vDisplayMessage</a>
  <dt> <b>Parameters:</b>
  <dd>
    <dl>
    <dt><tt> iLevel</tt>
   <dd>         The error level 
  </dd>
    <dt><tt> iMsgKey</tt>
   <dd>        Identifier of the error message in the NLS file (without the prefix, ERR_, WRN_, INF_ ).
     <br>
     This prefix is automatically added by the MsgReporter:
		<ul>
		<li><tt>ERR_</tt> for Critical and Fatal </li>
       <li><tt>WRN_</tt> for Warning </li>
       <li><tt>INF_</tt> for Information </li>
		</ul>
  </dd>
    <dt><tt> nbArgs</tt>
   <dd>        Nb of optional arguments
  </dd>
    <dt><tt> iArgs</tt>
   <dd>       Optional arguments of the error message, identified by <tt>/p1</tt>, <tt>/p2</tt>, ... in the NLS</dd>
</dl>
</dl>
</dl>
<a name="GetDocumentsToSave"></a><a name="GetDocumentsToSave(CATDocument*,CATLISTP(CATDocument)*)"></a> <dt> o <b>GetDocumentsToSave</b>

<dt>  <table><tr><td>  public static <script type="text/javascript"> activateLink('HRESULT','HRESULT')</script>  <b>GetDocumentsToSave</b>(<td><script type="text/javascript"> activateLink('CATDocument','CATDocument*')</script> <td><tt>iDoc</tt>,<tr><td></td><td><script type="text/javascript"> activateLink('CATLISTP(CATDocument)','CATLISTP(CATDocument)*')</script> <td><tt>oDocsTosave</tt>)<script type="text/javascript"> activateLink('','')</script>  </table></dt>
<dl>
  <dd>
  Retrieves the pointed documents that need to be saved before the reference document. 

 <br><b>Role:</b>This method checks if a PDM document in session meant to be saved
  has pointed documents that are dirty. In case some pointed documents are dirty, 
 the method returns the list of pointed documents that need to be saved before the input document.
 <br> This method supports documents coming from ENOVIAvpm V4 or ENOVIA V5.
<br><b>Note:</b> Only CATProduct type document is supported as input document.
<p>
    
<dl>
  <dt> <b>Parameters:</b>
  <dd>
    <dl>
    <dt><tt> iDoc</tt>
   <dd>      Document to check for save.
    </dd>
    <dt><tt> oDocsToSave</tt>
   <dd>      List of the documents that need to be saved before current document.

    </dd>
</dl>
  <dt> <b>Returns:</b> 
  <dd>    <ul>
   <li><tt>S_OK</tt>: No pointed document is dirty. </li>
   <li><tt>E_FAIL</tt>: NULL pointer as input document.</li>
   <li><tt>E_FAIL</tt>: The method failed.</li>
   </ul>
</dl>
</dl>
<a name="GetPrintableId"></a><a name="GetPrintableId(CATBaseUnknown*&amp;,CATUnicodeString&amp;)"></a> <dt> o <b>GetPrintableId</b>

<dt>  <table><tr><td>  public static <script type="text/javascript"> activateLink('HRESULT','HRESULT')</script>  <b>GetPrintableId</b>(<td><script type="text/javascript"> activateLink('CATBaseUnknown','CATBaseUnknown*&amp;')</script> <td><tt>iProduct</tt>,<tr><td></td><td><script type="text/javascript"> activateLink('CATUnicodeString','CATUnicodeString&amp;')</script> <td><tt>oPrintableId</tt>)<script type="text/javascript"> activateLink('','')</script>  </table></dt>
<dl>
  <dd>
 Get a printable Id for a PDM instance or PDM document.

<br><b>Role:</b>This method returns a printable Id for a PDM instance or a PDM document.
 <ul>
  <li>ENOVIAvpm V4 Usage:
  <br>
  You must use 
<a href="#" onClick="openLink('CATPDMServices','CATAnalysePrintableIDFromVPM');return false">CATPDMServices.CATAnalysePrintableIDFromVPM</a> to parse the printable Id to COID, COMPID,  CATENV, CATAB and CLINKS values.
  </li>
 </ul>
 <br> This method supports instances and documents coming from ENOVIAvpm V4.
 
<dl>
  <dt> <b>Parameters:</b>
  <dd>
    <dl>
    <dt><tt> iProduct</tt>
   <dd>        Pointer to the Product
 </dd>
    <dt><tt> oPrintableId</tt>
   <dd>        Ouput parameter giving the printable Id of the PDM product
 </dd>
</dl>
  <dt> <b>Returns:</b> 
  <dd>    <ul>
   <li><tt>S_OK</tt>: Printable Id successfuly returned. </li>
   <li><tt>E_FAIL</tt>: The method failed.</li>
   </ul>
</dl>
</dl>
<a name="KeepQuiet"></a><a name="KeepQuiet(boolean*)"></a> <dt> o <b>KeepQuiet</b>

<dt>  <table><tr><td>  public static <script type="text/javascript"> activateLink('boolean','boolean')</script>  <b>KeepQuiet</b>(<td><script type="text/javascript"> activateLink('boolean','boolean*')</script> <td><tt>iDoNotTalk</tt><td><tt>=NULL</tt>)<script type="text/javascript"> activateLink('','')</script>  </table></dt>
<dl>
  <dd>
 Controls weither meaningfull error are to be displayed or not in user report.

 <br><b>Role:</b>This method controls weither meaningfull errors are to be displayed or not 
 for user report purpose, and accordingly has a direct effect 
 on 
<a href="#" onClick="openLink('CATPDMServices','DisplayMessage');return false">CATPDMServices.DisplayMessage</a> and 
<a href="#" onClick="openLink('CATPDMServices','vDisplayMessage');return false">CATPDMServices.vDisplayMessage</a> <br>
 The typical usage is just reading the KeepQuiet Mode: 
 <pre>
          if (CATPDMServices::KeepQuiet()) then "do not report error";
 </pre>
<br>
 Another typical usage is to change locally the mode and then to restore it as it was:
 <pre>
         boolean do_not_talk=TRUE; 
         boolean was_eventually_talking=CATPDMServices::KeepQuiet(&do_not_talk); 
         ...some application code then...  
         CATPDMServices::KeepQuiet(&was_eventually_talking); 
 </pre>
      
<dl>
  <dt> <b>See also:</b> 
  <dd> <a href="#" onClick="openLink('CATPDMServices','DisplayMessage');return false">CATPDMServices.DisplayMessage</a>, <br>
<a href="#" onClick="openLink('CATPDMServices','vDisplayMessage');return false">CATPDMServices.vDisplayMessage</a> <p> 
  
  <dt> <b>Parameters:</b>
  <dd>
    <dl>
    <dt><tt> iDoNotTalk</tt>
   <dd>		<i>optional:</i> sets the next KeepQuiet mode:
		<ul>
		<li><tt>TRUE</tt> active registration of meaningfull errors</li> 
       <li><tt>FALSE</tt> deactive registration of meaningfull errors</li>
		</ul>
  
  </dd>
</dl>
  <dt> <b>Returns:</b> 
  <dd>       the current KeepQuiet mode:
		<ul>
		 <li><tt>TRUE</tt> Quiet mode activated</li> 
        <li><tt>FALSE</tt> Quiet mode deactivated</li> (<i>Default</i>)
		</ul>
</dl>
</dl>
<a name="LoadNomadSession"></a><a name="LoadNomadSession(CATUnicodeString&amp;,CATLISTP(CATIDocId)*,CATLISTP(CATDocument)*)"></a> <dt> o <b>LoadNomadSession</b>

<dt>  <table><tr><td>  public static <script type="text/javascript"> activateLink('HRESULT','HRESULT')</script>  <b>LoadNomadSession</b>(<td><script type="text/javascript"> activateLink('CATUnicodeString','CATUnicodeString&amp;')</script> <td><tt>iNomadPath</tt>,<tr><td></td><td><script type="text/javascript"> activateLink('CATLISTP(CATIDocId)','CATLISTP(CATIDocId)*')</script> <td><tt>oListDocumentId</tt>,<tr><td></td><td><script type="text/javascript"> activateLink('CATLISTP(CATDocument)','CATLISTP(CATDocument)*')</script> <td><tt>oLoadedDocuments</tt>)<script type="text/javascript"> activateLink('','')</script>  </table></dt>
<dl>
  <dd>
    Loads in CATIA session a whole Nomad Session.

 <br><b>Role:</b>This method loads in the CATIA session the whole Nomad session from
 the input Nomad session file.
<p>
      
<dl>
  <dt> <b>See also:</b> 
  <dd> <a href="#" onClick="openLink('CATPDMServices','ReplaceDocument');return false">CATPDMServices.ReplaceDocument</a>, <br>
<a href="#" onClick="openLink('CATPDMServices','NomadDocumentProperties');return false">CATPDMServices.NomadDocumentProperties</a> <br> 
<a href="#" onClick="openLink('CATPDMServices','ReplicateDocument');return false">CATPDMServices.ReplicateDocument</a> <p>
    
  <dt> <b>Parameters:</b>
  <dd>
    <dl>
    <dt><tt> iNomadPath</tt>
   <dd>      Path of the directory where the Nomad Session file is located.
    </dd>
    <dt><tt> oListDocumentId</tt>
   <dd>      List of the document identifiers for the documents that have been loaded.
    </dd>
    <dt><tt> oLoadedDocument</tt>
   <dd>      List of the CATIA Documents that have been loaded.

    </dd>
</dl>
  <dt> <b>Returns:</b> 
  <dd>    <ul>
   <li><tt>S_OK</tt>: Nomad session succeesfuly loaded. </li>
   <li><tt>S_FALSE</tt>: Nomad Session file not found</li>
   <li><tt>E_FAIL</tt>: Failed to load the nomad Session.</li>
   </ul>
</dl>
</dl>
<a name="LoadPDMDocument"></a><a name="LoadPDMDocument(int,CATLISTP(CATIDocId)*,CATLISTP(CATDocument)*,CATLISTP(CATDocument)*)"></a> <dt> o <b>LoadPDMDocument</b>

<dt>  <table><tr><td>  public static <script type="text/javascript"> activateLink('HRESULT','HRESULT')</script>  <b>LoadPDMDocument</b>(<td><script type="text/javascript"> activateLink('int','int')</script> <td><tt>iMode</tt>,<tr><td></td><td><script type="text/javascript"> activateLink('CATLISTP(CATIDocId)','CATLISTP(CATIDocId)*')</script> <td><tt>iListDocumentId</tt>,<tr><td></td><td><script type="text/javascript"> activateLink('CATLISTP(CATDocument)','CATLISTP(CATDocument)*')</script> <td><tt>oRequiredLoadedDocument</tt>,<tr><td></td><td><script type="text/javascript"> activateLink('CATLISTP(CATDocument)','CATLISTP(CATDocument)*')</script> <td><tt>oPointedLoadedDocuments</tt>)<script type="text/javascript"> activateLink('','')</script>  </table></dt>
<dl>
  <dd>
    Load in CATIA V5 session CATIA documents stored in a ENOVIA database.

 <br><b>Role:</b>This method allows load in the CATIA V5 session 
 the CATIA V5 documents and CATIA V4 models
 that are stored in a ENOVIAvpm V4 or ENOVIA VPM V5 database.
 <br>
    You can load a list of documents and choose to load the pointed
    documents as well. As a result, the method provides the list of the required 
    document and the list of the pointed documents implicitly loaded.
<br>
 Use <tt>PSNInteroperability.CATComputeDocId</tt> to get a document Identifier for ENOVIAvpm V4. 
<p>
    
<dl>
  <dt> <b>Parameters:</b>
  <dd>
    <dl>
    <dt><tt> iMode</tt>
   <dd>      To choose if pointed documents must be loaded in session:
		<ul>
		<li><tt>0</tt>: pointed documents are not loaded</li>
		<li><tt>1</tt>: pointed documents are loaded </li>
		</ul>
    </dd>
    <dt><tt> iListDocumentId</tt>
   <dd>      List of document identifiers to be loaded in session
    </dd>
    <dt><tt> oRequiredLoadedDocument</tt>
   <dd>      List of the CATIA Documents corresponding to the input 
      PDM document identifier list. If a document cannot 
      be loaded, the output list can contains NULL CATDocument 
      pointers.
<br>CATDocument pointers must be deleted by the caller.
    </dd>
    <dt><tt> oPointedLoadedDocument</tt>
   <dd>      List of the CATIA Documents implicitly loaded, only when <tt>iMode</tt> 
      is set to 1 (load of pointed document).
<br>CATDocument pointers must be deleted by the caller.

    </dd>
</dl>
  <dt> <b>Returns:</b> 
  <dd>    <ul>
   <li><tt>S_OK</tt>: Document(s)have been loaded. </li>
   <li><tt>S_FALSE</tt>: Document not found. Wrong Document identifier. </li>
   <li><tt>E_FAIL</tt>: Failed to load a document.</li>
   </ul>
</dl>
</dl>
<a name="NomadDocumentProperties"></a><a name="NomadDocumentProperties(CATUnicodeString&amp;,CATLISTP(CATDocument)*&amp;,CATListOfCATBoolean*&amp;,CATListOfCATUnicodeString*&amp;)"></a> <dt> o <b>NomadDocumentProperties</b>

<dt>  <table><tr><td>  public static <script type="text/javascript"> activateLink('HRESULT','HRESULT')</script>  <b>NomadDocumentProperties</b>(<td><script type="text/javascript"> activateLink('CATUnicodeString','CATUnicodeString&amp;')</script> <td><tt>iNomadPath</tt>,<tr><td></td><td><script type="text/javascript"> activateLink('CATLISTP(CATDocument)','CATLISTP(CATDocument)*&amp;')</script> <td><tt>oCATDocument</tt>,<tr><td></td><td><script type="text/javascript"> activateLink('CATListOfCATBoolean','CATListOfCATBoolean*&amp;')</script> <td><tt>oStatus</tt>,<tr><td></td><td><script type="text/javascript"> activateLink('CATListOfCATUnicodeString','CATListOfCATUnicodeString*&amp;')</script> <td><tt>oNomadName</tt>)<script type="text/javascript"> activateLink('','')</script>  </table></dt>
<dl>
  <dd>
   Returns information on documents of the Nomad session.

 <br><b>Role:</b>This method allows retrieve the modification status and the 
    Nomad identifier for each document of the Nomad session. 
<p>
      
<dl>
  <dt> <b>See also:</b> 
  <dd> <a href="#" onClick="openLink('CATPDMServices','ReplaceDocument');return false">CATPDMServices.ReplaceDocument</a>, <br>
<a href="#" onClick="openLink('CATPDMServices','LoadNomadSession');return false">CATPDMServices.LoadNomadSession</a> <br> 
<a href="#" onClick="openLink('CATPDMServices','ReplicateDocument');return false">CATPDMServices.ReplicateDocument</a> <p>
    
  <dt> <b>Parameters:</b>
  <dd>
    <dl>
    <dt><tt> iNomadPath</tt>
   <dd>      Path of the directory where the Nomad Session file is located.
    </dd>
    <dt><tt> oCATDocument</tt>
   <dd>      List of documents in the Nomad session.
    </dd>
    <dt><tt> oStatus</tt>
   <dd>      Status of each document of the Nomad session:
		<ul>
		<li><tt>TRUE</tt>: if document has been modified since its last database extraction.</li>
      <li><tt>FALSE</tt>: if the document has not been modified during its Nomad life.</li>
		</ul>
    </dd>
    <dt><tt> oNomadName</tt>
   <dd>      Nomad file Identifier of each document of the Nomad session
      (usually <tt>"DOC1"</tt>, <tt>"DOC2"</tt>,...etc).

    </dd>
</dl>
  <dt> <b>Returns:</b> 
  <dd>    <ul>
   <li><tt>S_OK</tt>: Properties successfuly returned . </li>
   <li><tt>S_FALSE</tt>: Empty Nomad Session.</li>
   <li><tt>E_FAIL</tt>: Failed to find the nomad Session.</li>
   </ul>
</dl>
</dl>
<a name="ReplaceDocument"></a><a name="ReplaceDocument(CATDocument*)"></a> <dt> o <b>ReplaceDocument</b>

<dt>  <table><tr><td>  public static <script type="text/javascript"> activateLink('HRESULT','HRESULT')</script>  <b>ReplaceDocument</b>(<td><script type="text/javascript"> activateLink('CATDocument','CATDocument*')</script> <td><tt>iDocument</tt>)<script type="text/javascript"> activateLink('','')</script>  </table></dt>
<dl>
  <dd>
    Replaces in PDM a CATIA Document coming from a Nomad session.

 <br><b>Role:</b>This method allows replace in PDM a CATIA document coming from a Nomad 
 session. The document to be saved must already exists in the PDM. 
<br>
 If the Nomad document in session has pointed documents in the same Nomad session,
  they will be also automatically replaced in PDM.
<p>
      
<dl>
  <dt> <b>See also:</b> 
  <dd> <a href="#" onClick="openLink('CATPDMServices','LoadNomadSession');return false">CATPDMServices.LoadNomadSession</a>, <br>
<a href="#" onClick="openLink('CATPDMServices','NomadDocumentProperties');return false">CATPDMServices.NomadDocumentProperties</a> <br> 
<a href="#" onClick="openLink('CATPDMServices','ReplicateDocument<p>
');return false">CATPDMServices.ReplicateDocument<p>
</a>    
  <dt> <b>Parameters:</b>
  <dd>
    <dl>
    <dt><tt> iDocument</tt>
   <dd>      Document to be replaced in the PDM.

    </dd>
</dl>
  <dt> <b>Returns:</b> 
  <dd>    <ul>
   <li><tt>S_OK</tt>: Document(s)have been replaced in PDM. </li>
   <li><tt>S_FALSE</tt>: Document cannot be replaced (already replaced, file document). </li>
   <li><tt>E_INVALIDARG</tt>: NULL pointer as input document.</li>
   <li><tt>E_FAIL</tt>: Failed to replace a document.</li>
   </ul>
</dl>
</dl>
<a name="ReplicateDocument"></a><a name="ReplicateDocument(CATUnicodeString&amp;,CATDocument*)"></a> <dt> o <b>ReplicateDocument</b>

<dt>  <table><tr><td>  public static <script type="text/javascript"> activateLink('HRESULT','HRESULT')</script>  <b>ReplicateDocument</b>(<td><script type="text/javascript"> activateLink('CATUnicodeString','CATUnicodeString&amp;')</script> <td><tt>iNomadPath</tt>,<tr><td></td><td><script type="text/javascript"> activateLink('CATDocument','CATDocument*')</script> <td><tt>iDocument</tt>)<script type="text/javascript"> activateLink('','')</script>  </table></dt>
<dl>
  <dd>
    Exports a PDM Document in a filebase Nomad session.

 <br><b>Role:</b>This method allows export a PDM document in a Nomad session file
  created in the dedicated directory. A Nomad session file has a "DocNomad" extension.
<br>
 If the document in session has pointed (PDM) documents, 
  they will be automatically exported too in the same Nomad session file.
<br><b>Note:</b> Only CATProduct type document is supported as input document.
<p>
      
<dl>
  <dt> <b>See also:</b> 
  <dd> <a href="#" onClick="openLink('CATPDMServices','LoadNomadSession');return false">CATPDMServices.LoadNomadSession</a>, <br>
<a href="#" onClick="openLink('CATPDMServices','NomadDocumentProperties');return false">CATPDMServices.NomadDocumentProperties</a> <br> 
<a href="#" onClick="openLink('CATPDMServices','ReplaceDocument<p>
');return false">CATPDMServices.ReplaceDocument<p>
</a>    
  <dt> <b>Parameters:</b>
  <dd>
    <dl>
    <dt><tt> iNomadPath</tt>
   <dd>      Path of directory where the Nomad Session file must be created.
    </dd>
    <dt><tt> iDocument</tt>
   <dd>      Document to replicate in the Nomad session file.

    </dd>
</dl>
  <dt> <b>Returns:</b> 
  <dd>    <ul>
   <li><tt>S_OK</tt>: Document(s)have been replicated in the Nomad session file. </li>
   <li><tt>S_FALSE</tt>: Document cannot be replicated (already replicated, file document). </li>
   <li><tt>E_FAIL</tt>: Failed to replicate a document.</li>
   <li><tt>E_INVALIDARG</tt>: NULL pointer as input document.</li>
   </ul>
</dl>
</dl>
<a name="ResetPDMDocuments"></a><a name="ResetPDMDocuments(CATLISTP(CATDocument)*&amp;,CATLISTP(CATDocument)*&amp;)"></a> <dt> o <b>ResetPDMDocuments</b>

<dt>  <table><tr><td>  public static <script type="text/javascript"> activateLink('HRESULT','HRESULT')</script>  <b>ResetPDMDocuments</b>(<td><script type="text/javascript"> activateLink('CATLISTP(CATDocument)','CATLISTP(CATDocument)*&amp;')</script> <td><tt>iDocumentsToReset</tt>,<tr><td></td><td><script type="text/javascript"> activateLink('CATLISTP(CATDocument)','CATLISTP(CATDocument)*&amp;')</script> <td><tt>oDocumentsReset</tt>)<script type="text/javascript"> activateLink('','')</script>  </table></dt>
<dl>
  <dd>
 Resets PDM documents properties.

 <br><b>Role:</b>This method allows reset the PDM properties of PDM documents loaded in session.
 As a result, the documents in session becomes File documents and have no more relation
 with the database they come from.
 <br><b>Important:</b> All pointing documents on these documents are reseted too.
 <br>Links beetween the reseted documents are updated accordingly in session.
 <br>The reseted documents get the Modified status in SaveManagement, meaning they become
 dirty and need to be saved.
 <br> This method supports all CATIA V5 types documents and CATIA V4 models. 
 <br> This method supports documents coming from ENOVIAvpm V4 or ENOVIA V5.
 <br> Filebase documents are supported too and are kept as filebase documents.
 
<dl>
  <dt> <b>Parameters:</b>
  <dd>
    <dl>
    <dt><tt> iDocumentsToReset</tt>
   <dd>    List of documents to reset.
 </dd>
    <dt><tt> oDocumentsReset</tt>
   <dd>    List of reseted documents.
 <br>This list is created by new and has to be remove and deleted by the caller.

 </dd>
</dl>
  <dt> <b>Returns:</b> 
  <dd>      <ul>
   <li><tt>S_OK</tt>: all the documents have been successfuly reseted. </li>
   <li><tt>E_FAIL</tt>: NULL pointer as input list.</li>
   <li><tt>E_FAIL</tt>: Failed reseting a document.</li>
   </ul>
</dl>
</dl>
<a name="vDisplayMessage"></a><a name="vDisplayMessage(CATErrorType,char*,char*,int,CATUnicodeString*,va_list)"></a> <dt> o <b>vDisplayMessage</b>

<dt>  <table><tr><td>  public static <script type="text/javascript"> activateLink('void','void')</script>  <b>vDisplayMessage</b>(<td><script type="text/javascript"> activateLink('CATErrorType','CATErrorType')</script> <td><tt>iLevel</tt>,<tr><td></td><td> const <script type="text/javascript"> activateLink('char','char*')</script> <td><tt>iMsgKey</tt>,<tr><td></td><td> const <script type="text/javascript"> activateLink('char','char*')</script> <td><tt>iMsgCtlg</tt>,<tr><td></td><td><script type="text/javascript"> activateLink('int','int')</script> <td><tt>nbArgs</tt>,<tr><td></td><td> const <script type="text/javascript"> activateLink('CATUnicodeString','CATUnicodeString*')</script> <td><tt>first</tt>,<tr><td></td><td><script type="text/javascript"> activateLink('va_list','va_list')</script> <td><tt>others</tt>)<script type="text/javascript"> activateLink('','')</script>  </table></dt>
<dl>
  <dd>
 Displays an error message.
 <br><b>Role:</b>This method displays an error message if the 
<a href="#" onClick="openLink('CATPDMServices','KeepQuiet');return false">CATPDMServices.KeepQuiet</a> current mode is <tt>FALSE</tt>. This message is displayed either:
 <ul>
   <li> in the session error reporter if the environment variable <tt>CV5_EV5_ErrorReporter</tt>
      is not active
   <li> in error dialog box, if not in batch mode
   <li> only in the output window, if in batch mode
 </ul>
 
<dl>
  <dt> <b>See also:</b> 
  <dd> <a href="#" onClick="openLink('CATPDMServices','DisplayMessage 
');return false">CATPDMServices.DisplayMessage 
</a>
  <dt> <b>Parameters:</b>
  <dd>
    <dl>
    <dt><tt> iLevel</tt>
   <dd>         The error level 
  </dd>
    <dt><tt> iMsgKey</tt>
   <dd>        Identifier of the error message in the NLS file (without the prefix, ERR_, WRN_, INF_ ).
     <br>
     This prefix is automatically added by the MsgReporter:
		<ul>
		<li><tt>ERR_</tt> for Critical and Fatal </li>
       <li><tt>WRN_</tt> for Warning </li>
       <li><tt>INF_</tt> for Information </li>
		</ul>

  </dd>
    <dt><tt> iMsgCtlg</tt>
   <dd> I    Name of the NLS file containing the error
 <br>It is typically called by DisplayMessage with <tt>iMsgCtlg = CATPDMBase</tt>
  </dd>
    <dt><tt> nbArgs</tt>
   <dd>        Nb of optional arguments
  </dd>
    <dt><tt> iArgs</tt>
   <dd>       Optional arguments of the error message, identified by <tt>/p1</tt>, <tt>/p2</tt>, ... in the NLS</dd>
</dl>
</dl>
</dl>
<hr>
 This object is included in the file: <b>CATPDMServices.h</b><br>
If needed, your Imakefile.mk should include the module: <b>CATPDMBase</b>

</body>
<hr><p><i>
Copyright &#169; 1999-2011, Dassault Syst&#232;mes. All rights reserved.</i></p>
</html>
