<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
 <meta http-equiv="Content-Language" content="en-us"> 
 <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
 <meta name="Generator" content="CppGene v1.1">
 <meta http-equiv="Expires" content="Tue, 04 Dec 1993 21:29:02 GMT">
 <title>ObjectModelerBase Class CATOmbWarmStartServices</title>
<link rel="Stylesheet" type="text/css" href="../../../caav5.css">
<script language="Javascript" src="../_index/jslink.js"></script> 
<script language="Javascript" src="jsFwLink.js"></script> 
<script language="Javascript" type="text/javascript" src="../_index/jsTree.js"></script>  
</head>
<body>
<pre><a href="../_index/main.htm">All Frameworks</a>  <a href="../_index/tree.htm">Class Hierarchy</a>  <a href="../ObjectModelerBase.htm">This Framework</a>  <a href="../_index/HomeIdx.htm">Indexes</a>  <script type="text/javascript"> 
 var test=locateObject('CATOmbWarmStartServices','class','0'); 
 if(test==1){ 
     document.write("<a href=\"#\" onclick=\"openLinkNP('CATOmbWarmStartServices','class','0');return false\">Previous</a> "); 
 } 
 test=locateObject('CATOmbWarmStartServices','class','1'); 
 if(test==1){ 
     document.write("<a href=\"#\" onclick=\"openLinkNP('CATOmbWarmStartServices','class','1');return false\">Next</a> "); 
 } 
 </script> 
</pre>
<hr>
<h1>ObjectModelerBase Class CATOmbWarmStartServices</h1>
<script type="text/javascript" > 
 generatedFatherClass('class_CATOmbWarmStartServices_41175','CATOmbWarmStartServices','0');</script>
<p><b>Usage: you must use this class as is. You should never derive it.</b></p>
<hr>
<p>
 public class <b>CATOmbWarmStartServices</b>
</p>
<p>
<b><i> Services to control the warmstart incremental backup.</i></b><br>

 <b>Role:</b> The following static methods are meant to be used by CAA applications which
 want to benefit from the warmstart system. They will provide basic services to test 
 the status of the warmstart and interact with it (activate, deactivate, commit 
 modifications...).</p>
<hr>
</dl>
 <h2>Method Index</h2> <br>
<dl>
 <dt> o 
    <a href="#Activate(CATUnicodeString&amp;)"><b>Activate</b></a>(CATUnicodeString&amp;)
<dd>  Activates or re-initialises the warmstart incremental backup.
 <dt> o 
    <a href="#CommitTransaction()"><b>CommitTransaction</b></a>()
<dd>  Commits the transaction into the warmstart backup data.
 <dt> o 
    <a href="#Deactivate(CATUnicodeString&amp;)"><b>Deactivate</b></a>(CATUnicodeString&amp;)
<dd>  
 <dt> o 
    <a href="#Deactivate(CATBoolean,CATUnicodeString&amp;)"><b>Deactivate</b></a>(CATBoolean,CATUnicodeString&amp;)
<dd>  Deactivates the warmstart incremental backup.
 <dt> o 
    <a href="#IsActive(CATBoolean&amp;)"><b>IsActive</b></a>(CATBoolean&amp;)
<dd>  Tests if the warmstart is active.
 <dt> o 
    <a href="#IsAvailable(CATBoolean&amp;)"><b>IsAvailable</b></a>(CATBoolean&amp;)
<dd>  Tests if the warmstart is available.
</dl>
<dl>
</dl>
<dl>
</dl>
 <h2>Methods</h2> <br>
<a name="Activate"></a><a name="Activate(CATUnicodeString&amp;)"></a> <dt> o <b>Activate</b>

<dt>  <table><tr><td>  public static <script type="text/javascript"> activateLink('HRESULT','HRESULT')</script>  <b>Activate</b>(<td><script type="text/javascript"> activateLink('CATUnicodeString','CATUnicodeString&amp;')</script> <td><tt>oWarningMessageToDisplay</tt>)<script type="text/javascript"> activateLink('','')</script>  </table></dt>
<dl>
  <dd>
 Activates or re-initialises the warmstart incremental backup.
 <br><b>Role:</b> This method should be called in commands saving or closing documents.
 It will succeed only if none of the open documents is dirty (aka modified and not saved).
 If the warmstart was previously:
 <ul>
  <li>deactivated, it will be reactivated: a copy of each loaded V5 documents 
    will be done, and log files will be created.</li>
  <li>Already activated, it will be re-initialized. A copy of each loaded V5 documents 
    is done, and the backup data files are emptied.</li>
 </ul>
 <br>If successful, the caller should display the returned warning message. Use the following 
 code to call this service and display the user message:
 <pre>
   CATUnicodeString WarningMessage;
   HRESULT hr = CATOmbWarmStartServices::Activate(WarningMessage);
   if( SUCCEEDED(hr) && (0!=WarningMessage.GetLengthInChar()) )
   {	
      CATApplicationFrame *pFrame = CATApplicationFrame::GetFrame();
      if( (NULL!=pFrame) && (NULL!=pFrame->GetMainWindow()) )
      {
         CATDlgNotify *pNfy = new CATDlgNotify(pFrame->GetMainWindow(), 
                                "AutoSave", 
                                CATDlgNfyInformation|CATDlgNfyOK|CATDlgWndModal);

         CATUnicodeString WindowTitle = "..." ;
         pNfy->DisplayBlocked(WarningMessage , WindowTitle);
         pNfy->RequestDelayedDestruction();
      }
   }
 </pre>

 
<dl>
  <dt> <b>Parameters:</b>
  <dd>
    <dl>
    <dt><tt> oWarningMessageToDisplay</tt>
   <dd>     The warning message to be displayed to the user if successful (S_OK returned).

 </dd>
</dl>
  <dt> <b>Returns:</b> 
  <dd>    <br><b>Legal values</b>:
   <dl>
     <dt>S_OK</dt>
     <dd>The warmstart was successfully activated or re-initialized.</dd>
     <dt>E_FAIL</dt>
     <dd>The activation failed, either because warmstart is not available, or 
         some documents were dirty.</dd>
   </dl>
</dl>
</dl>
<a name="CommitTransaction"></a><a name="CommitTransaction()"></a> <dt> o <b>CommitTransaction</b>

<dt>  <table><tr><td>  public static <script type="text/javascript"> activateLink('HRESULT','HRESULT')</script>  <b>CommitTransaction</b>(<td>)<script type="text/javascript"> activateLink('','')</script>  </table></dt>
<dl>
  <dd>
 Commits the transaction into the warmstart backup data.
 <br><b>Role:</b> Normally the operations inside a command are validated at the end of 
 the command for a state command, or at the activation of the next for the others. 
  That wants to say that as long as the validation is not made, if the V5 session is broken, 
  the last operations will be not restored at the backup. However, you can force this 
  validation during a command if it is necessary. 
  <br>This method should be called to force the 
  latest modifications on the model to be commited into the backup data. This means that 
 those modifications will be replayed if a warmstart is needed. 
 The method should be called only when the 
 modifications to commit make a coherent transaction up, so that if they are replayed, 
 the model won't be left in a instable state.
 
<dl>
  <dt> <b>Returns:</b> 
  <dd>    <br><b>Legal values</b>:
   <dl>
     <dt>S_OK</dt>
     <dd>The transaction has been successfully committed.</dd>
     <dt>E_FAIL</dt>
     <dd>An internal error prevented the transaction from being committed.</dd>
   </dl>
</dl>
</dl>
<a name="Deactivate"></a><a name="Deactivate(CATUnicodeString&amp;)"></a> <dt> o <b>Deactivate</b>

<dt>  <table><tr><td>  public static <script type="text/javascript"> activateLink('HRESULT','HRESULT')</script>  <b>Deactivate</b>(<td><script type="text/javascript"> activateLink('CATUnicodeString','CATUnicodeString&amp;')</script> <td><tt>oWarningMessageToDisplay</tt>)<script type="text/javascript"> activateLink('','')</script>  </table></dt>
<dl>
  <dd>
 
<dl>
  <dt> <b>Deprecated:</b> 
  <dd>  V5R18 
 <br><b> use HRESULT Deactivate(CATBoolean iDeleteLog, CATUnicodeString& oWarningMessageToDisplay)</b>
 <br>Deactivates the warmstart incremental backup.
 <br><b>Role:</b> This method should be called in the 
<a href="#" onClick="openLink('','CATCommand');return false">CATCommand</a> Activate method of  a command when it is known that the command is incompatible with incremental backup.
 <br>It will stop the warmstart logging and delete all previous logged data.
 <br>If successful, the caller should display the returned message warning 
 the user to save his data.
 Use the following code to call this service and display the user message:
 <pre>
   CATUnicodeString WarningMessage;
   HRESULT hr = CATOmbWarmStartServices::<b>Deactivate</b>(WarningMessage);
   if( SUCCEEDED(hr) && (0 !=warningMessage.GetLengthInChar()) )
   {	
      CATApplicationFrame * pFrame = <b>CATApplicationFrame::GetFrame</b>();
      if( (NULL!=pFrame) && (NULL!=pFrame->GetMainWindow()) )
      {
         CATDlgNotify *pNfy = new <b>CATDlgNotify</b>(pFrame->GetMainWindow(), 
                                  "AutoSave", 
                                  CATDlgNfyInformation|CATDlgNfyOK|CATDlgWndModal);

          CATUnicodeString WindowTitle="..";
          pNfy-><b>DisplayBlocked</b>(WarningMessage ,WindowTitle);
          pNfy->RequestDelayedDestruction();
      }
   }
 </pre>

 
  <dt> <b>Parameters:</b>
  <dd>
    <dl>
    <dt><tt> oWarningMessageToDisplay</tt>
   <dd>     The warning message to be displayed to the user if successful (S_OK returned).

 </dd>
</dl>
  <dt> <b>Returns:</b> 
  <dd>    <br><b>Legal values</b>:
   <dl>
     <dt>S_OK</dt>
     <dd>The warmstart was successfully deactivated.</dd>
     <dt>E_FAIL</dt>
     <dd>The deactivation failed, either because warmstart is not available, or it was 
          already deactivated.</dd>
   </dl>
</dl>
</dl>
<a name="Deactivate"></a><a name="Deactivate(CATBoolean,CATUnicodeString&amp;)"></a> <dt> o <b>Deactivate</b>

<dt>  <table><tr><td>  public static <script type="text/javascript"> activateLink('HRESULT','HRESULT')</script>  <b>Deactivate</b>(<td><script type="text/javascript"> activateLink('CATBoolean','CATBoolean')</script> <td><tt>iDeleteLog</tt>,<tr><td></td><td><script type="text/javascript"> activateLink('CATUnicodeString','CATUnicodeString&amp;')</script> <td><tt>oWarningMessageToDisplay</tt>)<script type="text/javascript"> activateLink('','')</script>  </table></dt>
<dl>
  <dd>
 Deactivates the warmstart incremental backup.
 <br><b>Role:</b> This method should be called in the 
<a href="#" onClick="openLink('','CATCommand');return false">CATCommand</a> Activate method of  a command when it is known that the command is incompatible with incremental backup.
 <br>It will stop the warmstart logging and also, when requested, delete all previous logged data.
 <br>If successful, the caller should display the returned message warning the user to save his data.
 <br>Use the following code to call this service and display the user message:
 <pre>
   CATUnicodeString WarningMessage;
   int iDeleteLog = 0; // depending user wants to delete or not previously logged data
   HRESULT hr = CATOmbWarmStartServices::<b>Deactivate</b>(iDeleteLog, WarningMessage);
   if( SUCCEEDED(hr) && (0 !=warningMessage.GetLengthInChar()) )
   {	
      CATApplicationFrame * pFrame = <b>CATApplicationFrame::GetFrame</b>();
      if( (NULL!=pFrame) && (NULL!=pFrame->GetMainWindow()) )
      {
         CATDlgNotify *pNfy = new <b>CATDlgNotify</b>(pFrame->GetMainWindow(), 
                                  "AutoSave", 
                                  CATDlgNfyInformation|CATDlgNfyOK|CATDlgWndModal);

          CATUnicodeString WindowTitle="..";
          pNfy-><b>DisplayBlocked</b>(WarningMessage ,WindowTitle);
          pNfy->RequestDelayedDestruction();
      }
   }
 </pre>

 
<dl>
  <dt> <b>Parameters:</b>
  <dd>
    <dl>
    <dt><tt> iDeleteLog</tt>
   <dd>     Delete when requested the previously logged data at deactivation time.
 <ul>
     <li>FALSE: Logged data remain until next incremental backup activation.
     <br>If a crash occurs after deactivation, all commands preceeding deactivated one will be restored.</li>
     <li>TRUE: Logged data are deleted at deactivation time.
     <br>If a crash occurs after deactivation, none of the commands preceeding deactivated one will be restored.
     <br>User should save all data before processing deactivated command.</li>
 </ul>

 </dd>
    <dt><tt> oWarningMessageToDisplay</tt>
   <dd>     The warning message to be displayed to the user if successful (S_OK returned).

 </dd>
</dl>
  <dt> <b>Returns:</b> 
  <dd>    <br><b>Legal values</b>:
   <dl>
     <dt>S_OK</dt>
     <dd>The warmstart was successfully deactivated.</dd>
     <dt>E_FAIL</dt>
     <dd>The deactivation failed, either because warmstart is not available, or it was 
          already deactivated.</dd>
   </dl>
</dl>
</dl>
<a name="IsActive"></a><a name="IsActive(CATBoolean&amp;)"></a> <dt> o <b>IsActive</b>

<dt>  <table><tr><td>  public static <script type="text/javascript"> activateLink('HRESULT','HRESULT')</script>  <b>IsActive</b>(<td><script type="text/javascript"> activateLink('CATBoolean','CATBoolean&amp;')</script> <td><tt>oActive</tt>)<script type="text/javascript"> activateLink('','')</script>  </table></dt>
<dl>
  <dd>
 Tests if the warmstart is active.
 <br><b>Role:</b> This method should be called to test if the warmstart is 
  currently saving backup data.

 
<dl>
  <dt> <b>Parameters:</b>
  <dd>
    <dl>
    <dt><tt> oActive</tt>
   <dd>     When successful (S_OK returned) : TRUE if the warmstart is active, FALSE otherwise.

 </dd>
</dl>
  <dt> <b>Returns:</b> 
  <dd>    <br><b>Legal values</b>:
   <dl>
     <dt>S_OK</dt>
     <dd>The returned status is meaningful.</dd>
     <dt>E_FAIL</dt>
     <dd>The warmstart is not available, or an internal error prevents 
        the status from being retrieved.</dd>
   </dl>
</dl>
</dl>
<a name="IsAvailable"></a><a name="IsAvailable(CATBoolean&amp;)"></a> <dt> o <b>IsAvailable</b>

<dt>  <table><tr><td>  public static <script type="text/javascript"> activateLink('HRESULT','HRESULT')</script>  <b>IsAvailable</b>(<td><script type="text/javascript"> activateLink('CATBoolean','CATBoolean&amp;')</script> <td><tt>oAvailable</tt>)<script type="text/javascript"> activateLink('','')</script>  </table></dt>
<dl>
  <dd>
 Tests if the warmstart is available.
 <br><b>Role:</b> This method should be called to test if the warmstart can be activated,
 depending on environment variables and user settings.

 
<dl>
  <dt> <b>Parameters:</b>
  <dd>
    <dl>
    <dt><tt> oAvailable</tt>
   <dd>     When successful (S_OK returned) : TRUE if the warmstart is available, FALSE otherwise.

 </dd>
</dl>
  <dt> <b>Returns:</b> 
  <dd>    <br><b>Legal values</b>:
   <dl>
     <dt>S_OK</dt>
     <dd>The returned status is meaningful.</dd>
     <dt>E_FAIL</dt>
     <dd>An internal error prevents the status from being retrieved.</dd>
   </dl>
</dl>
</dl>
<hr>
 This object is included in the file: <b>CATOmbWarmStartServices.h</b><br>
If needed, your Imakefile.mk should include the module: <b>CATObjectModelerBase</b>

</body>
<hr><p><i>
Copyright &#169; 1999-2011, Dassault Syst&#232;mes. All rights reserved.</i></p>
</html>
