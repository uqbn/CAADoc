<html>
<head>
 <meta name="Generator" content="mihGene v1.1">
 <meta http-equiv="Expires" content="Tue, 04 Dec 1993 21:29:02 GMT">
 <title>MecModInterfaces InstanceFactory (Object)</title>
<link rel="Stylesheet" type="text/css" href="../../../caav5.css">
<script language="Javascript" src="../_index/jslink.js"></script> 
<script language="Javascript" src="jsFwLink.js"></script> 
<script language="Javascript" type="text/javascript" src="../_index/jsTree.js"></script>  
</head>
<body>
<pre><a href="../_index/main.htm">All Frameworks</a>  <a href="../_index/tree.htm">Object Hierarchy</a>  <a href="../MecModInterfaces.htm">This Framework</a>  <a href="../_index/CAAHomeIdx.htm">Indexes</a>  <script type="text/javascript"> 
 var test=locateObject('InstanceFactory','interface','0'); 
 if(test==1){ 
     document.write("<a href=\"#\" onclick=\"openLinkNP('InstanceFactory','interface','0');return false\">Previous</a> "); 
 } 
 test=locateObject('InstanceFactory','interface','1'); 
 if(test==1){ 
     document.write("<a href=\"#\" onclick=\"openLinkNP('InstanceFactory','interface','1');return false\">Next</a> "); 
 } 
 </script> 
</pre>
<hr>
<h1>InstanceFactory<font size=-1> (Object)</font></h1>
<script type="text/javascript" > 
 generatedFatherClass('interface_InstanceFactory_27199','InstanceFactory','0');</script>
<b><i>   Represents the CATIAInstanceFactory.</i></b><br>

 <b>Role</b>:
 This interface is used to create a new instance of a shape reference (<a href="#" onClick="openLink('ShapeInstance','');return false">ShapeInstance</a> ) or a hybrid shape reference (
<a href="#" onClick="openLink('HybridShapeInstance','');return false">HybridShapeInstance</a> ) in case of the instantiation of a <tt>User Feature</tt>.<br> It is also used to instantiate a <tt>Power Copy</tt> reference.<br><br>
 This interface contains two protocols of instantiation:<br>
 <ul>
 <li>The first protocol is dedicated to <tt>User Feature</tt> instantiation only.<br>
 It is defined by a single method: 
<a href="#" onClick="openLink('','AddInstance');return false">AddInstance</a> . It creates a shape or hybrid shape instance depending on the result of the <tt>User Feature</tt>.<br>
 Use this method when you want to perform only one instantiation of the reference.
 Read the document containing the <tt>User Feature</tt> reference and instantiate it.<br>
 As the document containing the reference is released from the session at the end of the instantiation,
 it is not recommmended to use this method if you want to perform several instantiations of the same reference in a loop.<br>
 In that case, prefer the second protocol of instantiation.</li>
 <li>The second protocol is dedicated to both <tt>User Feature</tt> and <tt>Power Copy</tt> instantiations.<br>
 It is defined by several methods that must be called in order.<br>
 <ul>
 <li>For <tt>User Feature</tt> instantiation, these methods are an alternative way of the 
<a href="#" onClick="openLink('','AddInstance');return false">AddInstance</a> method.<br> It is recommended to use the second protocol to perform several instantiations of the same reference in a loop.<br></li>
 <li>For <tt>Power Copy</tt> instantiation, it is the only way of instantiating a reference.<br></li>
 </ul>
 The instantiation process is composed of three major steps:<br>
 <ol>
 <li>The first step 
<a href="#" onClick="openLink('','BeginInstanceFactory');return false">BeginInstanceFactory</a> consists in initializing the 
<a href="#" onClick="openLink('InstanceFactory','');return false">InstanceFactory</a> with the reference and the document where it is stored.<br>This step must be called once at the beginning whatever the number of instantiations are done.</li>
 <li>The second step is the instantiation itself: it is composed of five methods that must be called in the order.<br>
 This set of five methods can be called in a loop in order to make several instantiations.<br>
 <ol>
 <li>The method 
<a href="#" onClick="openLink('','BeginInstantiate');return false">BeginInstantiate</a> is used to initialize all data of the reference.</li> <li>The method 
<a href="#" onClick="openLink('','PutInputData');return false">PutInputData</a> is used to set a value to any input of the reference.</li> <li>The method 
<a href="#" onClick="openLink('','GetParameter');return false">GetParameter</a> is used to retrieve any parameter of the reference in order to modify its value.</li> <li>The method 
<a href="#" onClick="openLink('','Instantiate');return false">Instantiate</a> is used to duplicate the reference. It returns the created instance when it does exist.</li> <li>The method 
<a href="#" onClick="openLink('','EndInstantiate');return false">EndInstantiate</a> is used to indicate that the instantiation is done.</li> </ol>
 <li>The third step 
<a href="#" onClick="openLink('','EndInstantiateFactory');return false">EndInstantiateFactory</a> consists in ending the instantiation and cleaning the 
<a href="#" onClick="openLink('InstanceFactory','');return false">InstanceFactory</a>.<br> When doing several instantiations in a loop, this step must be called just once at the end of all instantiations.</li>
 </ol>
 </ul>
<hr>
<dl>
</dl>
<dl>
 <h2><a name="MethodIndex"></a>Method Index</h2>
 <dt>
    <a href="#AddInstance"><b>AddInstance</b></a>
<dd>  Creates a new instance of a shape or hybrid shape.
 <dt>
    <a href="#BeginInstanceFactory"><b>BeginInstanceFactory</b></a>
<dd>  Initializes the instantiation process with the document containing the reference.
 <dt>
    <a href="#BeginInstantiate"><b>BeginInstantiate</b></a>
<dd>  Initializes the data of the reference.
 <dt>
    <a href="#EndInstanceFactory"><b>EndInstanceFactory</b></a>
<dd>  Ends the instantiation process.
 <dt>
    <a href="#EndInstantiate"><b>EndInstantiate</b></a>
<dd>  Ends the instantiation of the reference.
 <dt>
    <a href="#GetParameter"><b>GetParameter</b></a>
<dd>  Retrieves a parameter of the reference by its name.
 <dt>
    <a href="#Instantiate"><b>Instantiate</b></a>
<dd>  Instantiates the reference in the current document.
 <dt>
    <a href="#PutInputData"><b>PutInputData</b></a>
<dd>  Sets a value to an input of the reference.
</dl>
 <h2><a name="Methods"></a>Methods</h2> <br>
<a name="AddInstance"><dt>

<table><tr><td>o Func <b>AddInstance</b>(<td><script type="text/javascript"> activateLink('AnyObject','AnyObject')</script> <td><tt>iReference</tt>) As <script type="text/javascript"> activateLink('AnyObject','AnyObject')</script> </table></dt>
<dl>
  <dd>
 Creates a new instance of a shape or hybrid shape.
 
<dl>
  <dt> <b>Parameters:</b>
  <dd>
    <dl>
    <dt><tt> iReference</tt>
   <dd>   The reference shape or hybrid shape.
 <! @sample >
 </dl>
 <dt><b>Example:</b>
 <dd>
 This example creates the instance <tt>NewInstance</tt> in the part.
 <pre>
 Set NewInstance = instanceFactory.<font color="red">AddInstance</font>(reference)
 </pre>
 </dl></dd>
</dl>
</dl>
</dl>
<a name="BeginInstanceFactory"><dt>

<table><tr><td>o Sub <b>BeginInstanceFactory</b>(<td><script type="text/javascript"> activateLink('CATBSTR','CATBSTR')</script> <td><tt>iNameOfReference</tt>,<tr><td></td><td><script type="text/javascript"> activateLink('CATBSTR','CATBSTR')</script> <td><tt>iNameOfDocument</tt>)</table></dt>
<dl>
  <dd>
 Initializes the instantiation process with the document containing the reference.
 <br><b>Role</b>:
 Use this method to start instantiating a reference in the current document.<br>
 In that method, the document containing the reference is locked in session.<br>
 It will be unlocked in the last step 
<a href="#" onClick="openLink('','EndInstanceFactory');return false">EndInstanceFactory</a> . 
<dl>
  <dt> <b>Parameters:</b>
  <dd>
    <dl>
    <dt><tt> iNameOfReference</tt>
   <dd>	The name of the reference to be instantiated.
 </dd>
    <dt><tt> iDocumentFileName</tt>
   <dd>  The name of the file containing the document where to find the reference to be instantiated.
 <! @sample >
 </dl>
 <dt>
 <b>Example:</b>
 <dd>
 The following example initializes the factory with a document and a reference:
 <pre>
 InstanceFactory.<font color="red">BeginInstanceFactory</font>"NameOfReference","c:\tmp\NameOfDocument.CATPart"
 </pre>
 </dl></dd>
</dl>
</dl>
</dl>
<a name="BeginInstantiate"><dt>

<table><tr><td>o Sub <b>BeginInstantiate</b>(<td>)</table></dt>
<dl>
  <dd>
 Initializes the data of the reference.
 <br><b>Role</b>:
 This is the first method of the second step of instantiation.<br>
 It is used to initialize all data of the reference in the factory.
 <! @sample >
 <dl><dt>
 <b>Example:</b>
 <dd>
 The following example shows how to initialize the factory:
 <pre>
 InstanceFactory.<font color="red">BeginInstantiate</font>
 </pre>
 </dl>
</dl>
<a name="EndInstanceFactory"><dt>

<table><tr><td>o Sub <b>EndInstanceFactory</b>(<td>)</table></dt>
<dl>
  <dd>
 Ends the instantiation process.
 <br><b>Role</b>:
 Use this method to end the instantiation process.<br>
 In that method the document containing the reference is unlocked and released from the session.
 <! @sample >
 <dl><dt>
 <b>Example:</b>
 <dd>
 The following example shows how to end the instantiation:
 <pre>
 InstanceFactory.<font color="red">EndInstanceFactory</font>
 </pre>
 </dl>
</dl>
<a name="EndInstantiate"><dt>

<table><tr><td>o Sub <b>EndInstantiate</b>(<td>)</table></dt>
<dl>
  <dd>
 Ends the instantiation of the reference.
 <br><b>Role</b>:
 This is the fifth and last method of the second step of instantiation.<br>
 It is used to end the instantiation: after this step, all the links to the
 reference are broken.
 <! @sample >
 <dl><dt>
 <b>Example:</b>
 <dd>
 The following example shows how to end the instantiation:
 <pre>
 InstanceFactory.<font color="red">EndInstantiate</font>
 </pre>
 </dl>
</dl>
<a name="GetParameter"><dt>

<table><tr><td>o Func <b>GetParameter</b>(<td><script type="text/javascript"> activateLink('CATBSTR','CATBSTR')</script> <td><tt>iName</tt>) As <script type="text/javascript"> activateLink('AnyObject','AnyObject')</script> </table></dt>
<dl>
  <dd>
 Retrieves a parameter of the reference by its name.
 <br><b>Role</b>:
 This is the third method of the second step of instantiation.<br>
 This step is optional.<br>
 It is used to retrieve a parameter of the reference in order to change
 its value, using the <tt>ValuateFromString</tt> method of the <tt>Parameter</tt> interface.<br>
 It has to be called on each parameter whose value has to be changed.
 
<dl>
  <dt> <b>Parameters:</b>
  <dd>
    <dl>
    <dt><tt> iName</tt>
   <dd>   The name of the parameter.
 <! @sample >
 </dl>
 <dt>
 <b>Example:</b>
 <dd>
 The following example retrieves a parameter on the reference:
 <pre>
 Set parameter = InstanceFactory.<font color="red">GetParameter</font>("Parameter1")
 </pre>
 </dl></dd>
</dl>
</dl>
</dl>
<a name="Instantiate"><dt>

<table><tr><td>o Func <b>Instantiate</b>(<td>) As <script type="text/javascript"> activateLink('AnyObject','AnyObject')</script> </table></dt>
<dl>
  <dd>
 Instantiates the reference in the current document.
 <br><b>Role</b>:
 This is the fourth method of the second step of instantiation.<br>
 It is used to duplicate or instantiate the data of the reference.<br>
 <ul>
 <li>In case of <tt>Power Copy</tt> instantiation, the data are duplicated and there is
 no created instance.</li>
 <li>In case of <tt>User Feature</tt> instantiation, the data are instantiated and an
 instance is created and returned.</li>
 </ul>
 <! @sample >
 <dl><dt>
 <b>Example:</b>
 <dd>
 The following example instantiates the reference:
 <pre>
 Set Instance = InstanceFactory.<font color="red">Instantiate</font>
 </pre>
 </dl>
</dl>
<a name="PutInputData"><dt>

<table><tr><td>o Sub <b>PutInputData</b>(<td><script type="text/javascript"> activateLink('CATBSTR','CATBSTR')</script> <td><tt>iName</tt>,<tr><td></td><td><script type="text/javascript"> activateLink('CATBaseDispatch','CATBaseDispatch')</script> <td><tt>iInput</tt>)</table></dt>
<dl>
  <dd>
 Sets a value to an input of the reference.
 <br><b>Role</b>:
 This is the second method of the second step of instantiation.<br>
 It is used to set a value to any input of the reference.<br>
 It has to be called on each input of the reference.
 
<dl>
  <dt> <b>Parameters:</b>
  <dd>
    <dl>
    <dt><tt> iName</tt>
   <dd>   The name of the input.
 </dd>
    <dt><tt> iInput</tt>
   <dd>   The element to set as the new value of the input.
   <br>All types of </dd>
</dl>
<a href="#" onClick="openLink('Boundary','');return false">Boundary</a> object are possibly supported. <! @sample >
 </dl>
 <dt>
 <b>Example:</b>
 <dd>
 The following example sets a value to an input of the reference:
 The input is a point and its name is Input1. 
 <pre>
 InstanceFactory.<font color="red">PutInputData</font> "Input1",point1
 </pre>
 </dl>
</dl>
</dl>

</body>
<hr><p><i>
Copyright &#169; 1999-2011, Dassault Syst&#232;mes. All rights reserved.</i></p>
</html>
