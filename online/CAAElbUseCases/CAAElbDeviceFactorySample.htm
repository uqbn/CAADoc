<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="GENERATOR" content="Microsoft FrontPage 6.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<link rel="stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css">
<title>Creating Electrical Objects</title>
</head>

<body>

<table width="100%">
  <tr>
    <td valign="top">
      <h1>Equipment &amp; Systems Engineering</h1>
    </td>
    <td valign="top">
      <h2>Electrical Library</h2>
    </td>
    <td rowspan="2" align="right" valign="top">
      <h3><a name="Top"></a>Creating Electrical Objects</h3>
      <em>How to create an electrical single connector, back shell and mounting
      equipment</em></td>
  </tr>
  <tr>
    <td class="use" colspan="2">Use Case</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<table class="abstract">
  <tr>
    <td>
      <h3>Abstract</h3>
      <p>This article discusses the ElecDeviceItf use case. This use case
      explains how to create an electrical single connector, back shell and
      mounting equipment with a mechanical part.</p>
      <ul>
        <li><b><a href="#Learn">What You Will Learn With This Use Case</a></b></li>
        <li><b><a href="#UseCase">The CAAElecDeviceFactory Use Case</a></b>
          <ul>
            <li><a href="#What">What does CAAElecDeviceFactory do</a></li>
            <li><a href="#How">How to Launch CAAElecDeviceFactory</a></li>
            <li><a href="#Where">Where to Find the CAAElecDeviceFactory code</a></li>
          </ul>
        </li>
        <li><a href="#Step"><b>Step-by-Step</b></a></li>
        <li><b><a href="#InShort">In Short</a></b></li>
        <li><b><a href="#history">History</a></b></li>
      </ul>
    </td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="Learn"></a>What You Will Learn With This Use Case</h3>
<p>This use case is intended to help you make your first steps in programming
with CATIA ELB Interfaces. Its main intent is to allow you to create electrical 
single connector, back shell or mounting equipment.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h3><a name="UseCase"></a>The CAAElecDeviceFactory Use Case</h3>
<p>CAAElecDeviceFactory is a use case of the CAAElecDeviceItf.edu framework that
illustrates the CATIA ELB Interfaces framework capabilities.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="What"></a>What Does CAAElecDeviceFactory Do?</h4>
<p>The goal of CAAElecDeviceFactory use case is to show how to create electrical
single connector, back shell or mounting equipment and how to define
terminations or cavities on the electrical devices created using the appropriate
interfaces.</p>
<p align="center"><img border="0" src="images/CAAElbBackShellPart.jpg" width="470" height="734"></p>
<p>Above is a CATIA image of the back shell geometrical part.</p>
<p align="center"><img border="0" src="images/CAAElb9.jpg" width="467" height="663"></p>
<p>Above is a CATIA image of the single connector geometrical
part.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="How"></a>How to Launch CAAElecDeviceFactory ?</h4>
<p>To launch CAAElecDeviceFactory, you will need to set up the build time
environment, then compile CAAElecDeviceFactory along with its
prerequisites, set up the run time environment, and then execute the sample.</p>
<p>To launch the use case, execute the following command:</p>
<pre>mkrun -c &quot;CAAElecDeviceFactory input1 input2 input3 input4 input5 output1 output2 output3 output4 output5 output6 output7 &quot;</pre>
<ul>
  <li><b>input1</b> - the path to the existing external CATPart to be browsed.
    You may reference the supplied CATPart document called
    &quot;BACK_SHELL.CATPart&quot;.
    <p><b>input2 </b>- the path to the existing external CATPart to be browsed.
    You may reference the supplied CATPart document called
    &quot;Single_Connector.CATPart&quot;.</p>
    <p><b>input3</b> - the path to the existing external CATPart to be browsed.
    You may reference the supplied CATPart document called
    &quot;Second_SingleConnector.CATPart&quot;.</p>
    <p><b>input4</b> - the path to the existing external CATPart to be browsed.
    You may reference the supplied CATPart document called
    &quot;Third_Single_Connector.CATPart&quot;.</p>
    <p><b>input5</b> - the path to the existing external CATPart to be browsed.
    You may reference the supplied CATPart document called
    &quot;MountingEquipment.CATPart&quot;.</p>
    <p><b>output1</b> - the path of the file to save in the document
    &quot;BACK_SHELL.CATPart&quot;.</p>
    <p><b>output2</b> - the path of the file to save in the document
    &quot;Single_Connector.CATPart&quot;.</p>
    <p><b>output3</b> - the path of the file to save in the document
    &quot;Second_SingleConnector.CATPart&quot;.</p>
    <p><b>output4</b> - the path of the file to save in the document
    &quot;Third_Single_Connector.CATPart&quot;.</p>
    <p><b>output5</b> - the path of the file to save in the document
    &quot;MountingEquipment.CATPart&quot;.</p>
    <p><b>output6</b> - the path of the file to save in the document aggregate
    under the main document.</p>
    <p><b>output7</b> - the path of the file to save in the main document.</p>
    <p>These documents can be to find in:
<pre><b>InstallRootDirectory</b>\<b>OS</b>\resources\graphic\CAAElecDeviceFactory </pre>
<p>where <b>InstallRootDirectory</b> is the root directory of your 
CAA V5 installation, and <b>OS</b> is a directory the name of which depends on the operating 
system. Refer to [<a href="#References">1</a>] 
to get the list of the currently supported operating systems and their 
associated directory names.</p>
</li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Where"></a>Where to Find the CAAElecDeviceFactory Code</h4>
<p>The CAAElecDeviceFactory sample is made of a single class named
CAAElecDeviceFactory located in the CAAElecDeviceFactory.m module of the
CAAElecDeviceItf.edu framework:</p>
<table>
  <tr>
    <td>Windows</td>
    <td><code>InstallRootDirectory\CAAElecDeviceItf.edu\CAAElecDeviceFactory.m\</code></td>
  </tr>
  <tr>
    <td>Unix</td>
    <td><code>InstallRootDirectory/CAAElecDeviceItf.edu/CAAElecDeviceFactory.m/</code></td>
  </tr>
</table>
<p>where <code>InstallRootDirectory</code> is the directory where the CAA CD-ROM
is installed.</p>
<p>This sample deals with the following classes:</p>
<table>
  <tr>
    <td><i>IUnknown</i></td>
    <td>Base Class for the References and Instances</td>
  </tr>
  <tr>
    <td><i>CATSessionServices</i></td>
    <td>Class for managing the session</td>
  </tr>
  <tr>
    <td><i>CATDocument</i></td>
    <td>Class for the document base class</td>
  </tr>
  <tr>
    <td><i>CATDocumentServices</i></td>
    <td>Class for managing document in the session</td>
  </tr>
  <tr>
    <td><i>CATIADocument</i></td>
    <td>Class for Representing the document</td>
  </tr>
  <tr>
    <td><i>CATIDocRoots</i></td>
    <td>Class for browsing root object in document</td>
  </tr>
  <tr>
    <td><i>CATInit</i></td>
    <td>Interface dedicated to define
      initialisation of a document's data.</td>
  </tr>
  <tr>
    <td><i>CATIAlias</i></td>
    <td>Interface dedicated to access the external name
      of an object</td>
  </tr>
  <tr>
    <td><i>CATIProduct</i></td>
    <td>Interface dedicated to define product behaviour</td>
  </tr>
  <tr>
    <td><i>CATIPrtPart</i></td>
    <td>Interface dedicated to define to retrieve
      information on the MechanicalPart feature</td>
  </tr>
  <tr>
    <td><i>CATIDescendants</i></td>
    <td>Interface dedicated to to manage ordered
      components' agregation within a feature</td>
  </tr>
  <tr>
    <td><i>CATIGSMPoint</i></td>
    <td>Interface dedicated to define point
      feature behaviour</td>
  </tr>
  <tr>
    <td><i>CATIGSMLine</i></td>
    <td>Interface dedicated to define line feature
      behaviour</td>
  </tr>
  <tr>
    <td><i>CATIEleDocServices</i></td>
    <td>Interface dedicated electrical environment
      initialisation</td>
  </tr>
  <tr>
    <td><i>CATIElbFactory</i></td>
    <td>Interface for extending a product in
      electrical device such as single connector or back shell or mounting
      equipment</td>
  </tr>
  <tr>
    <td><i>CATIElbSingleConnector</i></td>
    <td>Interface for defining single connector
      behaviour</td>
  </tr>
  <tr>
    <td><i>CATIElbSingleConnectorReferences</i></td>
    <td>Interface for defining single connector
      reference behaviour</td>
  </tr>
  <tr>
    <td><i>CATIElbTermination</i></td>
    <td>Interface for defining electrical
      termination behaviour</td>
  </tr>
  <tr>
    <td><i>CATIElbBackShell</i></td>
    <td>Interface for defining electrical back shell
      behaviour</td>
  </tr>
  <tr>
    <td><i>CATIElbBackShellCnctPt</i></td>
    <td>Interface for defining electrical back shell
      connection point behaviour</td>
  </tr>
  <tr>
    <td><i>CATIElbMountingEquipmentReference</i></td>
    <td>Interface for defining electrical mounting
      equipment reference behaviour</td>
  </tr>
  <tr>
    <td><i>CATIElbConnectorCnctPt</i></td>
    <td>Interface for defining electrical connector
      connection point behaviour</td>
  </tr>
  <tr>
    <td><i>CATIElbCavity</i></td>
    <td>Interface for defining electrical cavity
      behaviour</td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h3><a name="Step"></a>Step-by-Step</h3>
<p>We will now first comment the Electrical environment and its components
creation by looking at the code of the CAAElecDeviceFactory. There are 17
logical steps in CAAElecDeviceFactory:</p>
<table width="100%">
  <tr>
    <td><b>#</b></td>
    <td><b>Step</b></td>
  </tr>
  <tr>
    <td valign="top"><a href="#Step1">1</a></td>
    <td valign="top">Creating the session and a new CATProduct Document</td>
  </tr>
  <tr>
    <td valign="top"><a href="#Step2">2</a></td>
    <td valign="top">Retrieving the root product of the CATProduct document</td>
  </tr>
  <tr>
    <td valign="top"><a href="#Step3">3</a></td>
    <td valign="top">Initializing Electrical Environment</td>
  </tr>
  <tr>
    <td valign="top"><a href="#Step4">4</a></td>
    <td valign="top">Importing the part &quot;Back_Shell.CATPart&quot; under the
      Root Product</td>
  </tr>
  <tr>
    <td valign="top"><a href="#Step5">5</a></td>
    <td valign="top">Extending this part in type ElecBackShellE.</td>
  </tr>
  <tr>
    <td valign="top"><a href="#Step6">6</a></td>
    <td valign="top">Importing the part &quot;SingleConnector.CATPart&quot;
      under the root product.</td>
  </tr>
  <tr>
    <td valign="top"><a href="#Step7">7</a></td>
    <td valign="top">Extending this part in Single Connector.</td>
  </tr>
  <tr>
    <td valign="top"><a href="#Step8">8</a></td>
    <td valign="top">Defining two terminations on the single connector.</td>
  </tr>
  <tr>
    <td valign="top"><a href="#Step8">9</a></td>
    <td valign="top">Defining a connector connection point on the single
      connector.</td>
  </tr>
  <tr>
    <td valign="top"><a href="#Step19">10</a></td>
    <td valign="top">Importing the part
      &quot;Second_SingleConnector.CATPart&quot;.</td>
  </tr>
  <tr>
    <td valign="top"><a href="#Step20">11</a></td>
    <td valign="top">Defining three cavities on the second single connector.</td>
  </tr>
  <tr>
    <td valign="top"><a href="#Step19">12</a></td>
    <td valign="top">Importing the part &quot;MountingEquipment.CATPart&quot;.</td>
  </tr>
  <tr>
    <td valign="top"><a href="#Step5">13</a></td>
    <td valign="top">Extending this part in type Mounting Equipment</td>
  </tr>
  <tr>
    <td valign="top"><a href="#Step20">14</a></td>
    <td valign="top">Defining a cavity on the mounting equipment</td>
  </tr>
  <tr>
    <td valign="top"><a href="#Step19">15</a></td>
    <td valign="top">Importing the part
      &quot;Third_Single_Connector.CATPart&quot;.</td>
  </tr>
  <tr>
    <td valign="top"><a href="#Step8">16</a></td>
    <td valign="top">Defining a connector connection point on the single
      connector.</td>
  </tr>
  <tr>
    <td valign="top"><a href="#Step18">17</a></td>
    <td valign="top">Epilog</td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step1"></a>Creating the session and a new CATProduct Document</h4>
<p>We need a <i>CATSession</i> pointer to create the Session.</p>
<table class="code">
  <tr>
    <td>
      <pre>...
CATSession *pSession = NULL;
char *sessionName = &quot;CAA_ElecDeviceFactory_Session&quot;;
HRESULT rc = ::Create_Session(sessionName,pSession);
...</pre>
    </td>
  </tr>
</table>
<p>We create a CATDocument pointer with CATDocumentServices class..</p>
<table class="code">
  <tr>
    <td>
      <pre>...
CATDocument *pMainPrdDoc = NULL; 
rc = CATDocumentServices::New(&quot;CATProduct&quot;, pMainPrdDoc);
...</pre>
    </td>
  </tr>
</table>
<p>Once the current session has been created, the CATProduct document can be
created into the session. pMainPrdDoc is a pointer to this document.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step2"></a>Retrieving the root product of the CATProduct document</h4>
<p>We need a <i>CATProduct</i> pointer to retrieve the root product.</p>
<table class="code">
  <tr>
    <td>
      <pre>...
CATIProduct* piRootProduct = NULL;  
CATIDocRoots * pDocRoots = NULL;
rc = pDoc-&gt;QueryInterface(IID_CATIDocRoots,(void**) &amp;pDocRoots);
...
CATListValCATBaseUnknown_var* pListRootProduct = pDocRoots-&gt;GiveDocRoots();
...
if ( pListRootProduct &amp;&amp; pListRootProduct-&gt;Size() )
{  
  rc = (*pListRootProduct)[1]-&gt;QueryInterface(IID_CATIProduct,(void**) &amp;piRootProduct );
}
...</pre>
    </td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step3"></a>Initializing Electrical Environment</h4>
<p>We initialize the Document by using CATIEleDocServices interface pointer and
the method Initialize() on it.</p>
<table class="code">
  <tr>
    <td>
      <pre>...
CATIEleDocServices * piElecDocServices = NULL;
  
rc = pMainPrdDoc -&gt;QueryInterface(IID_CATIEleDocServices,(void**) &amp;piElecDocServices );
if ( SUCCEEDED(rc) &amp;&amp; piElecDocServices )
{
  rc = piElecDocServices-&gt;Initialize();
}
...</pre>
    </td>
  </tr>
</table>
<p>Initializing the electrical environment is mandatory to enable
access to electrical object or electrical attributes.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step4"></a>Importing the part &quot;Back_Shell.CATPart&quot; under
the Root Product</h4>
<p>We use a method Import() defined in this sample to import a part from a path
on the current session. The method Import() used the method AddExternalComponent
of CATIAProduct interfaces to import the part.</p>
<table class="code">
  <tr>
    <td>
      <pre>...
CATDocument* ptDocument = NULL;
RC = CATDocumentServices::OpenDocument(PATH, ptDocument, TRUE);
...
CATIAProducts_var hRootProducts (ihProductTarget);
CATIADocument *pCAADocument = NULL;
RC = ptDocument-&gt;QueryInterface(IID_CATIADocument, (void **)&amp;pCAADocument);
CATIAProduct * pInstantiatedProduct = NULL;
RC = hRootProducts-&gt;AddExternalComponent(pCAADocument, pInstantiatedProduct);
...
RC = pInstantiatedProduct-&gt;QueryInterface(CATIProduct::ClassId(), (void**)&amp; oProduct);</pre>
    </td>
  </tr>
</table>
<p>In the sample we import the back shell part as follows:</p>
<table class="code">
  <tr>
    <td>
      <pre>...
CATIProduct_var hProduct_Level_1 = piRootProduct-&gt;AddProduct(&quot;Product_Lv1&quot;);
 CATIProduct * pProduct_BackShell = NULL;
  
rc = Import(hProduct_Level_1, PATH_Back_Shell,pProduct_BackShell);
...
RC = pInstantiatedProduct-&gt;QueryInterface(CATIProduct::ClassId(), (void**)&amp; oProduct);</pre>
    </td>
  </tr>
</table>
<p>This sample illustrates the result of importing part</p>
<p align="center"><img border="0" src="images/CAAElbPart_UnderPrd.jpg" width="536" height="583"></p>
<p align="right"><a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step5"></a>Extending this part in type ElecBackShellE</h4>
<p>We need a <i>CATIElbFactory</i> interface pointer to be able to extend
the part imported in current session in electrical device with type
ElecBackShellE.</p>
<table class="code">
  <tr>
    <td>
      <pre>...
CATIProduct_var hProduct_BackShell_Ref = pProduct_BackShell-&gt;GetReferenceProduct();
CATIElbFactory_var hElbFactory(hProduct_BackShell_Ref);
rc = hElbFactory -&gt; ExtendPrdAsBackShell() ;
...</pre>
    </td>
  </tr>
</table>
<p align="center"><img border="0" src="images/CAAElbPrd_extend_BS.gif" width="642" height="527"></p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step6"></a>Importing the part
&quot;SingleConnector.CATPart&quot; under the root product</h4>
<p>The method used for importing SingleConnector.CATPart is identical with
Back_Shell.CATPart.</p>
<table class="code">
  <tr>
    <td>
      <pre>...
CATIProduct * pProduct_Single_Connector = NULL;
rc = Import(hProduct_Level_1, PATH_Single_Connector,pProduct_Single_Connector);
...</pre>
    </td>
  </tr>
</table>
<p align="center"><img border="0" src="images/CAAElbImportPartSic.jpg" width="685" height="550"></p>
<p>Above is a CATIA image of the import of
SingleConnector.CATPart under Product_Lv1.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step7"></a>Extending this part in Single Connector</h4>
<p>The method ExtendPrdAsSingleConnector() of the interface <i>CATIElb</i>Factory
is used to extend the product SingleConnector2 in an electrical single
connector.</p>
<table class="code">
  <tr>
    <td>
      <pre>...
CATIProduct_var hProduct_Single_Connector_Ref = pProduct_Single_Connector-&gt;GetReferenceProduct();
hElbFactory = hProduct_Single_Connector_Ref;
rc = hElbFactory -&gt; ExtendPrdAsSingleConnector() ;
...</pre>
    </td>
  </tr>
</table>
<p align="center"><img border="0" src="images/CAAElbExtendSic.jpg" width="518" height="427"></p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step8"></a>Defining two terminations on the single connector</h4>
<p>To define a termination on a single connector the method AddTermination() of
CATIElbSingleConnectorReference is used. The method AddTermination needs for
argument the product where the geometry of the single connector was defined and
the graphical representation of the geometrical element which defines the
termination.</p>
<p>Firstly we find the Product where graphical representation of the single
connector is defined as follows:</p>
<table class="code">
  <tr>
    <td>
      <pre>...
CATIProduct * pGeoDefinition_SIC = NULL;
rc =hProduct_Single_Connector_Ref-&gt; QueryInterface(IID_CATIProduct,(void**)&amp; pGeoDefinition_SIC);
...</pre>
    </td>
  </tr>
</table>
<p>To find the geometrical element of the single connector
such as points &quot;Point.1&quot; or &quot;Point.2&quot; defined in its
open body we use the following method:</p>
<p>First, we retrieve the part of the single connector:</p>
<table class="code">
  <tr>
    <td>
      <pre>...
CATILinkableObject_var hLinkable_SIC (hProduct_Single_Connector_Ref);
CATDocument * pDocOfPart_SIC = hLinkable_SIC-&gt;GetDocument();
...
CATIContainer_var hPart_SIC_RootContainer =pPart_SIC_RootContainer;
pPart_SIC_RootContainer -&gt;Release();
CATIPrtContainer_var hPartContainer_SIC = hPart_SIC_RootContainer;
CATIPrtPart_var hPart_SIC = hPartContainer_SIC-&gt;GetPart();
...</pre>
    </td>
  </tr>
</table>
<p>The first point &quot;Point.1&quot; defined in the
Openbody of the part is retrieved using a locally method named FindInPart()</p>
<table class="code">
  <tr>
    <td>
      <pre>...
CATBaseUnknown * pPointOnSIC = NULL;
rc = FindInPart(hPart_SIC,IID_CATIGSMPoint,&quot;Point.1&quot;,pPointOnSIC);
...</pre>
    </td>
  </tr>
</table>
<p>The method FindInPart returns an entity which is
defined in the part, with argument an instance name of element we are
looking for and the unique identifier of the interface.</p>
<table class="code">
  <tr>
    <td>
      <pre>...
CATIDescendants_var hDescendant(hPart);
CATListValCATISpecObject_var  hElementlist; 
hDescendant-&gt;GetAllChildren(CATISpecObject::ClassName(), hElementlist);
...
int Taille_ElementList = hElementlist.Size() ;
for (int i=1; i&lt;=Taille_ElementList ; i++)
{
  CATBaseUnknown * ptInternalPtr = NULL;
  CATIAlias_var hAlias ( hElementlist[i]);
  ...
  hElementlist[i]-&gt;QueryInterface (iIID, (void**)&amp; ptInternalPtr);
  ...
  if (hAlias-&gt;GetAlias() == InstanceName) 
  {
    RC = ptInternalPtr-&gt;QueryInterface(CATBaseUnknown::ClassId(), (void**)&amp; oEntity);
    if(SUCCEEDED(RC) &amp;&amp; oEntity)
    {
      ptInternalPtr-&gt;Release(); 
       break;
    }
    else 
    {
      RC = E_FAIL;
      ptInternalPtr-&gt;Release(); 
      return RC;
    }          
  }
  ptInternalPtr-&gt;Release();
  ...
}
...</pre>
    </td>
  </tr>
</table>
<p>Then we find the graphical representation of the point:</p>
<table class="code">
  <tr>
    <td>
      <pre>...
CATILinkableObject * ptRepresentationOfPoint_SIC = NULL;
rc = pPointOnSIC-&gt;QueryInterface(CATILinkableObject::ClassId(), (void**)&amp; ptRepresentationOfPoint_SIC);
...</pre>
    </td>
  </tr>
</table>
<p>Finally, we create the termination:</p>
<table class="code">
  <tr>
    <td>
      <pre>...
CATIElbSingleConnectorReference_var hSingleConnectorRefer(hProduct_Single_Connector_Ref);
...
CATUnicodeString Id_Number = &quot;Termination_01&quot;;
int iPositionNumber = 0;
CATIElbTermination * pElbTermination = NULL;
rc = hSingleConnectorRefer-&gt;AddTermination(Id_Number,
                                              iPositionNumber,
                                              pGeoDefinition_SIC,
                                              ptRepresentationOfPoint_SIC,
                                              pElbTermination);
...</pre>
    </td>
  </tr>
</table>
<h4><a name="Step20"></a>Defining a connector connection point on the second
single connector</h4>
<p>The connector connection point is created using the services
AddConnectorCnctPt of CATIElbSingleConnector interfaces as follows:</p>
<table class="code">
  <tr>
    <td><pre>CATIElbSingleConnector * pElbSIC = NULL;
rc = pProduct_Single_Connector-&gt;QueryInterface(IID_CATIElbSingleConnector,(void**)&amp; pElbSIC);

CATUnicodeString JointType = &quot;ConnectorCnctPt&quot;;
Id_Number = &quot;ConnectorCnctPt_01&quot;;
CATIElbConnectorCnctPt * pElbCntrCnctPt = NULL;

rc = pElbSIC-&gt;AddConnectorCnctPt(Id_Number,
                                    pProduct_Single_Connector,
                                    ptRepresentationOfPoint_SIC,
                                    JointType,
                                    pListJointReferenceFirstSIC,
                                    pElbCntrCnctPt);</pre>
</td>
  </tr>
</table>
<p align="center"><img border="0" src="images/CAAElb16.jpg" width="664" height="606"></p>
<p>Above is a CATIA image of the result of our study.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<h4><a name="Step19"></a>Importing the part
&quot;Second_SingleConnector.CATPart&quot;</b></h4>
<p>The part &quot;Second_SingleConnector.CATPart&quot; is imported
using the local method FindInPart() as follows:</p>
<table class="code">
  <tr>
    <td>
      <pre>...
CATIProduct * pProduct_Second_SIC= NULL;  
rc = Import(hProduct_Level_1, PATH_Second_SIC,pProduct_Second_SIC);
...</pre>
    </td>
  </tr>
</table>
<p align="center"><img border="0" src="images/CAAElbsecsic.jpg" width="641" height="434"></p>
<p>Above is a CATIA image of the second single connector
part.</p>
<h4><a name="Step20"></a>Defining three cavities on the second single connector</h4>
<p>Firstly we retrieve the list of published geometry using the methods of
CATIPrdObjectPublisher interface. This geometry is then used to create the
cavity.</p>
<table class="code">
  <tr>
    <td>
      <pre>CATIPrdObjectPublisher * pPrdObjectPublisher = NULL;
rc = hProductSecondSICRef-&gt;QueryInterface(IID_CATIPrdObjectPublisher,(void**)&amp;pPrdObjectPublisher);
....
CATListValCATUnicodeString * pListOfPublications = NULL;
int hasPublication = pPrdObjectPublisher-&gt;ListPublications(pListOfPublications);

CATBaseUnknown * P_PublicationGeometrique=NULL;
CATUnicodeString SubPublication;
int i=0;
int result = 0;>
for( i=1;i&lt;=2;i++)
{
  result = pPrdObjectPublisher-&gt;GetDirectObject ((*pListOfPublications)[i],
                                                    P_PublicationGeometrique,
                                                    SubPublication);
}</pre>
</td>
</tr>
</table>
<p>The cavity is created using the method AddCavity() of
CATIElbSingleConnectorReference interface as follows:</p>
<table class="code">
  <tr>
    <td>
      <pre>if(i==1) 
  P_PublicationGeometrique-&gt;QueryInterface(IID_CATILinkableObject,(void**)&amp;pRepresentation);
...
CATUnicodeString ID_NUMBER = &quot;First_Cavity&quot;;
int Number = 0;
CATIElbCavity * pElbCavity = NULL;
rc = pElecRefSecondSIC-&gt;AddCavity(ID_NUMBER, Number, pGeoDefinition,pRepresentation,pListJointReference,pElbCavity);</pre>
    </td>
  </tr>
</table>
<p align="center"><img border="0" src="images/CAAElbsecsic2.jpg" width="666" height="513"></p>
<h4><a name="Step19"></a><b>Importing the part
&quot;MountingEquipment.CATPart&quot;</b></h4>
<p>The part &quot;MountingEquipmentr.CATPart&quot; is imported using
the local method FindInPart() as follows:</p>
<table class="code">
  <tr>
    <td>
      <pre>...
CATIProduct * pProduct_MountingEqt = NULL;
rc = Import(hProduct_Level_1, PATH_MountingEqt,pProduct_MountingEqt);
...</pre>
    </td>
  </tr>
</table>
<p>
<img border="0" src="images/CAAElb10.jpg" width="681" height="611"></p>
<p>Above is a CATIA image of the mounting equipment part.</p>
<h4><a name="Step7"></a>Extending this part in Mounting Equipment</h4>
<p>We need the method ExtendPrdAsMountingEquipment() of the interface <i>CATIElb</i>Factory
to extend the product in mounting equipment.</p>
<table class="code">
  <tr>
    <td>
      <pre>...
CATIProduct_var hProduct_MountingEqt_Ref = pProduct_MountingEqt-&gt;GetReferenceProduct();
hElbFactory = hProduct_MountingEqt_Ref;
rc = hElbFactory -&gt; ExtendPrdAsMountingEquipment() ;
... </pre>
    </td>
  </tr>
</table>
<h4><a name="Step20"></a>Defining a cavity on the mounting equipment</h4>
<p>Firstly we retrieve the list of published geometry using the methods of
CATIPrdObjectPublisher interface and we use this geometry to create the cavity:</p>
<table class="code">
  <tr>
    <td>
      <pre>rc = hProduct_MountingEqt_Ref-&gt;QueryInterface(IID_CATIPrdObjectPublisher,(void**)&amp;pPrdObjectPublisher);
...
hasPublication = pPrdObjectPublisher-&gt;ListPublications(pListOfPublications);
for ( i=1; i&lt;=2; i++)
{
  result = pPrdObjectPublisher-&gt;GetDirectObject ((*pListOfPublications)[i],
                                                  P_PublicationGeometrique,
                                                  SubPublication);
}</pre>
</td>
</tr>
</table>
<p>The cavity is created using the services AddCavity() of
CATIElbMountingEquipmentReference interface as follows:</p>
<table class="code">
  <tr>
    <td>
      <pre>if(i==1) 
  P_PublicationGeometrique-&gt;QueryInterface(IID_CATILinkableObject,(void**)&amp;pRepresentation);
...
Id_Number = &quot;First_Cavity&quot;;
JointType = &quot;Cavity&quot;;
int Number = 0;
CATIElbCavity * pElbCavity = NULL;
rc = pElecRefMountingEqt-&gt;AddCavity(ID_NUMBER, Number, pGeoDefinition,pRepresentation,pListJointReference,pElbCavity);</pre>
    </td>
  </tr>
</table>
<p align="center"><img border="0" src="images/CAAElb12.jpg" width="680" height="566"></p>
<p>Above is a CATIA image of the mounting equipment part after the
creation of the cavity.</p>
<h4><a name="Step19"></a>Importing the part
&quot;Third_Single_Connector.CATPart&quot;</h4>
<p>The part &quot;Third_Single_Connector.CATPart&quot; is
imported using the local method FindInPart() as follows:</p>
<table class="code">
  <tr>
    <td>
      <pre>...
CATIProduct * pProduct_Third_SIC= NULL;
rc = Import(hProduct_Level_1, PATH_Third_SIC,pProduct_Third_SIC);
...</pre>
    </td>
  </tr>
</table>
<h4><a name="Step20"></a><b>Defining a connector connection point on the third
single connector</b></h4>
<p>The connector connection point is created using the method
AddConnectorCnctPt of CATIElbSingleConnector interface as follows:</p>
<table class="code">
  <tr>
    <td><pre>CATIElbSingleConnector * pElbThirdSIC = NULL;
rc = pProduct_Single_Connector-&gt;QueryInterface(IID_CATIElbSingleConnector,(void**) &amp; pElbThirdSIC);

JointType = &quot;ConnectorCnctPt&quot;;
Id_Number = &quot;First_ConnectorCnctP&quot;;
CATIElbConnectorCnctPt * pElbConnectorCnctPt = NULL;

rc = pElbSIC-&gt;AddConnectorCnctPt(Id_Number,
                                    pProduct_Third_SIC,
                                    pRepresentation,
                                    JointType,
                                    pListJointReferenceThirdSIC,
                                    pElbConnectorCnctPt);</pre></td>
  </tr>
</table>
<p>
<img border="0" src="images/CAAElb13.jpg" width="829" height="576"></p>
<p>Above is a CATIA image of the third single connector after the creation
of the connector connection point (the mounting equipment is in no-show).</p>
<h4><a name="Step18"></a>Epilog</h4>
<p>Removing document from session and closing the session.</p>
<table class="code">
  <tr>
    <td>
      <pre>CATBoolean iSavePointedIfNecessary = TRUE;  
rc = CATDocumentServices::SaveAs ( *pDocOfPart_BackShell,argv[6],&quot;.CATPart&quot;,iSavePointedIfNecessary );
rc = CATDocumentServices::SaveAs ( *pDocOfPart_SIC,argv[7],&quot;.CATPart&quot;,iSavePointedIfNecessary );</pre>
      <pre>rc = CATDocumentServices::SaveAs ( *pDocOfPart_SecondSIC,argv[8],&quot;.CATPart&quot;,iSavePointedIfNecessary );
rc = CATDocumentServices::SaveAs ( *pDocOfPart_ThirdSIC,argv[9],&quot;.CATPart&quot;,iSavePointedIfNecessary );
rc = CATDocumentServices::SaveAs ( *pDocOfPart_MountingEqt,argv[10],&quot;.CATPart&quot;,iSavePointedIfNecessary );

rc = CATDocumentServices::SaveAs ( *pDoc_Level_1,argv[11],&quot;.CATProduct&quot;,iSavePointedIfNecessary );
rc = CATDocumentServices::SaveAs ( *pMainPrdDoc,argv[12],&quot;.CATProduct&quot;,iSavePointedIfNecessary );
...
rc = CATDocumentServices::Remove(*pDoc);
rc = ::Delete_Session(sessionName);
...</pre>
    </td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="InShort"></a>In Short</h3>
<p>This use case has demonstrated the way to create electrical devices in a
document such as single connector, back shell or mounting equipment, and how
adding electrical connectors on these devices such as terminations, cavities or
connector connection points.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="References"></a>References</h3>
<table width="100%">
  <tr>
    <td valign="top">[1]</td>
    <td><a href="../CAADocUseCases/CAADocRunSample.htm">Building
      and Launching a CAA V5 Use Case</a></td>
  </tr>
  <tr>
    <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="history"></a>History</h3>
<table width="100%">
  <tr>
    <td valign="top">Version: <strong>1</strong> [March 2003]</td>
    <td valign="top">Document created</td>
  </tr>
  <tr>
    <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<p><i>Copyright © 2003, Dassault Systèmes. All rights reserved.</i></p>

</body>

</html>
