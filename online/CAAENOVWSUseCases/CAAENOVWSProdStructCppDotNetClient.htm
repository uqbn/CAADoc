<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <link rel="Stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css">
    <title>
      Consuming the ENOVWSProdStructCpp CAA Web Service
    </title>
  </head>
  <body>
    <table width="100%">
      <tbody>
        <tr>
          <td valign="top">
            <h1>
              CAA Web Services Home
            </h1>
          </td>
          <td valign="top">
            <h2>
              &nbsp;
            </h2>
          </td>
          <td rowspan="2" align="right" valign="top">
            <h3>
              <a name="Top" id="Top"></a>Consuming the ENOVWSProdStructCpp CAA Web Service
            </h3><em>Using the ENOVWSProdStructCpp CAA Web service for product structure management</em>
          </td>
        </tr>
        <tr>
          <td class="use" colspan="2">
            Use Case
          </td>
        </tr>
      </tbody>
    </table>
    <hr>
    <!-- HEADER ======================================================================================= HEADER -->
    <table class="abstract">
      <tbody>
        <tr>
          <td>
            <h3>
              Abstract
            </h3>
            <p>
              This article discusses the <strong>CAAENOVWSDotNet1_1Client</strong> use case. It describes how to use
              the C# client binding that can be generated using the wsdl.exe utility in order to consume the
              <strong>ENOVWSProdStructCpp CAA Web service</strong>. It provides a sample usage scenario that
              demonstrates how to handle product structure management.
            </p>
            <ul>
              <li>
                <a href="#1"><strong>What You Will Learn With This Use Case</strong></a>
              </li>
              <li>
                <a href="#2"><strong>The CAAENOVWSDotNet1_1Client Use Case</strong></a>
                <ul>
                  <li>
                    <a href="#2.1">What Does CAAENOVWSDotNet1_1Client Do</a>
                  </li>
                  <li>
                    <a href="#2.2">Where To Find the CAAENOVWSDotNet1_1Client Code</a>
                  </li>
                  <li>
                    <a href="#2.3">How to Launch CAAENOVWSDotNet1_1Client</a>
                  </li>
                </ul>
              </li>
              <li>
                <a href="#3"><strong>Step-by-step</strong></a>
              </li>
              <li>
                <a href="#InShort"><strong>In Short</strong></a>
              </li>
              <li>
                <a href="#References"><strong>References</strong></a>
              </li>
            </ul>
          </td>
        </tr>
      </tbody>
    </table>
    <hr>
    <!-- SECTION 1 ================================================================================= SECTION 1 -->
    <h3>
      <a name="1"></a>What You Will Learn With This Use Case
    </h3>
    <p>
      This use case demonstrates how to write a client application that consumes the ENOVWSProdStructCpp CAA Web
      service. It helps you to:
    </p>
    <ul>
      <li>Generate the C# client binding for the ENOVWSProdStructCpp CAA Web service,
      </li>
      <li>Configure and use the generated proxy,
      </li>
      <li>Understand a sample usage scenario of the ENOVWSProdStructCpp CAA Web service.
      </li>
    </ul>
    <p align="right">
      [<a href="#Top">Top</a>]
    </p><!-- SECTION 2 ================================================================================= SECTION 2 -->
    <h3>
      <a name="2"></a>The CAAENOVWSDotNet1_1Client Use Case
    </h3>
    <p>
      CAAENOVWSDotNet1_1Client is a use case of the CAAENOVWS.edu framework that illustrates the ENOVWSProdStructCpp
      CAA Web service capabilities.
    </p>
    <p align="right">
      [<a href="#Top">Top</a>]
    </p><!-- SECTION 2.1 ============================================================================= SECTION 2.1 -->
    <h4>
      <a name="2.1"></a>What Does CAAENOVWSDotNet1_1Client Do
    </h4>
    <p>
      The sample usage scenario delivered with this use case contains the following steps:
    </p>
    <ul>
      <li>Query for a Product Root Class (PRC). Retrieve its UUID,
      </li>
      <li>Create two parts. Retrieve their UUIDs,
      </li>
      <li>Add the first part as a child of the parent PRC. Retrieve the UUID for the first instance created,
      </li>
      <li>Add the second part version as a child of the created instance. Retrieve the UUID for the second instance
      created,
      </li>
      <li>Expand the created product structure. Display its content,
      </li>
      <li>Delete the child instances and parts created.
      </li>
    </ul>
    <p align="right">
      [<a href="#Top">Top</a>]
    </p><!-- SECTION 2.2 ============================================================================= SECTION 2.2 -->
    <h4>
      <a name="2.2"></a>Where To Find the CAAENOVWSDotNet1_1Client Code
    </h4>
    <p>
      The CAAENOVWSDotNet1_1Client use case is made of several classes located in both
      <strong>CAAENOVWSDotNet1_1Client.m</strong> and <strong>CAAENOVWSDotNet1_1ClientBase.m</strong> modules of the
      <strong>CAAENOVWS.edu</strong> framework:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <td>
            <code><em>&lt;Install&gt;</em>\CAAENOVWS.edu\CAAENOVWSDotNet1_1Client.m\src</code><br>
            <code><em>&lt;Install&gt;</em>\CAAENOVWS.edu\CAAENOVWSDotNet1_1ClientBase.m\src</code>
          </td>
        </tr>
      </tbody>
    </table>
    <ul>
      <li>
        <code><em>&lt;Install&gt;</em></code>: the root directory where the CAA CD-ROM is installed.
      </li>
    </ul>
    <p>
      The CAAENOVWSDotNet1_1ClientBase.m module (library) contains the following resources:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <td>
            <code><em>&lt;Source&gt;</em>\CAAENOVWSProdStructCppProxy.cs<br>
            <em>&lt;Source&gt;</em>\CAAENOVWSProdStructCppWrapper.cs<br>
                    <i>&lt;Source&gt;</i>\CAAENOVWSUtils.cs</code></td>
        </tr>
      </tbody>
    </table>
    <ul>
      <li>
        <code><em>&lt;Source&gt;</em></code>:
        <code><em>&lt;Install&gt;</em>\CAAENOVWS.edu\CAAENOVWSDotNet1_1ClientBase.m\src</code>.
      </li>
    </ul>
    <p>
      The <strong>CAAENOVWSProdStructCppProxy.cs</strong> file contains the C# client binding generated using the
      wsdl.exe utility. A C# client binding consists of a proxy and several types definitions. The
      <strong>CAAENOVWSProdStructCppWrapper.cs</strong> file contains a class that describes how to configure the
      generated proxy and how to invoke its methods.
    </p>
    <p>
      The CAAENOVWSDotNet1_1Client.m module (executable) contains the following resources:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <td>
            <code><em>&lt;Source&gt;</em>\CAAENOVWSDotNet1_1Client.cs<br>
            <em>&lt;Source&gt;</em>\CAAENOVWSProdStructCppUseCase.cs</code>
          </td>
        </tr>
      </tbody>
    </table>
    <ul>
      <li>
        <code><em>&lt;Source&gt;</em></code>:
        <code><em>&lt;Install&gt;</em>\CAAENOVWS.edu\CAAENOVWSDotNet1_1Client.m\src</code>.
      </li>
    </ul>
    <p>
      The <strong>CAAENOVWSDotNet1_1Client.cs</strong> file contains the main program. It parses the command line
      inputs and starts up the use case. The <strong>CAAENOVWSProdStructCppUseCase.cs</strong> file contains the sample
      use case scenario.
    </p>
    <p align="right">
      [<a href="#Top">Top</a>]
    </p><!-- SECTION 2.3 ============================================================================= SECTION 2.3 -->
    <h4>
      <a name="2.3"></a>How to Launch CAAENOVWSDotNet1_1Client
    </h4>
    <p>
      Prerequisites to running this use case is that you need to login to ENOVIA LCA V5, create a Product Class and
      then create a Product with the V_ID = "IProdStructWS_CAA_PRC1".
    </p>
    <p>
      To run the CAAENOVWSDotNet1_1Client use case, you will need to build both CAAENOVWSDotNet1_1ClientBase.m and
      CAAENOVWSDotNet1_1Client.m modules. The use case code can be built using either the CAA V5 buildtime environment,
      or Visual Studio .NET 2003 as explained in [<a href="#References">1</a>].
    </p>
    <p>
      You can then execute the command described below:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <td>
            <code>CAAENOVWSDotNet1_1Client -w <em>&lt;URI&gt;</em> -e <em>&lt;ENOVIA username&gt;</em> -u <em>&lt;Basic
            Authentication username&gt;</em> -p <em>&lt;Basic Authentication password&gt;</em> -t
            ENOVWSProdStructCpp</code>
          </td>
        </tr>
      </tbody>
    </table>
    <ul>
      <li>
        <code><em>&lt;URI&gt;</em></code>: is the root URI of the Web application where the ENOVWSProdStructCpp CAA Web
        service is deployed,
      </li>
      <li>
        <code><em>&lt;ENOVIA username&gt;</em></code>: is a valid username declared in the ENOVIA P&amp;O database,
      </li>
      <li>
        <code><em>&lt;Basic Authentication Username&gt;</em> and <em>&lt;Basic Authentication Password&gt;</em></code>:
        are a valid set of credentials for authentication on the remote Web server.
      </li>
    </ul>
    <p>
      Here follows a sample command, to be updated with your own environment configuration:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <td>
            <code>CAAENOVWSDotNet1_1Client -w http://stophe1dsy.dsy.ds:9080/B17 -e cjk -u wpsadmin -p wpsadmin -t
            ENOVWSProdStructCpp</code>
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      The same executable is used to launch all of the available ENOVIA CAA Web services use cases. The <code>-t</code>
      option is used to choose the target use case to run.
    </p>
    <p>
      When building the modules with the CAA V5 buildtime environment, the CAAENOVWSDotNet1_1Client executable can be
      launched from the following location:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <td>
            <code><em>&lt;Install&gt;</em>\CAAENOVWS.edu\intel_a\code\clr</code>
          </td>
        </tr>
      </tbody>
    </table>
    <ul>
      <li>
        <code><em>&lt;Install&gt;</em></code>: the root directory where the CAA CD-ROM is installed.
      </li>
    </ul>
    <p align="right">
      [<a href="#Top">Top</a>]
    </p><!-- SECTION 3 ================================================================================= SECTION 3 -->
    <h3>
      <a name="3"></a>Step-by-step
    </h3>
    <p>
      The following section first explains how to generate the C# client binding for the ENOVWSProdStructCpp CAA Web
      service demonstrated. The remaining sections describe how to configure the generated proxy and how to consume the
      Web service:
    </p>
    <ol>
      <li>
        <a href="#3.1">Creating the C# Client Binding</a>
      </li>
      <li>
        <a href="#3.2">Instantiating and Configuring the Generated Proxy</a>
      </li>
      <li>
        <a href="#3.3">Creating Parts</a>
      </li>
      <li>
        <a href="#3.4">Adding Child Parts</a>
      </li>
      <li>
        <a href="#3.5">Expanding Product Structures</a>
      </li>
      <li>
        <a href="#3.6">Deleting Child Parts</a>
      </li>
      <li>
        <a href="#3.7">Deleting Child Parts</a>
      </li>
      <li>
        <a href="#3.8">Sample Usage Scenario</a>
      </li>
    </ol>
    <p align="right">
      [<a href="#Top">Top</a>]
    </p><!-- SECTION 3.1 ============================================================================= SECTION 3.1 -->
    <h4>
      <a name="3.1"></a>Creating the C# Client Binding
    </h4>
    <p>
      Please refer to [<a href="#References">2</a>] for details on how to generate the C# client binding using the
      wsdl.exe utility.
    </p>
    <p>
      Here follows a sample command in order to generate the C# client binding for the ENOVWSProdStructCpp CAA Web
      service:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <td>
            <code>wsdl /namespace:com.dassault_systemes.caaenovws.caaenovwsdotnet1_1clientgen.enovwsprodstructcpp
            /username:wpsadmin /password:wpsadmin /out:CAAENOVWSProdStructCppProxy.cs
            http://stophe1dsy.dsy.ds:9080/B17/wsdl?service=urn:com:dassault_systemes:ENOVWSProdStructImpl:ENOVWSProdStructImpl:ENOVWSProdStructCpp</code>
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      The server name, port, and context root URI information must be updated to match the server where the
      ENOVWSProdStructCpp CAA Web service has been deployed. The <code>/username</code> and <code>/username</code>
      options are required to authenticate on the Web server hosting the Web service.
    </p>
    <p align="right">
      [<a href="#Top">Top</a>]
    </p><!-- SECTION 3.2 ============================================================================= SECTION 3.2 -->
    <h4>
      <a name="3.2"></a>Instantiating and Configuring the Generated Proxy
    </h4>
    <p>
      In order to consume an implementation of the ENOVWSProdStructCpp CAA Web service deployed on a target Web server,
      you first need to instantiate the proxy generated using the wsdl.exe utility. This proxy must then be configured
      in order to manage authentication on the remote Web server, timeout, and session management. Maintaining the HTTP
      session state is mandatory when consuming ENOVIA LCA V5 CAA Web services.
    </p>
    <p>
      The generated proxy class is used in order to marshall method calls and objects to SOAP requests, and to
      unmarshall SOAP responses to objects. The following code describes how to instantiate and configure it:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <!-- Not using <pre></pre> because otherwise it doesn't print right -->
          <td>
            <code><font color="#0000FF">public class</font> CAAENOVWSProdStructCppWrapper {<br>
            &nbsp; <font color="#0000FF">private const string</font> SERVICE_ID =
            "urn:com:dassault_systemes:ENOVWSProdStructImpl:ENOVWSProdStructImpl:ENOVWSProdStructCpp";<br>
            &nbsp; <font color="#0000FF">private</font> CAAENOVWSProdStructCppProxy proxy = <font color=
            "#0000FF">null</font>;<br>
            <br>
            &nbsp; <font color="#0000FF">public</font> CAAENOVWSProdStructCppWrapper(<br>
            &nbsp; &nbsp; CookieContainer container,<br>
            &nbsp; &nbsp; <font color="#0000FF">string</font> uri,<br>
            &nbsp; &nbsp; <font color="#0000FF">string</font> credUser,<br>
            &nbsp; &nbsp; <font color="#0000FF">string</font> credPwd,<br>
            &nbsp; &nbsp; <font color="#0000FF">int</font> timeOut) {<br>
            &nbsp; &nbsp; proxy = <font color="#0000FF">new</font> CAAENOVWSProdStructCppProxy();<br>
            <br>
            &nbsp; &nbsp; <font color="#008000">// Compute the SOAP endpoint URI value that bounds to the deployed<br>
            &nbsp; &nbsp; // implementation of the ENOVWSProdStructCpp CAA Web service</font><br>
            &nbsp; &nbsp; proxy.Url = uri + "servicerouter?service=" + SERVICE_ID;<br>
            <br>
            &nbsp; &nbsp; <font color="#008000">// Required for HTTP session state management</font><br>
            &nbsp; &nbsp; proxy.CookieContainer = container; <strong>(1)</strong><br>
            <br>
            &nbsp; &nbsp; <font color="#008000">// Required for the Basic Authentication mechanism</font><br>
            &nbsp; &nbsp; ICredentials credentials = <font color="#0000FF">new</font> NetworkCredential(credUser,
            credPwd);<br>
            &nbsp; &nbsp; proxy.Credentials = credentials; <strong>(2)</strong><br>
            <br>
            &nbsp; &nbsp; <font color="#008000">// Increase the default client time-out</font><br>
            &nbsp; &nbsp; proxy.Timeout = timeOut; <strong>(3)</strong><br>
            &nbsp; }<br>
            }</code>
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <strong>(1)</strong>: in order to maintain the HTTP session state between successive calls performed using either
      the same or multiple proxy instances, the <code>CookieContainer</code> property must be set on the proxy. This is
      mandatory in the context of ENOVIA LCA V5 CAA Web services,<br>
      <strong>(2)</strong>: when security is enabled on the remote Web server, it is mandatory to set the
      <code>Credentials</code> property on the proxy. The values specified must match a valid set of credentials for
      the Basic Authentication mechanism,<br>
      <strong>(3)</strong>: the default timeout value can be increased in order to avoid potential issues at runtime,
      such as losing the HTTP connection before receiving the SOAP responses. The value specified in the code is in
      milliseconds.
    </p>
    <p align="right">
      [<a href="#Top">Top</a>]
    </p><!-- SECTION 3.3 ============================================================================= SECTION 3.3 -->
    <h4>
      <a name="3.3"></a>Creating Parts
    </h4>
    <p>
      In order to create parts, you can use the following method available through the generated proxy interface:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <td>
            <a name="CreatePart" id="CreatePart"></a><code><font color="#0000FF">public</font> Status CreatePart(ENOVIA
            iObjects, <font color="#0000FF">string</font> iConfigurable, <font color="#0000FF">ref</font> ENOVIA
            oObjects)</code>
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      This method accepts the following parameters:
    </p>
    <table>
      <tbody>
        <tr>
          <td>
            <code>[in] iObjects</code>
          </td>
          <td>
            &nbsp; List of Part Versions to be created
          </td>
        </tr>
        <tr>
          <td>
            <code>[in] iConfigurable</code>
          </td>
          <td>
            &nbsp; TRUE or FALSE (default of FALSE)
          </td>
        </tr>
        <tr>
          <td>
            <code>[in/out] oObjects</code>
          </td>
          <td>
            &nbsp; The successfully created objects
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      The following code demonstrates the use of the <code><a href="#CreatePart">CreatePart</a></code> method:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <!-- Not using <pre></pre> because it doesn't print right -->
          <td>
            <code><font color="#0000FF">public class</font> CAAENOVWSProdStructCppWrapper {<br>
            &nbsp; ...<br>
            &nbsp; <font color="#0000FF">public</font> ENOVIA CreatePartRef(<br>
            &nbsp; &nbsp; <font color="#0000FF">string</font>[] partNumbers,<br>
            &nbsp; &nbsp; <font color="#0000FF">string</font> domain,<br>
            &nbsp; &nbsp; <font color="#0000FF">string</font> configurable) {<br>
            &nbsp; &nbsp; <font color="#0000FF">if</font> (partNumbers == <font color="#0000FF">null</font>) {<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Illegal argument: part
            number array is null");<br>
            &nbsp; &nbsp; } <font color="#0000FF">else if</font> (domain == <font color="#0000FF">null</font>) {<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Illegal argument:
            environment domain is null");<br>
            &nbsp; &nbsp; } <font color="#0000FF">else if</font> (configurable == <font color="#0000FF">null</font>)
            {<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Illegal argument:
            configurable flag is null");<br>
            &nbsp; &nbsp; }<br>
            <br>
            &nbsp; &nbsp; ENOVIA_VPMPartVersion[] vpmPartVersions =<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">new</font> ENOVIA_VPMPartVersion[partNumbers.Length];<br>
            &nbsp; &nbsp; <font color="#0000FF">for</font> (<font color="#0000FF">int</font> i = 0; i &lt;
            partNumbers.Length; i++) {<br>
            &nbsp; &nbsp; &nbsp; vpmPartVersions[i] = new ENOVIA_VPMPartVersion();<br>
            &nbsp; &nbsp; &nbsp; vpmPartVersions[i].Domain = domain;<br>
            &nbsp; &nbsp; &nbsp; vpmPartVersions[i].ENOVIA_VPMPartMasterV_ID = partNumbers[i];<br>
            &nbsp; &nbsp; }<br>
            <br>
            &nbsp; &nbsp; ENOVIA input = <font color="#0000FF">new</font> ENOVIA();<br>
            &nbsp; &nbsp; input.ENOVIA_VPMPartVersion = vpmPartVersions;<br>
            &nbsp; &nbsp; ENOVIA resultSet = <font color="#0000FF">null</font>;<br>
            <br>
            &nbsp; &nbsp; <font color="#0000FF">try</font> {<br>
            &nbsp; &nbsp; &nbsp; <strong>Status status = proxy.CreatePart(input, configurable, <font color=
            "#0000FF">ref</font> resultSet);</strong><br>
            &nbsp; &nbsp; &nbsp; Console.Out.WriteLine("Status: {0}", status.Status1);<br>
            &nbsp; &nbsp; } <font color="#0000FF">catch</font> (Exception e) {<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Failed to create part
            reference(s)", e);<br>
            &nbsp; &nbsp; }<br>
            <br>
            &nbsp; &nbsp; <font color="#0000FF">if</font> (resultSet == <font color="#0000FF">null</font>) {<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> Exception("Failed to create part
            reference(s)");<br>
            &nbsp; &nbsp; }<br>
            &nbsp; &nbsp; <font color="#0000FF">return</font> resultSet;<br>
            &nbsp; }&nbsp;<br>
            <br>
            &nbsp; <font color="#0000FF">public string</font>[] GetENOVIA_VPMPartVersionUUIDs(ENOVIA resultSet) {<br>
            &nbsp; &nbsp; <font color="#0000FF">if</font> (resultSet == <font color="#0000FF">null</font>) {<br>
            &nbsp; &nbsp; &nbsp; throw new ApplicationException("Illegal argument exception: ENOVIA result set is
            null");<br>
            &nbsp; &nbsp; }<br>
            <br>
            &nbsp; &nbsp; ENOVIA_VPMPartVersion[] vpmPartVersions =<br>
            &nbsp; &nbsp; &nbsp; resultSet.ENOVIA_VPMPartVersion;<br>
            &nbsp; &nbsp; <font color="#0000FF">if</font> (vpmPartVersions == <font color="#0000FF">null</font>) {<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Failed to retrieve
            ENOVIA_VPMPartVersion objects");<br>
            &nbsp; &nbsp; }<br>
            <br>
            &nbsp; &nbsp; <font color="#0000FF">string</font>[] vpmPartVersionUUIDs = <font color="#0000FF">new
            string</font>[vpmPartVersions.Length];<br>
            &nbsp; &nbsp; for (int i = 0; i &lt; vpmPartVersions.Length; i++) {<br>
            &nbsp; &nbsp; &nbsp; vpmPartVersionUUIDs[i] = vpmPartVersions[i].CATJsyUUID;<br>
            &nbsp; &nbsp; }<br>
            &nbsp; &nbsp; <font color="#0000FF">return</font> vpmPartVersionUUIDs;<br>
            &nbsp; }<br>
            }</code>
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      The <code>GetENOVIA_VPMPartVersionUUIDs</code> method is used to scan the ENOVIA result set returned and retrieve
      the UUIDs of the created part references.
    </p>
    <p align="right">
      [<a href="#Top">Top</a>]
    </p><!-- SECTION 3.4 ============================================================================= SECTION 3.4 -->
    <h4>
      <a name="3.4"></a>Adding Child Parts
    </h4>
    <p>
      In order to add child parts, you can use the following method available through the generated proxy interface:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <td>
            <a name="AddChildPart" id="AddChildPart"></a><code><font color="#0000FF">public</font> Status
            AddChildPart(Identifier iParentId, Identifier[] iChildIds, <font color="#0000FF">ref</font> ENOVIA
            oResult)</code>
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      The method accepts the following parameters:
    </p>
    <table>
      <tbody>
        <tr>
          <td>
            <code>[in] iParentId</code>
          </td>
          <td>
            &nbsp; The identifier of the parent object
          </td>
        </tr>
        <tr>
          <td>
            <code>[in] iChildIds</code>
          </td>
          <td>
            &nbsp; The array of child identifiers
          </td>
        </tr>
        <tr>
          <td>
            <code>[in/out] oResult</code>
          </td>
          <td>
            &nbsp; The child part instances added to the parent
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      The following code demonstrates the use of the <code><a href="#AddChildPart">AddChildPart</a></code> method:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <!-- Not using <pre></pre> because it doesn't print right -->
          <td>
            <code><font color="#0000FF">public class</font> CAAENOVWSProdStructCppWrapper {<br>
            &nbsp; ...<br>
            &nbsp; <font color="#0000FF">private</font> Identifier ToIdentifier(<font color="#0000FF">string</font> id)
            {<br>
            &nbsp; &nbsp; <font color="#0000FF">if</font> (id == <font color="#0000FF">null</font>) {<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Illegal argument:
            identifier value is null");<br>
            &nbsp; &nbsp; }<br>
            <br>
            &nbsp; &nbsp; Identifier identifier = <font color="#0000FF">new</font> Identifier();<br>
            &nbsp; &nbsp; identifier.Identifier1 = CAAENOVWSUtils.ConvertFromHexToBinary(id);<br>
            &nbsp; &nbsp; <font color="#0000FF">return</font> identifier;<br>
            &nbsp; }<br>
            <br>
            &nbsp; <font color="#0000FF">private</font> Identifier[] ToIdentifierArray(<font color=
            "#0000FF">string</font>[] ids) {<br>
            &nbsp; &nbsp; <font color="#0000FF">if</font> (ids == <font color="#0000FF">null</font>) {<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Illegal argument:
            identifiers array is null");<br>
            &nbsp; &nbsp; }<br>
            <br>
            &nbsp; &nbsp; Identifier[] identifiers = <font color="#0000FF">new</font> Identifier[ids.Length];<br>
            &nbsp; &nbsp; <font color="#0000FF">for</font> (<font color="#0000FF">int</font> i = 0; i &lt; ids.Length;
            i++) {<br>
            &nbsp; &nbsp; &nbsp; identifiers[i] = ToIdentifier(ids[i]);<br>
            &nbsp; &nbsp; }<br>
            &nbsp; &nbsp; <font color="#0000FF">return</font> identifiers;<br>
            &nbsp; }<br>
            <br>
            &nbsp; <font color="#0000FF">public</font> ENOVIA CreatePartInst(<font color="#0000FF">string</font>
            parentUUID, <font color="#0000FF">string</font>[] partRefUUIDs) {<br>
            &nbsp; &nbsp; <font color="#0000FF">if</font> (parentUUID == <font color="#0000FF">null</font>) {<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> Exception("Illegal argument: parent UUID is
            null");<br>
            &nbsp; &nbsp; } <font color="#0000FF">else if</font> (partRefUUIDs == <font color="#0000FF">null</font>)
            {<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> Exception("Illegal argument: part instance UUID
            array is null");<br>
            &nbsp; &nbsp; }<br>
            <br>
            &nbsp; &nbsp; Identifier parentId = ToIdentifier(parentUUID);<br>
            &nbsp; &nbsp; Identifier[] partRefIds = ToIdentifierArray(partRefUUIDs);<br>
            &nbsp; &nbsp; ENOVIA resultSet = <font color="#0000FF">null</font>;<br>
            <br>
            &nbsp; &nbsp; <font color="#0000FF">try</font> {<br>
            &nbsp; &nbsp; &nbsp; <strong>Status status =<br>
            &nbsp; &nbsp; &nbsp; &nbsp; proxy.AddChildPart(parentId, partRefIds, <font color="#0000FF">ref</font>
            resultSet);<br></strong> &nbsp; &nbsp; &nbsp; Console.Out.WriteLine("Status: {0}", status.Status1);<br>
            &nbsp; &nbsp; } <font color="#0000FF">catch</font> (Exception e) {<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Failed to create part
            instance(s)", e);<br>
            &nbsp; &nbsp; }<br>
            <br>
            &nbsp; &nbsp; <font color="#0000FF">if</font> (resultSet == <font color="#0000FF">null</font>) {<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> Exception("Failed to create part
            instance(s)");<br>
            &nbsp; &nbsp; }<br>
            &nbsp; &nbsp; <font color="#0000FF">return</font> resultSet;<br>
            &nbsp; }<br>
            <br>
            &nbsp; <font color="#0000FF">public string</font>[] GetVPMBOPartInstanceUUIDs(ENOVIA resultSet) {<br>
            &nbsp; &nbsp; <font color="#0000FF">if</font> (resultSet == <font color="#0000FF">null</font>) {<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Illegal argument
            exception: ENOVIA result set is null");<br>
            &nbsp; &nbsp; }<br>
            <br>
            &nbsp; &nbsp; VPMBOPartInstance[] vpmBOPartInstances = resultSet.VPMBOPartInstance;<br>
            &nbsp; &nbsp; <font color="#0000FF">if</font> (vpmBOPartInstances == <font color="#0000FF">null</font>)
            {<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Failed to retrieve
            VPMBOPartInstance objects");<br>
            &nbsp; &nbsp; }<br>
            <br>
            &nbsp; &nbsp; <font color="#0000FF">string</font>[] vpmBOPartInstanceUUIDs = <font color="#0000FF">new
            string</font>[vpmBOPartInstances.Length];<br>
            &nbsp; &nbsp; <font color="#0000FF">for</font> (<font color="#0000FF">int</font> i = 0; i &lt;
            vpmBOPartInstances.Length; i++) {<br>
            &nbsp; &nbsp; &nbsp; vpmBOPartInstanceUUIDs[i] = vpmBOPartInstances[i].CATJsyUUID;<br>
            &nbsp; &nbsp; }<br>
            &nbsp; &nbsp; <font color="#0000FF">return</font> vpmBOPartInstanceUUIDs;<br>
            &nbsp; }<br>
            }</code>
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      The <code>CAAENOVWSUtils.ConvertFromHexToBinary</code> method can be found at:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <td>
            <code><em>&lt;Source&gt;</em>\CAAENOVWSUtils.cs</code>
          </td>
        </tr>
      </tbody>
    </table>
    <ul>
      <li>
        <code><em>&lt;Source&gt;</em></code>:
        <code><em>&lt;Install&gt;</em>\CAAENOVWS.edu\CAAENOVWSDotNet1_1ClientBase.m\src</code>,
      </li>
      <li>
        <code><em>&lt;Install&gt;</em></code>: the root directory where the CAA CD-ROM is installed.
      </li>
    </ul>
    <p align="right">
      [<a href="#Top">Top</a>]
    </p><!-- SECTION 3.5 ============================================================================= SECTION 3.5 -->
    <h4>
      <a name="3.5"></a>Expanding Product Structures
    </h4>
    <p>
      In order to expand a product structure, you can use the following method available through the generated proxy
      interface:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <td>
            <a name="ExpandProductStructure" id="ExpandProductStructure"></a><code><font color="#0000FF">public</font>
            Status ExpandProductStructure(Identifier iObjectId, SelectExpression iSelect, <font color=
            "#0000FF">int</font> iDepth, <font color="#0000FF">ref</font> ENOVIA oResult)</code>
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      This method accepts the following parameters:
    </p>
    <table>
      <tbody>
        <tr>
          <td>
            <code>[in] iObjectId</code>
          </td>
          <td>
            &nbsp; The identifier of the parent object
          </td>
        </tr>
        <tr>
          <td>
            <code>[in] iSelect</code>
          </td>
          <td>
            &nbsp; The SelectExpression for query. See for [<a href="#References">3</a>] details
          </td>
        </tr>
        <tr>
          <td>
            <code>[in] iDepth</code>
          </td>
          <td>
            &nbsp; The depth of the structure that needs to be returned. '-1' will return all, '0' will return parent
            (and optionally attached documents), '1' will return first level children
          </td>
        </tr>
        <tr>
          <td>
            <code>[in/out] oResult</code>
          </td>
          <td>
            &nbsp; The child part instances added to the parent
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      The following code demonstrates the use of the <code><a href="#ExpandProductStructure">ExpandProductStructure</a></code> method:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <!-- Not using <pre></pre> because it doesn't print right -->
          <td>
            <code><font color="#0000FF">public class</font> CAAENOVWSProdStructCppWrapper {<br>
            &nbsp; ...<br>
            &nbsp; <font color="#0000FF">public</font> ENOVIA ExpandProductStructure(<br>
            &nbsp; &nbsp; <font color="#0000FF">string</font> parentUUID,<br>
            &nbsp; &nbsp; <font color="#0000FF">int</font> level,<br>
            &nbsp; &nbsp; <font color="#0000FF">string</font> selectExpression) {<br>
            &nbsp; &nbsp; <font color="#0000FF">if</font> (parentUUID == <font color="#0000FF">null</font>) {<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Illegal argument: parent
            UUID is null");<br>
            &nbsp; &nbsp; } <font color="#0000FF">else if</font> (level &lt; 0) {<br>
            &nbsp; &nbsp;&nbsp; &nbsp;<font color="#0000FF">throw new</font> ApplicationException("Illegal argument:
            invalid level value");<br>
            &nbsp; &nbsp; }<br>
            <br>
            &nbsp; &nbsp; Identifier parentId = ToIdentifier(parentUUID);<br>
            &nbsp; &nbsp; SelectExpression selectExp = <font color="#0000FF">new</font> SelectExpression();<br>
            &nbsp; &nbsp; selectExp.Value = selectExpression;<br>
            &nbsp; &nbsp; ENOVIA resultSet = <font color="#0000FF">null</font>;<br>
            <br>
            &nbsp; &nbsp; <font color="#0000FF">try</font> {<br>
            &nbsp; &nbsp; &nbsp; <strong>Status status =<br>
            &nbsp; &nbsp; &nbsp; &nbsp; proxy.ExpandProductStructure(<br>
            &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; parentId, selectExp, level, <font color="#0000FF">ref</font>
            resultSet);</strong><br>
            &nbsp; &nbsp; &nbsp; Console.WriteLine("Status: {0}", status.Status1);<br>
            &nbsp; &nbsp; } <font color="#0000FF">catch</font> (Exception e) {<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Failed to expand product
            structure", e);<br>
            &nbsp; &nbsp; }<br>
            <br>
            &nbsp; &nbsp; <font color="#0000FF">if</font> (resultSet == <font color="#0000FF">null</font>) {<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Failed to expand product
            structure");<br>
            &nbsp; &nbsp; }<br>
            &nbsp; &nbsp; <font color="#0000FF">return</font> resultSet;<br>
            &nbsp; }<br>
            }</code>
          </td>
        </tr>
      </tbody>
    </table>
    <!-- SECTION 3.6 ============================================================================= SECTION 3.6 -->
    <h4>
      <a name="3.6"></a>Deleting Child Parts
    </h4>
    <p>
      In order to delete child parts, you can use the following method available through the generated proxy interface:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <td>
            <a name="DeleteChildPart" id="DeleteChildPart"></a><code><font color="#0000FF">public</font> Status
            DeleteChildPart(Identifier iParentId, Identifier[] iChildIds)</code>
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      This method accepts the following parameters:
    </p>
    <table>
      <tbody>
        <tr>
          <td>
            <code>[in] iParentId</code>
          </td>
          <td>
            &nbsp; The identifier of the parent object in ENOVIA LCA V5
          </td>
        </tr>
        <tr>
          <td>
            <code>[in] iChildIds</code>
          </td>
          <td>
            &nbsp; The array of child identifiers
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      The following code demonstrates the use of the <code><a href="#DeleteChildPart">DeleteChildPart</a></code>
      method:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <!-- Not using <pre></pre> because it doesn't print right -->
          <td>
            <code><font color="#0000FF">public class</font> CAAENOVWSProdStructCppWrapper {<br>
            &nbsp; ...<br>
            &nbsp; <font color="#0000FF">public void</font> DeletePartInst(<font color="#0000FF">string</font>
            parentUUID, <font color="#0000FF">string</font>[] partInstUUIDs) {<br>
            &nbsp; &nbsp; <font color="#0000FF">if</font> (parentUUID == <font color="#0000FF">null</font>) {<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> Exception("Illegal argument: parent unique
            identifier is null");<br>
            &nbsp; &nbsp; } <font color="#0000FF">else if</font> (partInstUUIDs == <font color="#0000FF">null</font>)
            {<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> Exception("Illegal argument: part instance UUID
            array is null");<br>
            &nbsp; &nbsp; }<br>
            <br>
            &nbsp; &nbsp; Identifier parentId = ToIdentifier(parentUUID);<br>
            &nbsp; &nbsp; Identifier[] partInstIds = ToIdentifierArray(partInstUUIDs);<br>
            <br>
            &nbsp; &nbsp; <font color="#0000FF">try</font> {<br>
            &nbsp; &nbsp; &nbsp; <strong>Status status = proxy.DeleteChildPart(parentId, partInstIds);</strong><br>
            &nbsp; &nbsp; &nbsp; Console.Out.WriteLine("Status: {0}", status.Status1);<br>
            &nbsp; &nbsp; } <font color="#0000FF">catch</font> (Exception e) {<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Failed to delete part
            instance(s)", e);<br>
            &nbsp; &nbsp; }<br>
            &nbsp; }<br>
            }</code>
          </td>
        </tr>
      </tbody>
    </table>
    <p align="right">
      [<a href="#Top">Top</a>]
    </p><!-- SECTION 3.7 ============================================================================= SECTION 3.7 -->
    <h4>
      <a name="3.7"></a>Deleting Parts
    </h4>
    <p>
      In order to delete parts, you can use the following method available through the generated proxy interface:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <td>
            <a name="DeletePart" id="DeletePart"></a><code><font color="#0000FF">public</font> Status
            DeletePart(Identifier[] iObjectIds)</code>
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      This method accepts the following parameters:
    </p>
    <table>
      <tbody>
        <tr>
          <td>
            <code>[in] iObjectIds</code>
          </td>
          <td>
            &nbsp; List of identifiers for parts to be deleted
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      The following code demonstrates the use of the <code><a href="#DeletePart">DeletePart</a></code> method:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <!-- Not using <pre></pre> because it doesn't print right -->
          <td>
            <code><font color="#0000FF">public class</font> CAAENOVWSProdStructCppWrapper {<br>
            &nbsp; ...<br>
            &nbsp; <font color="#0000FF">public void</font> DeletePartRef(<font color="#0000FF">string</font>[]
            partRefUUIDs) {<br>
            &nbsp; &nbsp; <font color="#0000FF">if</font> (partRefUUIDs == <font color="#0000FF">null</font>) {<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> Exception("Illegal argument: part reference
            UUID array is null");<br>
            &nbsp; &nbsp; }<br>
            <br>
            &nbsp; &nbsp; Identifier[] partRefIds = ToIdentifierArray(partRefUUIDs);<br>
            <br>
            &nbsp; &nbsp; <font color="#0000FF">try</font> {<br>
            &nbsp; &nbsp; &nbsp; <strong>Status status = proxy.DeletePart(partRefIds);</strong><br>
            &nbsp; &nbsp; &nbsp; Console.Out.WriteLine("Status: {0}", status.Status1);<br>
            &nbsp; &nbsp; } <font color="#0000FF">catch</font> (Exception e) {<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Failed to delete part
            reference(s)", e);<br>
            &nbsp; &nbsp; }<br>
            &nbsp; }<br>
            }</code>
          </td>
        </tr>
      </tbody>
    </table>
    <p align="right">
      [<a href="#Top">Top</a>]
    </p><!-- SECTION 3.8 ============================================================================= SECTION 3.8 -->
    <h4>
      <a name="3.8"></a>Sample Usage Scenario
    </h4>
    <p>
      The following code assumes assumes that a Product Root Class has been created using the ENOVIA V5 LCA product,
      and that its V_ID is "IProdStructWS_CAA_PRC1". The code depends on:
    </p>
    <ul>
      <li>the CAAENOPosApplicationBinderImplWrapper class to manage a session with ENOVIA LCA V5. See [<a href="#References">4</a>] for details,
      </li>
      <li>the CAAENOVWSQueryCppWrapper class for query. See [<a href="#References">5</a>],
      </li>
      <li>the CAAENOVWSProdStructWrapper class to handle product structure management. See this document.
      </li>
    </ul>
    <p>
      It demonstrates a sample usage scenario for the ENOVWSProdStructCpp CAA Web service:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <!-- Not using <pre></pre> because it doesn't print right -->
          <td>
            <code><font color="#0000FF">public class</font> CAAENOVWSProdStructCppUseCase {<br>
            &nbsp; <font color="#0000FF">private string</font> uri = null;<br>
            &nbsp; <font color="#0000FF">private string</font> credUser = null;<br>
            &nbsp; <font color="#0000FF">private string</font> credPwd = null;<br>
            <br>
            &nbsp; <font color="#0000FF">public</font> CAAENOVWSProdStructCppUseCase(<br>
            &nbsp; &nbsp; <font color="#0000FF">string</font> uri,<br>
            &nbsp; &nbsp; <font color="#0000FF">string</font> credUser,<br>
            &nbsp; &nbsp; <font color="#0000FF">string</font> credPwd) {<br>
            &nbsp; &nbsp; <font color="#0000FF">this</font>.uri = uri;<br>
            &nbsp; &nbsp; <font color="#0000FF">this</font>.credUser = credUser;<br>
            &nbsp; &nbsp; <font color="#0000FF">this</font>.credPwd = credPwd;<br>
            &nbsp; }<br>
            <br>
            &nbsp; <font color="#0000FF">public void</font> RunSampleUsageScenario(<font color="#0000FF">string</font>
            enoviaUser) {<br>
            &nbsp; &nbsp; enoposapplicationbinderimpl.CAAENOPosApplicationBinderImplWrapper binderWrapper =
            <font color="#0000FF">null</font>;<br>
            &nbsp; &nbsp; enoposapplicationbinderimpl.SessionToken sessionToken = <font color=
            "#0000FF">null</font>;<br>
            &nbsp; &nbsp; <font color="#0000FF">try</font> {<br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">//
            ------------------------------------------------------------<br>
            &nbsp; &nbsp; &nbsp; // Step 1 - Instantiate and configure the proxies<br>
            &nbsp; &nbsp; &nbsp; // ------------------------------------------------------------</font><br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">// Create a CookieContainer object to maintain the HTTP
            session<br>
            &nbsp; &nbsp; &nbsp; // state accross proxies</font><br>
            &nbsp; &nbsp; &nbsp; CookieContainer container = <font color="#0000FF">new</font> CookieContainer();<br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">// Instantiate wrapper client classes</font><br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">int</font> timeOut = 360000;<br>
            &nbsp; &nbsp; &nbsp; <strong>binderWrapper =<br>
            &nbsp; &nbsp; &nbsp; &nbsp; <font color="#0000FF">new</font>
            enoposapplicationbinderimpl.CAAENOPosApplicationBinderImplWrapper(<br>
            &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; container, uri, credUser, credPwd, timeOut);<br>
            &nbsp; &nbsp; &nbsp; enovwsquerycpp.CAAENOVWSQueryCppWrapper queryWrapper =<br>
            &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; <font color="#0000FF">new</font>
            enovwsquerycpp.CAAENOVWSQueryCppWrapper(<br>
            &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; container, uri, credUser, credPwd, timeOut);<br>
            &nbsp; &nbsp; &nbsp; enovwsprodstructcpp.CAAENOVWSProdStructCppWrapper prodStructWrapper =<br>
            &nbsp; &nbsp; &nbsp; &nbsp; <font color="#0000FF">new</font>
            enovwsprodstructcpp.CAAENOVWSProdStructCppWrapper(<br>
            &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; container, uri, credUser, credPwd, timeOut);</strong><br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">//
            ------------------------------------------------------------<br>
            &nbsp; &nbsp; &nbsp; // Step 2 - Open session with ENOVIA LCA V5<br>
            &nbsp; &nbsp; &nbsp; // ------------------------------------------------------------</font><br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">// Get user contexts</font><br>
            &nbsp; &nbsp; &nbsp; <strong><font color="#0000FF">string</font>[] userContexts =
            binderWrapper.GetUserContexts(enoviaUser);</strong><br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">// Log in using the first available context</font><br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">if</font> (userContexts.Length == 0) {<br>
            &nbsp; &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("No context found
            for the user specified");<br>
            &nbsp; &nbsp; &nbsp; }<br>
            &nbsp; &nbsp; &nbsp; <strong>sessionToken = binderWrapper.Login(userContexts[0]);</strong><br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">//
            ------------------------------------------------------------<br>
            &nbsp; &nbsp; &nbsp; // Step 3 - Look up for product<br>
            &nbsp; &nbsp; &nbsp; //<br>
            &nbsp; &nbsp; &nbsp; // -- IProdStructWS_CAA_PRC1<br>
            &nbsp; &nbsp; &nbsp; // ------------------------------------------------------------</font><br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">string</font> productId = "IProdStructWS_CAA_PRC1";<br>
            &nbsp; &nbsp; &nbsp; StringBuilder xmlFilter = <font color="#0000FF">new</font> StringBuilder();<br>
            &nbsp; &nbsp; &nbsp; xmlFilter.Append("&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;");<br>
            &nbsp; &nbsp; &nbsp; xmlFilter.Append("&lt;FILTER CASESENSITIVE=\"TRUE\"&gt;");<br>
            &nbsp; &nbsp; &nbsp; xmlFilter.Append("&lt;SELECT&gt;");<br>
            &nbsp; &nbsp; &nbsp; xmlFilter.Append("&lt;OBJECT DOMAIN=\"PRODUCT\" NAME=\"ENOVIA_VPMProductRootClass\"
            &gt;");<br>
            &nbsp; &nbsp; &nbsp; xmlFilter.Append("&lt;ATTRIBUTE NAME=\"ENOVIA_VPMProductRootClass.V_ID\" /&gt;");<br>
            &nbsp; &nbsp; &nbsp; xmlFilter.Append("&lt;/OBJECT&gt;");<br>
            &nbsp; &nbsp; &nbsp; xmlFilter.Append("&lt;/SELECT&gt;");<br>
            &nbsp; &nbsp; &nbsp; xmlFilter.Append("&lt;WHERE&gt;");<br>
            &nbsp; &nbsp; &nbsp; xmlFilter.Append("&lt;FILTER_CONDITION OPERATOR=\"AND\"&gt;");<br>
            &nbsp; &nbsp; &nbsp; xmlFilter.Append("&lt;ATTRIBUTE_FILTER&gt;");<br>
            &nbsp; &nbsp; &nbsp; xmlFilter.Append("&lt;EXPRESSION OP=\"LIKE\" VALUE=\"" + productId + "\"&gt;");<br>
            &nbsp; &nbsp; &nbsp; xmlFilter.Append("&lt;ATTRIBUTE NAME=\"ENOVIA_VPMProductRootClass.V_ID\" /&gt;");<br>
            &nbsp; &nbsp; &nbsp; xmlFilter.Append("&lt;/EXPRESSION&gt;");<br>
            &nbsp; &nbsp; &nbsp; xmlFilter.Append(" &lt;/ATTRIBUTE_FILTER&gt;");<br>
            &nbsp; &nbsp; &nbsp; xmlFilter.Append("&lt;/FILTER_CONDITION&gt;");<br>
            &nbsp; &nbsp; &nbsp; xmlFilter.Append("&lt;/WHERE&gt;");<br>
            &nbsp; &nbsp; &nbsp; xmlFilter.Append("&lt;/FILTER&gt;");<br>
            <br>
            &nbsp; &nbsp; &nbsp; <strong>enovwsquerycpp.ENOVIA queryResultSet =<br>
            &nbsp; &nbsp; &nbsp; &nbsp; queryWrapper.QueryObjects(xmlFilter.ToString());</strong><br>
            <br>
            &nbsp; &nbsp; &nbsp; <strong><font color="#0000FF">string</font>[] productUUIDs =<br>
            &nbsp; &nbsp; &nbsp; &nbsp; queryWrapper.GetENOVIA_VPMProductRootClassUUIDs(queryResultSet);</strong><br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">if</font> (productUUIDs.Length == 0) {<br>
            &nbsp; &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Failed to find
            product");<br>
            &nbsp; &nbsp; &nbsp; } <font color="#0000FF">else if</font> (productUUIDs.Length &gt; 1) {<br>
            &nbsp; &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Invalid state:
            more than one product matched the input criteria");<br>
            &nbsp; &nbsp; &nbsp; }<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">string</font> productUUID = productUUIDs[0];<br>
            <br>
            &nbsp; &nbsp; &nbsp; CAAENOVWSUtils.DisplayResults(queryResultSet, 1);<br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">//
            ------------------------------------------------------------<br>
            &nbsp; &nbsp; &nbsp; // Step 4 - Creating the following data<br>
            &nbsp; &nbsp; &nbsp; //<br>
            &nbsp; &nbsp; &nbsp; // --+ IProdStructWS_CAA_PRC1<br>
            &nbsp; &nbsp; &nbsp; // &nbsp; !<br>
            &nbsp; &nbsp; &nbsp; // &nbsp; +--+ IProdSrtuctWS_CAA_PartRef1.1 | IProdStructWS_CAA_PartRef1<br>
            &nbsp; &nbsp; &nbsp; // &nbsp; &nbsp;&nbsp; !<br>
            &nbsp; &nbsp; &nbsp; // &nbsp; &nbsp;&nbsp; +-- IProdStructWS_CAA_PartRef2.1 | IProdStructWS_CAA_PartRef2<br>
            &nbsp; &nbsp; &nbsp; // ------------------------------------------------------------<br></font><br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">string</font> envDomain = "PRODUCT";<br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">// It is recommended that you always have user session setting
            for create configured parts to FALSE,<br>
            &nbsp; &nbsp; &nbsp; // and pass in true here when you need to create configured<br>
            &nbsp; &nbsp; &nbsp; // We pass in false here in order to ensure that we can delete the object stucture
            when finished</font><br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">string</font> configurable = "FALSE";<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">string</font> partNumber1 = "IProdStructWS_CAA_PartRef1";<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">string</font> partNumber2 = "IProdStructWS_CAA_PartRef2";<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">string</font>[] partNumbers = { partNumber1, partNumber2 };<br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">// Create the two part references</font><br>
            &nbsp; &nbsp; &nbsp; <strong>enovwsprodstructcpp.ENOVIA createPartRefResultSet =<br>
            &nbsp; &nbsp; &nbsp; &nbsp; prodStructWrapper.CreatePartRef(<br>
            &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; partNumbers, envDomain, configurable);</strong><br>
            <br>
            &nbsp; &nbsp; &nbsp; <strong><font color="#0000FF">string</font>[] partRefUUIDs =<br>
            &nbsp; &nbsp; &nbsp; &nbsp; prodStructWrapper.GetENOVIA_VPMPartVersionUUIDs(<br>
            &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; createPartRefResultSet);</strong><br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">if</font> (partRefUUIDs.Length &gt; 2) {<br>
            &nbsp; &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Invalid state:
            more than 2 part references were returned");<br>
            &nbsp; &nbsp; &nbsp; } <font color="#0000FF">else if</font> (partRefUUIDs.Length != 2) {<br>
            &nbsp; &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Failed to create
            the 2 part references");<br>
            &nbsp; &nbsp; &nbsp; }<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">string</font> partRefUUID1 = partRefUUIDs[0];<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">string</font> partRefUUID2 = partRefUUIDs[1];<br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">// Create first part instance</font><br>
            &nbsp; &nbsp; &nbsp; <strong>enovwsprodstructcpp.ENOVIA createPartInstResultSet1 =<br>
            &nbsp; &nbsp; &nbsp; &nbsp; prodStructWrapper.CreatePartInst(<br>
            &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; productUUID, <font color="#0000FF">new string</font>[] { partRefUUID1
            });</strong><br>
            <br>
            &nbsp; &nbsp; &nbsp; <strong><font color="#0000FF">string</font>[] vpmBOPartInstanceUUIDArray1 =<br>
            &nbsp; &nbsp; &nbsp; &nbsp; prodStructWrapper.GetVPMBOPartInstanceUUIDs(<br>
            &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; createPartInstResultSet1);</strong><br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">if</font> (vpmBOPartInstanceUUIDArray1.Length != 1) {<br>
            &nbsp; &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Failed to create
            part instance");<br>
            &nbsp; &nbsp; &nbsp; } <font color="#0000FF">else if</font> (vpmBOPartInstanceUUIDArray1.Length &gt; 1)
            {<br>
            &nbsp; &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Invalid state:
            more than one part instance was returned");<br>
            &nbsp; &nbsp; &nbsp; }<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">string</font> partInstUUID1 =
            vpmBOPartInstanceUUIDArray1[0];<br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">// Create second part instance</font><br>
            &nbsp; &nbsp; &nbsp; <strong>enovwsprodstructcpp.ENOVIA createPartInstResultSet2 =<br>
            &nbsp; &nbsp; &nbsp; &nbsp; prodStructWrapper.CreatePartInst(<br>
            &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; partInstUUID1, <font color="#0000FF">new string</font>[] { partRefUUID2
            });</strong><br>
            <br>
            &nbsp; &nbsp; &nbsp; <strong><font color="#0000FF">string</font>[] vpmBOPartInstanceUUIDArray2 =<br>
            &nbsp; &nbsp; &nbsp; &nbsp; prodStructWrapper.GetVPMBOPartInstanceUUIDs(<br>
            &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; createPartInstResultSet2);</strong><br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">if</font> (vpmBOPartInstanceUUIDArray2.Length != 1) {<br>
            &nbsp; &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Failed to create
            part instance");<br>
            &nbsp; &nbsp; &nbsp; } <font color="#0000FF">else if</font> (vpmBOPartInstanceUUIDArray2.Length &gt; 1)
            {<br>
            &nbsp; &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Invalid state:
            more than one part instance was returned");<br>
            &nbsp; &nbsp; &nbsp; }<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">string</font> partInstUUID2 =
            vpmBOPartInstanceUUIDArray2[0];<br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">//
            ------------------------------------------------------------<br>
            &nbsp; &nbsp; &nbsp; // Step 6 - Expand product structure and display content<br>
            &nbsp; &nbsp; &nbsp; // ------------------------------------------------------------</font><br>
            <br>
            &nbsp; &nbsp; &nbsp; <strong>enovwsprodstructcpp.ENOVIA expandResultSet =<br>
            &nbsp; &nbsp; &nbsp; &nbsp; prodStructWrapper.ExpandProductStructure(productUUID, 2, <font color=
            "#0000FF">null</font>);</strong><br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">if</font> (expandResultSet.ENOVIA_VPMProductRootClass ==
            <font color="#0000FF">null</font> || expandResultSet.ENOVIA_VPMProductRootClass.Length != 1) {<br>
            &nbsp; &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Failed to find
            product root class");<br>
            &nbsp; &nbsp; &nbsp; } <font color="#0000FF">else if</font> (expandResultSet.VPMBOPartInstance ==
            <font color="#0000FF">null</font> || expandResultSet.VPMBOPartInstance.Length != 2) {<br>
            &nbsp; &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Failed to find
            item instances");<br>
            &nbsp; &nbsp; &nbsp; }<br>
            <br>
            &nbsp; &nbsp; &nbsp; CAAENOVWSUtils.DisplayResults(expandResultSet, 2);<br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">//
            ------------------------------------------------------------<br>
            &nbsp; &nbsp; &nbsp; // Step 6 - Deleting created data<br>
            &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //
            ------------------------------------------------------------</font><br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">// Delete second part instance</font><br>
            &nbsp; &nbsp; &nbsp; <strong>prodStructWrapper.DeletePartInst(<br>
            &nbsp; &nbsp; &nbsp; &nbsp; partInstUUID1, <font color="#0000FF">new string</font>[] { partInstUUID2
            });</strong><br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">// Delete first instance</font><br>
            &nbsp; &nbsp; &nbsp; <strong>prodStructWrapper.DeletePartInst(<br>
            &nbsp; &nbsp; &nbsp; &nbsp; productUUID, <font color="#0000FF">new string</font>[] { partInstUUID1
            });</strong><br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">// Delete part references</font><br>
            &nbsp; &nbsp; &nbsp; <strong>prodStructWrapper.DeletePartRef(partRefUUIDs);</strong><br>
            &nbsp; &nbsp; } <font color="#0000FF">catch</font> (Exception e) {<br>
            &nbsp; &nbsp; &nbsp; ...<br>
            &nbsp; &nbsp; } <font color="#0000FF">finally</font> {<br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">//
            ------------------------------------------------------------<br>
            &nbsp; &nbsp; &nbsp; // Step 7 - Terminate opened session<br>
            &nbsp; &nbsp; &nbsp; // ------------------------------------------------------------</font><br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">// The session must be closed even if a call to a method on the
            ENOVWSQueryCpp<br>
            &nbsp; &nbsp; &nbsp; // CAA Web service fails</font><br>
            &nbsp; &nbsp; &nbsp; <strong>binderWrapper.Logout(sessionToken);</strong><br>
            &nbsp; &nbsp; }<br>
            &nbsp; }<br>
            }</code>
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      The <code>CAAENOVWSUtils.DisplayResults</code> method can be found at:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <td>
            <code><em>&lt;Source&gt;</em>\CAAENOVWSUtils.cs</code>
          </td>
        </tr>
      </tbody>
    </table>
    <ul>
      <li>
        <code><em>&lt;Source&gt;</em></code>:
        <code><em>&lt;Install&gt;</em>\CAAENOVWS.edu\CAAENOVWSDotNet1_1ClientBase.m\src</code>,
      </li>
      <li>
        <code><em>&lt;Install&gt;</em></code>: the root directory where the CAA CD-ROM is installed.
      </li>
    </ul>
    <p align="right">
      [<a href="#Top">Top</a>]
    </p><!-- IN SHORT =================================================================================== IN SHORT -->
    <hr>
    <h3>
      <a name="InShort" id="InShort"></a>In Short
    </h3>
    <p>
      This use case explains how to use the C# client binding generated using the wsdl.exe utility in order to consume
      the ENOVWSProdStructCpp CAA Web service. It also gives an overview of the available methods:
    </p>
    <ul>
      <li>
        <a href="#CreatePart"><code>CreatePart</code></a>: create part references,
      </li>
      <li>
        <a href="#AddChildPart"><code>AddChildPart</code></a>: create part instances,
      </li>
      <li>
        <a href="#ExpandProductStructure"><code>ExpandProductStructure</code></a>: expand product structures,
      </li>
      <li>
        <a href="#DeleteChildPart"><code>DeleteChildPart</code></a>: delete part instances,
      </li>
      <li>
        <a href="#DeletePart"><code>DeletePart</code></a>: delete part references.
      </li>
    </ul>
    <p align="right">
      [<a href="#Top">Top</a>]
    </p><!-- REFERENCES =============================================================================== REFERENCES -->
    <hr>
    <h3>
      <a name="References" id="References"></a>References
    </h3>
    <table border="0" width="100%">
      <tbody>
        <tr>
          <td valign="top">
            [1]
          </td>
          <td valign="top" align="left">
            <a href="#">Building and Launching a CAA Web Service Use Case</a>
          </td>
        </tr>
        <tr>
          <td valign="top">
            [2]
          </td>
          <td>
            <a href="#">Generating a C# Client Binding</a>
          </td>
        </tr>
        <tr>
          <td valign="top">
            [3]
          </td>
          <td>
            <a href="../CAAENOVWSTechArticles/SelectExpression.htm">Using SelectExpression</a>
          </td>
        </tr>
        <tr>
          <td valign="top">
            [4]
          </td>
          <td>
            <a href="../CAAPLMSecUseCases/CAAENOPosAppBinderDotNetClient.htm">Consuming the
            ENOPosApplicationBinderImpl CAA Web Service</a>
          </td>
        </tr>
        <tr>
          <td valign="top">
            [5]
          </td>
          <td>
            <a href="CAAENOVWSQueryCppDotNetClient.htm">Consuming the ENOVWSQueryCpp CAA Web Service</a>
          </td>
        </tr>
        <tr>
          <td valign="top" align="right" colspan="2">
            [<a href="#Top">Top</a>]
          </td>
        </tr>
      </tbody>
    </table>
    <!-- FOOTER ===================================================================================== FOOTER -->
    <hr>
    <h3>
      <a name="History" id="History"></a>History
    </h3>
    <table border="0" width="100%">
      <tbody>
        <tr>
          <td valign="top">
            Version: <strong>1</strong> [Jan 2006]
          </td>
          <td valign="top">
            Document created
          </td>
        </tr>
        <tr>
          <td valign="top" align="right" colspan="2">
            [<a href="#Top">Top</a>]
          </td>
        </tr>
      </tbody>
    </table>
    <hr>
    <p>
      <em>Copyright  2006, Dassault Systmes. All rights reserved.</em>
    </p>
  </body>
</html>
