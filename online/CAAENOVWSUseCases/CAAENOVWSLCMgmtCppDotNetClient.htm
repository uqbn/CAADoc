<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <link rel="Stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css">
    <title>
      Consuming the ENOVWSLCMgmtCpp CAA Web Service
    </title>
  </head>
  <body>
    <table width="100%">
      <tbody>
        <tr>
          <td valign="top">
            <h1>
              CAA Web Services Home
            </h1>
          </td>
          <td valign="top">
            <h2>
              &nbsp;
            </h2>
          </td>
          <td rowspan="2" align="right" valign="top">
            <h3>
              <a name="Top" id="Top"></a>Consuming the ENOVWSLCMgmtCpp CAA Web Service
            </h3><em>Using the ENOVWSLCMgmtCpp CAA Web service for lifecycle management</em>
          </td>
        </tr>
        <tr>
          <td class="use" colspan="2">
            Use Case
          </td>
        </tr>
      </tbody>
    </table>
    <hr>
    <!-- HEADER ======================================================================================= HEADER -->
    <table class="abstract">
      <tbody>
        <tr>
          <td>
            <h3>
              Abstract
            </h3>
            <p>
              This article discusses the <strong>CAAENOVWSDotNet1_1Client</strong> use case. It describes how to use
              the C# client binding that can be generated using the wsdl.exe utility in order to consume the
              <strong>ENOVWSLCMgmtCpp CAA Web service</strong>. It provides a sample usage scenario that demonstrates
              how to handle lifecycle management.
            </p>
            <ul>
              <li>
                <a href="#1"><strong>What You Will Learn With This Use Case</strong></a>
              </li>
              <li>
                <a href="#2"><strong>The CAAENOVWSDotNet1_1Client Use Case</strong></a>
                <ul>
                  <li>
                    <a href="#2.1">What Does CAAENOVWSDotNet1_1Client Do</a>
                  </li>
                  <li>
                    <a href="#2.2">Where To Find the CAAENOVWSDotNet1_1Client Code</a>
                  </li>
                  <li>
                    <a href="#2.3">How to Launch CAAENOVWSDotNet1_1Client</a>
                  </li>
                </ul>
              </li>
              <li>
                <a href="#3"><strong>Step-by-step</strong></a>
              </li>
              <li>
                <a href="#InShort"><strong>In Short</strong></a>
              </li>
              <li>
                <a href="#References"><strong>References</strong></a>
              </li>
            </ul>
          </td>
        </tr>
      </tbody>
    </table>
    <hr>
    <!-- SECTION 1 ================================================================================= SECTION 1 -->
    <h3>
      <a name="1"></a>What You Will Learn With This Use Case
    </h3>
    <p>
      This use case demonstrates how to write a client application that consumes the ENOVWSProdStructCpp CAA Web
      service. It helps you to:
    </p>
    <ul>
      <li>Generate the C# client binding for the ENOVWSLCMgmtCpp CAA Web service,
      </li>
      <li>Configure and use the generated proxy,
      </li>
      <li>Understand a sample usage scenario of the ENOVWSLCMgmtCpp CAA Web service.
      </li>
    </ul>
    <p align="right">
      [<a href="#Top">Top</a>]
    </p><!-- SECTION 2 ================================================================================= SECTION 2 -->
    <h3>
      <a name="2"></a>The CAAENOVWSDotNet1_1Client Use Case
    </h3>
    <p>
      CAAENOVWSDotNet1_1Client is a use case of the CAAENOVWS.edu framework that illustrates the ENOVWSLCMgmtCpp CAA
      Web service capabilities.
    </p>
    <p align="right">
      [<a href="#Top">Top</a>]
    </p><!-- SECTION 2.1 ============================================================================= SECTION 2.1 -->
    <h4>
      <a name="2.1"></a>What Does CAAENOVWSDotNet1_1Client Do
    </h4>
    <p>
      The sample usage scenario delivered with this use case contains the following steps:
    </p>
    <ul>
      <li>Create a part reference, return its UUID,
      </li>
      <li>Get the list of lifecycle transitions for the created part,
      </li>
      <li>Apply the 'Promote' transition,
      </li>
      <li>Get the list of lifecycle transitions for the promoted part,
      </li>
      <li>Apply the 'Demote' transition,
      </li>
      <li>Delete the created part.
      </li>
    </ul>
    <p>
      The ENOVWSLCMgmtCpp CAA Web service is used in support of the primary objective of this use case, which is to get
      and apply transitions using the ENOVWSLCMgmtCpp CAA Web service.
    </p>
    <p align="right">
      [<a href="#Top">Top</a>]
    </p><!-- SECTION 2.2 ============================================================================= SECTION 2.2 -->
    <h4>
      <a name="2.2"></a>Where To Find the CAAENOVWSDotNet1_1Client Code
    </h4>
    <p>
      The CAAENOVWSDotNet1_1Client use case is made of several classes located in both
      <strong>CAAENOVWSDotNet1_1Client.m</strong> and <strong>CAAENOVWSDotNet1_1ClientBase.m</strong> modules of the
      <strong>CAAENOVWS.edu</strong> framework:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <td>
            <code><em>&lt;Install&gt;</em>\CAAENOVWS.edu\CAAENOVWSDotNet1_1Client.m\src</code><br>
            <code><em>&lt;Install&gt;</em>\CAAENOVWS.edu\CAAENOVWSDotNet1_1ClientBase.m\src</code>
          </td>
        </tr>
      </tbody>
    </table>
    <ul>
      <li>
        <code><em>&lt;Install&gt;</em></code>: the root directory where the CAA CD-ROM is installed.
      </li>
    </ul>
    <p>
      The CAAENOVWSDotNet1_1ClientBase.m module (library) contains the following resources:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <td>
            <code><em>&lt;Source&gt;</em>\CAAENOVWSLCMgmtCppProxy.cs<br>
            <em>&lt;Source&gt;</em>\CAAENOVWSLCMgmtCppWrapper.cs<br>
                    <i>&lt;Source&gt;</i>\CAAENOVWSUtils.cs</code></td>
        </tr>
      </tbody>
    </table>
    <ul>
      <li>
        <code><em>&lt;Source&gt;</em></code>:
        <code><em>&lt;Install&gt;</em>\CAAENOVWS.edu\CAAENOVWSDotNet1_1ClientBase.m\src</code>.
      </li>
    </ul>
    <p>
      The <strong>CAAENOVWSLCMgmtCppProxy.cs</strong> file contains the C# client binding generated using the wsdl.exe
      utility. A C# client binding consists of a proxy and several types definitions. The
      <strong>CAAENOVWSLCMgmtCppWrapper.cs</strong> file contains a class that describes how to configure the generated
      proxy and how to invoke its methods.
    </p>
    <p>
      The CAAENOVWSDotNet1_1Client.m module (executable) contains the following resources:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <td>
            <code><em>&lt;Source&gt;</em>\CAAENOVWSDotNet1_1Client.cs<br>
            <em>&lt;Source&gt;</em>\CAAENOVWSLCMgmtCppUseCase.cs</code>
          </td>
        </tr>
      </tbody>
    </table>
    <ul>
      <li>
        <code><em>&lt;Source&gt;</em></code>:
        <code><em>&lt;Install&gt;</em>\CAAENOVWS.edu\CAAENOVWSDotNet1_1Client.m\src</code>.
      </li>
    </ul>
    <p>
      The <strong>CAAENOVWSDotNet1_1Client.cs</strong> file contains the main program. It parses the command line
      inputs and starts up the use case. The <strong>CAAENOVWSLCMgmtCppUseCase.cs</strong> file contains the sample use
      case scenario.
    </p>
    <p align="right">
      [<a href="#Top">Top</a>]
    </p><!-- SECTION 2.3 ============================================================================= SECTION 2.3 -->
    <h4>
      <a name="2.3"></a>How to Launch CAAENOVWSDotNet1_1Client
    </h4>
    <p>
      To run the CAAENOVWSDotNet1_1Client use case, you will need to build both CAAENOVWSDotNet1_1ClientBase.m and
      CAAENOVWSDotNet1_1Client.m modules. The use case code can be built using either the CAA V5 buildtime environment,
      or Visual Studio .NET 2003 as explained in [<a href="#References">1</a>].
    </p>
    <p>
      You can then execute the command described below:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <td>
            <code>CAAENOVWSDotNet1_1Client -w <em>&lt;URI&gt;</em> -e <em>&lt;ENOVIA username&gt;</em> -u <em>&lt;Basic
            Authentication username&gt;</em> -p <em>&lt;Basic Authentication password&gt;</em> -t
            ENOVWSLCMgmtCpp</code>
          </td>
        </tr>
      </tbody>
    </table>
    <ul>
      <li>
        <code><em>&lt;URI&gt;</em></code>: is the root URI of the Web application where the ENOVWSLCMgmtCpp CAA Web
        service is deployed,
      </li>
      <li>
        <code><em>&lt;ENOVIA username&gt;</em></code>: is a valid username declared in the ENOVIA P&amp;O database,
      </li>
      <li>
        <code><em>&lt;Basic Authentication Username&gt;</em> and <em>&lt;Basic Authentication Password&gt;</em></code>:
        are a valid set of credentials for authentication on the remote Web server.
      </li>
    </ul>
    <p>
      Here follows a sample command, to be updated with your own environment configuration:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <td>
            <code>CAAENOVWSDotNet1_1Client -w http://stophe1dsy.dsy.ds:9080/B17 -e cjk -u wpsadmin -p wpsadmin -t
            ENOVWSLCMgmtCpp</code>
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      The same executable is used to launch all of the available ENOVIA CAA Web services use cases. The <code>-t</code>
      option is used to choose the target use case to run.
    </p>
    <p>
      When building the modules with the CAA V5 buildtime environment, the CAAENOVWSDotNet1_1Client executable can be
      launched from the following location:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <td>
            <code><em>&lt;Install&gt;</em>\CAAENOVWS.edu\intel_a\code\clr</code>
          </td>
        </tr>
      </tbody>
    </table>
    <ul>
      <li>
        <code><em>&lt;Install&gt;</em></code>: the root directory where the CAA CD-ROM is installed.
      </li>
    </ul>
    <p align="right">
      [<a href="#Top">Top</a>]
    </p><!-- SECTION 3 ================================================================================= SECTION 3 -->
    <h3>
      <a name="3"></a>Step-by-step
    </h3>
    <p>
      The following section first explains how to generate the C# client binding for the ENOVWSLCMgmtCpp CAA Web
      service demonstrated. The remaining sections describe how to configure the generated proxy and how to consume the
      Web service:
    </p>
    <ol>
      <li>
        <a href="#3.1">Creating the C# Client Binding</a>
      </li>
      <li>
        <a href="#3.2">Instantiating and Configuring the Generated Proxy</a>
      </li>
      <li>
        <a href="#3.3">Getting Transitions</a>
      </li>
      <li>
        <a href="#3.4">Applying Transitions</a>
      </li>
      <li>
        <a href="#3.5">Sample Usage Scenario</a>
      </li>
    </ol>
    <p align="right">
      [<a href="#Top">Top</a>]
    </p><!-- SECTION 3.1 ============================================================================= SECTION 3.1 -->
    <h4>
      <a name="3.1"></a>Creating the C# Client Binding
    </h4>
    <p>
      Please refer to [<a href="#References">2</a>] for details on how to generate the C# client binding using the
      wsdl.exe utility.
    </p>
    <p>
      Here follows a sample command in order to generate the C# client binding for the ENOVWSLCMgmtCpp CAA Web service:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <td>
            <code>wsdl /namespace:com.dassault_systemes.caaenovws.caaenovwsdotnet1_1clientgen.enovwslcmgmtcpp
            /username:wpsadmin /password:wpsadmin /out:CAAENOVWSLCMgmtCppProxy.cs
            http://stophe1dsy.dsy.ds:9080/B17/wsdl?service=urn:com:dassault_systemes:ENOVWSLCMgmtImpl:ENOVWSLCMgmtImpl:ENOVWSLCMgmtCpp</code>
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      The server name, port, and context root URI information must be updated to match the server where the
      ENOVWSLCMgmtCpp CAA Web service has been deployed. The <code>/username</code> and <code>/username</code> options
      are required to authenticate on the Web server hosting the Web service.
    </p>
    <p align="right">
      [<a href="#Top">Top</a>]
    </p><!-- SECTION 3.2 ============================================================================= SECTION 3.2 -->
    <h4>
      <a name="3.2"></a>Instantiating and Configuring the Generated Proxy
    </h4>
    <p>
      In order to consume an implementation of the ENOVWSLCMgmtCpp CAA Web service deployed on a target Web server, you
      first need to instantiate the proxy generated using the wsdl.exe utility. This proxy must then be configured in
      order to manage authentication on the remote Web server, timeout, and session management. Maintaining the HTTP
      session state is mandatory when consuming ENOVIA LCA V5 CAA Web services.
    </p>
    <p>
      The generated proxy class is used in order to marshall method calls and objects to SOAP requests, and to
      unmarshall SOAP responses to objects. The following code describes how to instantiate and configure it:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <!-- Not using <pre></pre> because otherwise it doesn't print right -->
          <td>
            <code><font color="#0000FF">public class</font> CAAENOVWSLCMgmtCppWrapper {<br>
            &nbsp; <font color="#0000FF">private const string</font> SERVICE_ID =
            "urn:com:dassault_systemes:ENOVWSLCMgmtImpl:ENOVWSLCMgmtImpl:ENOVWSLCMgmtCpp";<br>
            &nbsp; <font color="#0000FF">private</font> CAAENOVWSLCMgmtCppProxy proxy = <font color=
            "#0000FF">null</font>;<br>
            <br>
            &nbsp; <font color="#0000FF">public</font> CAAENOVWSLCMgmtCppWrapper(<br>
            &nbsp; &nbsp; CookieContainer container,<br>
            &nbsp; &nbsp; <font color="#0000FF">string</font> uri,<br>
            &nbsp; &nbsp; <font color="#0000FF">string</font> credUser,<br>
            &nbsp; &nbsp; <font color="#0000FF">string</font> credPwd,<br>
            &nbsp; &nbsp; <font color="#0000FF">int</font> timeOut) {<br>
            &nbsp; &nbsp; proxy = <font color="#0000FF">new</font> CAAENOVWSLCMgmtCppProxy();<br>
            <br>
            &nbsp; &nbsp; <font color="#008000">// Compute the SOAP endpoint URI value that bounds to the deployed<br>
            &nbsp; &nbsp; // implementation of the ENOVWSLCMgmtCpp CAA Web service</font><br>
            &nbsp; &nbsp; proxy.Url = uri + "servicerouter?service=" + SERVICE_ID;<br>
            <br>
            &nbsp; &nbsp; <font color="#008000">// Required for HTTP session state management</font><br>
            &nbsp; &nbsp; proxy.CookieContainer = container; <strong>(1)</strong><br>
            <br>
            &nbsp; &nbsp; <font color="#008000">// Required for the Basic Authentication mechanism</font><br>
            &nbsp; &nbsp; ICredentials credentials = <font color="#0000FF">new</font> NetworkCredential(credUser,
            credPwd);<br>
            &nbsp; &nbsp; proxy.Credentials = credentials; <strong>(2)</strong><br>
            <br>
            &nbsp; &nbsp; <font color="#008000">// Increase the default client time-out</font><br>
            &nbsp; &nbsp; proxy.Timeout = timeOut; <strong>(3)</strong><br>
            &nbsp; }<br>
            }</code>
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <strong>(1)</strong>: in order to maintain the HTTP session state between successive calls performed using either
      the same or multiple proxy instances, the <code>CookieContainer</code> property must be set on the proxy. This is
      mandatory in the context of ENOVIA LCA V5 CAA Web services,<br>
      <strong>(2)</strong>: when security is enabled on the remote Web server, it is mandatory to set the
      <code>Credentials</code> property on the proxy. The values specified must match a valid set of credentials for
      the Basic Authentication mechanism,<br>
      <strong>(3)</strong>: the default timeout value can be increased in order to avoid potential issues at runtime,
      such as losing the HTTP connection before receiving the SOAP responses. The value specified in the code is in
      milliseconds.
    </p>
    <p align="right">
      [<a href="#Top">Top</a>]
    </p><!-- SECTION 3.3 ============================================================================= SECTION 3.3 -->
    <h4>
      <a name="3.3"></a>Getting Transitions
    </h4>
    <p>
      To get a list of lifecycle transition names, you can use the following method available through the generated
      proxy interface:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <td>
            <a name="GetTransitions" id="GetTransitions"></a><code><font color="#0000FF">public</font> Status
            GetTransitions(Identifier iObjectId, <font color="#0000FF">ref string</font>[] oTransitionNames)</code>
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      This method accepts the following parameters:
    </p>
    <table>
      <tbody>
        <tr>
          <td>
            <code>[in] iObjectId</code>
          </td>
          <td>
            &nbsp; The identifier of the target object
          </td>
        </tr>
        <tr>
          <td>
            <code>[in/out] oTransitionNames</code>
          </td>
          <td>
            &nbsp; The list of transition names which are available to apply
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      The following code demonstrates the use of the <code><a href="#GetTransitions">GetTransitions</a></code> method:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <!-- Not using <pre></pre> because it doesn't print right -->
          <td>
            <code><font color="#0000FF">public class</font> CAAENOVWSLCMgmtCppWrapper {<br>
            &nbsp; ...<br>
            &nbsp; <font color="#0000FF">private</font> Identifier ToIdentifier(<font color="#0000FF">string</font> id)
            {<br>
            &nbsp; &nbsp; <font color="#0000FF">if</font> (id == <font color="#0000FF">null</font>) {<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Illegal argument:
            identifier value is null");<br>
            &nbsp; &nbsp; }<br>
            <br>
            &nbsp; &nbsp; Identifier identifier = <font color="#0000FF">new</font> Identifier();<br>
            &nbsp; &nbsp; identifier.Identifier1 = CAAENOVWSUtils.ConvertFromHexToBinary(id);<br>
            &nbsp; &nbsp; <font color="#0000FF">return</font> identifier;<br>
            &nbsp; }<br>
            <br>
            &nbsp; <font color="#0000FF">public string</font>[] GetTransitions(<font color="#0000FF">string</font>
            objectUUID) {<br>
            &nbsp; &nbsp; <font color="#0000FF">if</font> (objectUUID == <font color="#0000FF">null</font>) {<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Illegal argument: object
            UUID is null");<br>
            &nbsp; &nbsp; }<br>
            <br>
            &nbsp; &nbsp; Identifier objectId = ToIdentifier(objectUUID);<br>
            &nbsp; &nbsp; <font color="#0000FF">string</font>[] transitionNames = <font color=
            "#0000FF">null</font>;<br>
            <br>
            &nbsp; &nbsp; <font color="#0000FF">try</font> {<br>
            &nbsp; &nbsp; &nbsp; <strong>Status status = proxy.GetTransitions(objectId, <font color=
            "#0000FF">ref</font> transitionNames);</strong><br>
            &nbsp; &nbsp; &nbsp; Console.Out.WriteLine("Status: {0}", status.Status1);<br>
            &nbsp; &nbsp; } <font color="#0000FF">catch</font> (Exception e) {<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Failed to get
            transitions", e);<br>
            &nbsp; &nbsp; }<br>
            <br>
            &nbsp; &nbsp; <font color="#0000FF">if</font> (transitionNames == <font color="#0000FF">null</font>) {<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Failed to get
            transitions");<br>
            &nbsp; &nbsp; }<br>
            &nbsp; &nbsp; <font color="#0000FF">return</font> transitionNames;<br>
            &nbsp; }<br>
            }</code>
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      The <code>CAAENOVWSUtils.ConvertFromHexToBinary</code> method can be found at:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <td>
            <code><em>&lt;Source&gt;</em>\CAAENOVWSUtils.cs</code>
          </td>
        </tr>
      </tbody>
    </table>
    <ul>
      <li>
        <code><em>&lt;Source&gt;</em></code>:
        <code><em>&lt;Install&gt;</em>\CAAENOVWS.edu\CAAENOVWSDotNet1_1ClientBase.m\src</code>,
      </li>
      <li>
        <code><em>&lt;Install&gt;</em></code>: the root directory where the CAA CD-ROM is installed.
      </li>
    </ul>
    <p align="right">
      [<a href="#Top">Top</a>]
    </p><!-- SECTION 3.4 ============================================================================= SECTION 3.4 -->
    <h4>
      <a name="3.4"></a>Applying Transitions
    </h4>
    <p>
      To apply a lifecycle transition, you can use the following method available through the generated proxy
      interface:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <td>
            <a name="ApplyTransition" id="ApplyTransition"></a><code><font color="#0000FF">public</font> Status
            ApplyTransition(Identifier iObjectId, <font color="#0000FF">string</font> iTransitionName)</code>
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      This method accepts the following parameters:
    </p>
    <table>
      <tbody>
        <tr>
          <td>
            <code>[in] iObjectId</code>
          </td>
          <td>
            &nbsp; The identifier of the target object
          </td>
        </tr>
        <tr>
          <td>
            <code>[in] iTransitionName</code>
          </td>
          <td>
            &nbsp; The name of the transition to apply
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      The following code demonstrates the use of the <code><a href="#ApplyTransition">ApplyTransition</a></code>
      method:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <!-- Not using <pre></pre> because it doesn't print right -->
          <td>
            <code><font color="#0000FF">public class</font> CAAENOVWSLCMgmtCppWrapper {<br>
            &nbsp; ...<br>
            &nbsp; <font color="#0000FF">public void</font> ApplyTransition(<font color="#0000FF">string</font>
            objectUUID, <font color="#0000FF">string</font> transitionName) {<br>
            &nbsp; &nbsp; <font color="#0000FF">if</font> (objectUUID == <font color="#0000FF">null</font>) {<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Illegal argument: object
            UUID is null");<br>
            &nbsp; &nbsp; } <font color="#0000FF">else if</font> (transitionName == <font color="#0000FF">null</font>)
            {<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Illegal argument:
            transition name is null");<br>
            &nbsp; &nbsp; }<br>
            <br>
            &nbsp; &nbsp; Identifier objectId = ToIdentifier(objectUUID);<br>
            <br>
            &nbsp; &nbsp; <font color="#0000FF">try</font> {<br>
            &nbsp; &nbsp; &nbsp; <strong>Status status = proxy.ApplyTransition(objectId, transitionName);</strong><br>
            &nbsp; &nbsp; &nbsp; Console.Out.WriteLine("Status: {0}", status.Status1);<br>
            &nbsp; &nbsp; } <font color="#0000FF">catch</font> (Exception e) {<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Failed to apply
            transitions", e);<br>
            &nbsp; &nbsp; }<br>
            &nbsp; }<br>
            }</code>
          </td>
        </tr>
      </tbody>
    </table>
    <p align="right">
      [<a href="#Top">Top</a>]
    </p><!-- SECTION 3.5 ============================================================================= SECTION 3.5 -->
    <h4>
      <a name="3.5"></a>Sample Usage Scenario
    </h4>
    <p>
      The following code depends on:
    </p>
    <ul>
      <li>the CAAENOPosApplicationBinderImplWrapper class to manage a session with ENOVIA LCA V5. See [<a href="#References">3</a>] for details,
      </li>
      <li>the CAAENOVWSProdStructCppWrapper class to create/delete a testing part. See [<a href="#References">4</a>],
      </li>
      <li>the CAAENOVWSLCMgmtCppWrapper class to handle lifecycle management. See this document.
      </li>
    </ul>
    <p>
      It demonstrates a sample usage scenario for the ENOVWSLCMgmtCpp CAA Web service:
    </p>
    <table class="code">
      <tbody>
        <tr>
          <!-- Not using <pre></pre> because it doesn't print right -->
          <td>
            <code><font color="#0000FF">public class</font> CAAENOVWSLCMgmtCppUseCase {<br>
            &nbsp; <font color="#0000FF">private string</font> uri = <font color="#0000FF">null</font>;<br>
            &nbsp; <font color="#0000FF">private string</font> credUser = <font color="#0000FF">null</font>;<br>
            &nbsp; <font color="#0000FF">private string</font> credPwd = <font color="#0000FF">null</font>;<br>
            <br>
            &nbsp; <font color="#0000FF">public</font> CAAENOVWSLCMgmtCppUseCase(<br>
            &nbsp; &nbsp; <font color="#0000FF">string</font> uri,<br>
            &nbsp; &nbsp; <font color="#0000FF">string</font> credUser,<br>
            &nbsp; &nbsp; <font color="#0000FF">string</font> credPwd) {<br>
            &nbsp; &nbsp; <font color="#0000FF">this</font>.uri = uri;<br>
            &nbsp; &nbsp; <font color="#0000FF">this</font>.credUser = credUser;<br>
            &nbsp; &nbsp; <font color="#0000FF">this</font>.credPwd = credPwd;<br>
            &nbsp; }<br>
            <br>
            &nbsp; <font color="#0000FF">public void</font> RunSampleUsageScenario(<font color="#0000FF">string</font>
            enoviaUser) {<br>
            &nbsp; &nbsp; enoposapplicationbinderimpl.CAAENOPosApplicationBinderImplWrapper binderWrapper =
            <font color="#0000FF">null</font>;<br>
            &nbsp; &nbsp; enoposapplicationbinderimpl.SessionToken sessionToken = <font color=
            "#0000FF">null</font>;<br>
            &nbsp; &nbsp; <font color="#0000FF">try</font> {<br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">//
            ------------------------------------------------------------<br>
            &nbsp; &nbsp; &nbsp; // Step 1 - Instantiate and configure the proxies<br>
            &nbsp; &nbsp; &nbsp; // ------------------------------------------------------------</font><br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">// Create a CookieContainer object to maintain the HTTP
            session&nbsp;<br>
            &nbsp; &nbsp; &nbsp; // state accross proxies</font><br>
            &nbsp; &nbsp; &nbsp; CookieContainer container = <font color="#0000FF">new</font> CookieContainer();<br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">// Instantiate wrapper client classes</font><br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">int</font> timeOut = 360000;<br>
            &nbsp; &nbsp; &nbsp; <strong>binderWrapper =<br>
            &nbsp; &nbsp; &nbsp; &nbsp; <font color="#0000FF">new</font>
            enoposapplicationbinderimpl.CAAENOPosApplicationBinderImplWrapper(<br>
            &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; container, uri, credUser, credPwd, timeOut);<br>
            &nbsp; &nbsp; &nbsp; enovwsprodstructcpp.CAAENOVWSProdStructCppWrapper prodStructWrapper =<br>
            &nbsp; &nbsp; &nbsp; &nbsp; <font color="#0000FF">new</font>
            enovwsprodstructcpp.CAAENOVWSProdStructCppWrapper(<br>
            &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; container, uri, credUser, credPwd, timeOut);<br>
            &nbsp; &nbsp; &nbsp; enovwslcmgmtcpp.CAAENOVWSLCMgmtCppWrapper lcMgmtWrapper =<br>
            &nbsp; &nbsp; &nbsp; &nbsp; <font color="#0000FF">new</font> enovwslcmgmtcpp.CAAENOVWSLCMgmtCppWrapper(<br>
            &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; container, uri, credUser, credPwd, timeOut);</strong><br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">//
            ------------------------------------------------------------<br>
            &nbsp; &nbsp; &nbsp; // Step 2 - Open session with ENOVIA LCA V5<br>
            &nbsp; &nbsp; &nbsp; // ------------------------------------------------------------</font><br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">// Get user contexts<br></font> &nbsp; &nbsp; &nbsp;
            <strong><font color="#0000FF">string</font>[] userContexts =
            binderWrapper.GetUserContexts(enoviaUser);</strong><br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">// Log in using the first available context</font><br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">if</font> (userContexts.Length == 0) {<br>
            &nbsp; &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("No context found
            for the user specified");<br>
            &nbsp; &nbsp; &nbsp; }<br>
            &nbsp; &nbsp; &nbsp; <strong>sessionToken = binderWrapper.Login(userContexts[0]);</strong><br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">//
            ------------------------------------------------------------<br>
            &nbsp; &nbsp; &nbsp; // Step 3 - Create a part reference to test with<br>
            &nbsp; &nbsp; &nbsp; // ------------------------------------------------------------</font><br>
            <br>
            &nbsp; &nbsp; &nbsp; <strong>enovwsprodstructcpp.ENOVIA createPartResultSet =<br>
            &nbsp; &nbsp; &nbsp; &nbsp; prodStructWrapper.CreatePartRef(<br>
            &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <font color="#0000FF">new string</font>[] { "ILCMgmtWS_CAA_PartRef1" },
            "", "FALSE");</strong><br>
            <br>
            &nbsp; &nbsp; &nbsp; <strong><font color="#0000FF">string</font>[] partRefUUIDs =<br>
            &nbsp; &nbsp; &nbsp; &nbsp;
            prodStructWrapper.GetENOVIA_VPMPartVersionUUIDs(createPartResultSet);</strong><br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">if</font> (partRefUUIDs.Length &gt; 1) {<br>
            &nbsp; &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Invalid state:
            more than 1 part reference was returned");<br>
            &nbsp; &nbsp; &nbsp; } <font color="#0000FF">else if</font> (partRefUUIDs.Length != 1) {<br>
            &nbsp; &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Failed to create
            part reference");<br>
            &nbsp; &nbsp; &nbsp; }<br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">string</font> partRefUUID = partRefUUIDs[0];<br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">//
            ------------------------------------------------------------<br>
            &nbsp; &nbsp; &nbsp; // Step 4 - Get 'Promote' transition<br>
            &nbsp; &nbsp; &nbsp; // ------------------------------------------------------------</font><br>
            <br>
            &nbsp; &nbsp; &nbsp; <strong><font color="#0000FF">string</font>[] transitionNames =
            lcMgmtWrapper.GetTransitions(partRefUUID);</strong><br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">for</font> (<font color="#0000FF">int</font> i = 0; i &lt;
            transitionNames.Length; i++) {<br>
            &nbsp; &nbsp; &nbsp; &nbsp; Console.Out.WriteLine("Transition[{0}]={1}", i, transitionNames[i]);<br>
            &nbsp; &nbsp; &nbsp; }<br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">//
            ------------------------------------------------------------<br>
            &nbsp; &nbsp; &nbsp; // Step 5 - Apply default transition<br>
            &nbsp; &nbsp; &nbsp; // ------------------------------------------------------------</font><br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">// As we just created the part, there should only be 1
            transition, 'Promote'</font><br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">if</font> (transitionNames.Length == 0) {<br>
            &nbsp; &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Failed to get
            default transition");<br>
            &nbsp; &nbsp; &nbsp; } <font color="#0000FF">else if</font> (transitionNames.Length != 1 ||
            !"Promote".Equals(transitionNames[0])) {<br>
            &nbsp; &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Use case does not
            handle customized lifecycle");<br>
            &nbsp; &nbsp; &nbsp; }<br>
            <br>
            &nbsp; &nbsp; &nbsp; <strong>lcMgmtWrapper.ApplyTransition(partRefUUID, transitionNames[0]);</strong><br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">//
            ------------------------------------------------------------<br>
            &nbsp; &nbsp; &nbsp; // Step 6 - Get transitions<br>
            &nbsp; &nbsp; &nbsp; // ------------------------------------------------------------</font><br>
            <br>
            &nbsp; &nbsp; &nbsp; <strong>transitionNames = lcMgmtWrapper.GetTransitions(partRefUUID);</strong><br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">for</font> (<font color="#0000FF">int</font> i = 0; i &lt;
            transitionNames.Length; i++) {<br>
            &nbsp; &nbsp; &nbsp; &nbsp; Console.Out.WriteLine("Transition[{0}]={1}", i, transitionNames[i]);<br>
            &nbsp; &nbsp; &nbsp; }<br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">//
            ------------------------------------------------------------<br>
            &nbsp; &nbsp; &nbsp; // Step 7 - Apply 'Demote' transition<br>
            &nbsp; &nbsp; &nbsp; // ------------------------------------------------------------</font><br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">// As we promoted the part, there should now only be 2
            transitions, 'Promote' &amp; 'Demote'</font><br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">if</font> (transitionNames.Length == 0) {<br>
            &nbsp; &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Failed to get
            default transition");<br>
            &nbsp; &nbsp; &nbsp; } <font color="#0000FF">else if</font> (transitionNames.Length != 2 ||
            !"Promote".Equals(transitionNames[0]) || !"Demote".Equals(transitionNames[1])) {<br>
            &nbsp; &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Use case does not
            handle customized lifecycle");<br>
            &nbsp; &nbsp; &nbsp; }<br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">// Apply 'Demote' transition</font><br>
            &nbsp; &nbsp; &nbsp; <strong>lcMgmtWrapper.ApplyTransition(partRefUUID, transitionNames[1]);</strong><br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">//
            ------------------------------------------------------------<br>
            &nbsp; &nbsp; &nbsp; // Step 8 - Get default transition again<br>
            &nbsp; &nbsp; &nbsp; // ------------------------------------------------------------</font><br>
            <br>
            &nbsp; &nbsp; &nbsp; <strong>transitionNames = lcMgmtWrapper.GetTransitions(partRefUUID);</strong><br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">// As we demoted the part, we should be back to the same start
            state<br></font> &nbsp; &nbsp; &nbsp; <font color="#0000FF">for</font> (<font color="#0000FF">int</font> i
            = 0; i &lt; transitionNames.Length; i++) {<br>
            &nbsp; &nbsp; &nbsp; &nbsp; Console.Out.WriteLine("Transition[{0}]={1}", i, transitionNames[i]);<br>
            &nbsp; &nbsp; &nbsp; }<br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#0000FF">if</font> (transitionNames.Length != 1 ||
            !"Promote".Equals(transitionNames[0])) {<br>
            &nbsp; &nbsp; &nbsp; &nbsp; <font color="#0000FF">throw new</font> ApplicationException("Failed to return
            to initial state");<br>
            &nbsp; &nbsp; &nbsp; }<br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">//
            ------------------------------------------------------------<br>
            &nbsp; &nbsp; &nbsp; // Step 9 - Cleanup by deleting created part reference<br>
            &nbsp; &nbsp; &nbsp; // ------------------------------------------------------------</font><br>
            <br>
            &nbsp; &nbsp; &nbsp; <strong>prodStructWrapper.DeletePartRef(<font color="#0000FF">new string</font>[] {
            partRefUUID });<br></strong> &nbsp; &nbsp; } <font color="#0000FF">catch</font> (Exception e) {<br>
            &nbsp; &nbsp; &nbsp; ...<br>
            &nbsp; &nbsp; } <font color="#0000FF">finally</font> {<br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">//
            ------------------------------------------------------------<br>
            &nbsp; &nbsp; &nbsp; // Step 10 - Terminate opened session<br>
            &nbsp; &nbsp; &nbsp; // ------------------------------------------------------------</font><br>
            <br>
            &nbsp; &nbsp; &nbsp; <font color="#008000">// The session must be closed even if a call to a method on the
            ENOVWSQueryCpp<br>
            &nbsp; &nbsp; &nbsp; // CAA Web service fails</font><br>
            &nbsp; &nbsp; &nbsp; <strong>binderWrapper.Logout(sessionToken);<br></strong> &nbsp; &nbsp; }<br>
            &nbsp; }<br>
            }</code>
          </td>
        </tr>
      </tbody>
    </table>
    <p align="right">
      [<a href="#Top">Top</a>]
    </p><!-- IN SHORT =================================================================================== IN SHORT -->
    <hr>
    <h3>
      <a name="InShort" id="InShort"></a>In Short
    </h3>
    <p>
      This use case explains how to use the C# client binding generated using the wsdl.exe utility in order to consume
      the ENOVWSLCMgmtCpp CAA Web service. It also gives an overview of the available methods:
    </p>
    <ul>
      <li>
        <a href="#GetTransitions"><code>GetTransitions</code></a>: get available transitions on a given object,
      </li>
      <li>
        <a href="#ApplyTransition"><code>ApplyTransition</code></a>: apply a transition on a given object.
      </li>
    </ul>
    <p align="right">
      [<a href="#Top">Top</a>]
    </p><!-- REFERENCES =============================================================================== REFERENCES -->
    <hr>
    <h3>
      <a name="References" id="References"></a>References
    </h3>
    <table border="0" width="100%">
      <tbody>
        <tr>
          <td valign="top">
            [1]
          </td>
          <td valign="top" align="left">
            <a href="#">Building and Launching a CAA Web Service Use Case</a>
          </td>
        </tr>
        <tr>
          <td valign="top">
            [2]
          </td>
          <td>
            <a href="#">Generating a C# Client Binding</a>
          </td>
        </tr>
        <tr>
          <td valign="top">
            [3]
          </td>
          <td>
            <a href="../CAAPLMSecUseCases/CAAENOPosAppBinderDotNetClient.htm">Consuming the
            ENOPosApplicationBinderImpl CAA Web Service</a>
          </td>
        </tr>
        <tr>
          <td valign="top">
            [4]
          </td>
          <td>
            <a href="CAAENOVWSProdStructCppDotNetClient.htm">Consuming the ENOVWSProdStructCpp CAA Web Service</a>
          </td>
        </tr>
        <tr>
          <td valign="top" align="right" colspan="2">
            [<a href="#Top">Top</a>]
          </td>
        </tr>
      </tbody>
    </table>
    <!-- FOOTER ===================================================================================== FOOTER -->
    <hr>
    <h3>
      <a name="History" id="History"></a>History
    </h3>
    <table border="0" width="100%">
      <tbody>
        <tr>
          <td valign="top">
            Version: <strong>1</strong> [Jan 2006]
          </td>
          <td valign="top">
            Document created
          </td>
        </tr>
        <tr>
          <td valign="top" align="right" colspan="2">
            [<a href="#Top">Top</a>]
          </td>
        </tr>
      </tbody>
    </table>
    <hr>
    <p>
      <em>Copyright © 2006, Dassault Systèmes. All rights reserved.</em>
    </p>
  </body>
</html>
