<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="Stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css">
<title>Consuming the ENOVWSChgMgmtImpl CAA Web Service</title>
</head>
<body>
<table width="100%">
	<tbody>
		<tr>
			<td valign="top">
			<h1>CAA Web Services Home</h1>
			</td>
			<td valign="top">
			<h2>&nbsp;</h2>
			</td>
			<td rowspan="2" align="right" valign="top">
			<h3><a name="Top"></a>Consuming the ENOVWSLCMgmtCpp CAA Web Service</h3>
			<em>Using the ENOVWSLCMgmtCpp CAA Web service for lifecycle 
			management</em></td>
		</tr>
		<tr>
			<td class="use" colspan="2">Use Case</td>
		</tr>
	</tbody>
</table>
<hr>
<!----------------------------------------------------------------------------->
<table class="abstract">
	<tbody>
		<tr>
			<td>
			<h3>Abstract</h3>
			<p>This article discusses <strong>CAAENOVWSLCMgmtCppAxis1_3Client</strong> 
			use case. It describes how to use the Java client binding that is 
			generated using the Axis WSDL2Java emitter in order to consume <strong> 
			ENOVWSLCMgmtCpp CAA Web Service</strong>. It provides a sample usage 
			scenario that demonstrates how to retrieve Affected Objects from 
			ENOVIA LCA V5.</p>
			<ul>
				<li><a href="#1"><strong>What You Will Learn With This Use Case</strong></a></li>
				<li><a href="#2"><strong>The CAAENOVWSLCMgmtAxis1_3CppClient Use 
				Case</strong></a>
				<ul>
					<li><a href="#2.1">What Does CAAENOVWSLCMgmtAxis1_3CppClient 
					use case do</a></li>
					<li><a href="#2.2">Where To Find the 
					CAAENOVWSLCMgmtAxis1_3CppClient Code</a></li>
					<li><a href="#2.3">How to Launch 
					CAAENOVWSLCMgmtAxis1_3CppClient</a></li>
				</ul>
				</li>
				<li><a href="#3"><strong>Step-by-step</strong></a></li>
				<li><a href="#InShort"><strong>In Short</strong></a></li>
				<li><a href="#References"><strong>References</strong></a></li>
			</ul>
			</td>
		</tr>
	</tbody>
</table>
<hr>
<!----------------------------------------------------------------------------->
<h3><a name="1"></a>What You Will Learn With This Use Case</h3>
<p>This use case is intended to demonstrate how to write a client application
that consumes the ENOVWSLCMgmtCpp CAA Web service. It uses the getTransitions 
and applyTransition
methods within this service as an example. More specifically, you will learn how
to:</p>
<ul>
	<li>Generate the Java client binding for the ENOVWSLCMgmtCpp CAA Web service,</li>
	<li>Write a wrapper class that instantiates the generated proxy, configures it,
	and uses it to remotely invoke methods on the CAA Web service,</li>
	<li>Write a class that demonstrates a sample usage scenario for
	ENOVWSLCMgmtCpp CAA Web service, using the wrapper class mentioned above.</li>
</ul>
<p>This article also provides guidance on how to build and run the sample client
application using <strong>IRAD (IBM Rational Application Developer) 6.0</strong>,
although any other Java IDE (Integrated Development Environment) or stand-alone
JDK/JRE (Java Development Kit/Java Runtime Environment) could be used for that
purpose.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!----------------------------------------------------------------------------->
<h3><a name="2"></a>The CAAENOVWSLCMgmtCppAxis1_3Client Use Case</h3>
<p>CAAENOVWSLCMgmtCppClient is a use case in the CAAENOVWS.edu framework. It
illustrates capabilities of the ENOVWSLCMgmtCpp CAA Web service.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!----------------------------------------------------------------------------->
<h4><a name="2.1"></a>What Does CAAENOVWSLCMgmtCppClient use case do</h4>
    <p>The sample usage scenario delivered with this use case contains the 
	following steps:</p>
    <ul>
        <li>Create a part reference, return its UUID,</li>
        <li>Get the list of lifecycle transitions for the created part,</li>
        <li>Apply the 'Promote' transition,</li>
        <li>Get the list of lifecycle transitions for the promoted part,</li>
        <li>Apply the 'Demote' transition,</li>
        <li>Delete the created part.</li>
    </ul>
<p align="left">The ENOVWSProdStructCpp CAA Web services (<a href="CAAENOVWSProdStructCppClient.htm">CreatePartRef
</a>and <a href="CAAENOVWSProdStructCppClient.htm">DeletePartRef </a>) are used 
in support of the primary objective of this use case, which is to get and apply 
transitions using the ENOVWSLCMgmtCpp CAA Web service.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!----------------------------------------------------------------------------->
<h4><a name="2.2"></a>Where To Find the CAAENOVWSLCMgmtCppAxis1_3Client Code</h4>
<p>The CAAENOVWSLCMgmtCppAxis1_3Client use case is made of several classes 
located in the
      <strong>CAAENOVWSAxis1_3Client.mj</strong> module of the <strong>
CAAENOVWS.edu</strong> framework:
    </p>
<table class="code" id="table1">
	<tbody>
		<tr>
			<td>
            <strong>Windows</strong>:
            <code><em>&lt;Install&gt;</em>\CAAENOVWS.edu\CAAENOVWSAxis1_3Client.mj\src</code><br>

            <strong>Unix</strong>:
            <code><em>&lt;Install&gt;</em>/CAAENOVWS.edu/CAAENOVWSAxis1_3Client.mj/src</code>
          </td>
		</tr>
	</tbody>
</table>
<ul>
	<li><code><i>&lt;Install-root-directory&gt;</i></code>: the directory where the 
	CAA CD-ROM is installed</li>
</ul>
<p>The sample Java resources generated using the Axis WSDL2Java emitter are 
delivered at the following location (<strong>Windows</strong>):</p>
<table class="code" id="table2">
	<tbody>
		<tr>
			<td><code><i>&lt;Source&gt;\&lt;Output-package&gt;</i>\CATServiceExceptionType.java<br>
			<i>&lt;Source&gt;\&lt;Output-package&gt;</i>\ENOVWSLCMgmtCpp.java<br>
			<i>&lt;Source&gt;\&lt;Output-package&gt;</i>\ENOVWSLCMgmtCppLocator.java<br>
			<i>&lt;Source&gt;\&lt;Output-package&gt;</i>\ILCMgmtWS.java<br>
			<i>&lt;Source&gt;\&lt;Output-package&gt;</i>\ILCMgmtWSBindingStub.java<i><br>
			&lt;Source&gt;\&lt;Output-package&gt;\Identifier.java<br>
			&lt;Source&gt;\&lt;Output-package&gt;\Status.java<br>
			&lt;Source&gt;\&lt;Output-package&gt;\holders\StringArrayTypeHolder.java</i></code></td>
		</tr>
	</tbody>
</table>
    <ul>
      <li>
        <code><em>&lt;Source&gt;</em></code>:
        <code><em>&lt;Install&gt;</em>\CAAENOVWS.edu\CAAENOVWSAxis1_3Client.mj\src</code>,       
      </li>
      <li>
        <code><em>&lt;Install&gt;</em></code>: same as above,       
      </li>
      <li>
        <code><em>&lt;Output-package&gt;</em></code>: 
		com\dassault_systemes\caaenovws\caaenovwsaxis1_3client\generated (based 
		on the output package value specified when using the WSDL2Java emitter).
      </li>
    </ul>
    <p>The CAAENOVWSAxis1_3Client.mj module contains the other following 
	resources:</p>
<table class="code" id="table3">
	<tbody>
		<tr>
			<td>
            <code><em>&lt;Source&gt;</em>\<em>&lt;Root-package&gt;</em>\CAAENOVWSClient.java<br>
            <em>&lt;Source&gt;</em>\<em>&lt;Root-package&gt;</em>\CAAENOVWSLCMgmtCppUseCase.java<br>
            <em>&lt;Source&gt;</em>\<em>&lt;Root-package&gt;</em>\CAAENOVWSLCMgmtCppWrapper.java</code>
          </td>
		</tr>
	</tbody>
</table>
<ul style="margin-bottom: 2mm">
	<li>
	<code style="font-family: 'Courier New', Courier; font-size: 110%; font-weight: normal">
	<em>&lt;Source&gt;</em></code>: same as above, </li>
	<li>
	<code style="font-family: 'Courier New', Courier; font-size: 110%; font-weight: normal">
	<em>&lt;Root-package&gt;</em></code>: 
	com\dassault_systemes\caaenovws\caaenovwsaxis1_3client.
      </li>
</ul>
<p>The <strong>CAAENOVWSLCMgmtCppWrapper</strong> class describes how to 
configure the generated proxy and how to invoke its methods. The <strong>
CAAENOVWSLCMgmtCppUseCase</strong> class demonstrates a sample use case scenario 
of the ENOVWSLCMgmtCpp CAA Web service. The <strong>CAAENOVWSClient</strong> 
class contains the main program. It parses the command line inputs and starts up 
the use case.
    </p>
    <p>
      This use case has a dependency on the <strong>CustomSessionHandler</strong> 
		class which is available in the 
      <strong>CAAJAXRPCHTTPSessionHandler.mj</strong> module of the <strong>
		CAAWebServices.edu</strong> 
      framework. Please refer to [<a href="#References">1</a>] for details on 
		HTTP session management and where to find the related class.
    </p>
    <p>
      This use case has also a dependency on the 
		CAAENOPosAppBinderImplAxis1_3Client use case in order to manage a 
		session with ENOVIA LCA V5. Please refer to [<a href="#References">2</a>] 
		for details on where to find the related code.
    </p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!----------------------------------------------------------------------------->
<h4><a name="2.3"></a>How to Launch CAAENOVWSLCMgmtCppCommandLineClient</h4>
    <p>
      To launch the CAAENOVWSLcMgmtCppAxis1_3Client use case, you will need to 
		set up a buildtime environment, build the code along with its 
		prerequisites, set up a runtime configuration and then execute the use 
		case. You can see [<a href="#References">3</a>] for details on how to 
		perform these steps within the IRAD 6 environment.
    </p>
    <p>
      There is no prerequisites to running this use case.
    </p>
    <p>
      The sample usage scenario delivered within this use case is launched from 
		the CAAENOVWSClient class. It defines a main method that takes several 
		options as parameters, as described below:
    </p>   
<p>&nbsp;</p>
<table class="code" id="table5">
	<tbody>
		<tr>
			<td><code>--w <em>&lt;URI&gt;</em> -e <em>&lt;ENOVIA username&gt;</em> -u
            <em>&lt;Basic Authentication username&gt;</em> -p <em>&lt;Basic 
			Authentication password&gt;</em> -t ENOVWSLCMgmtCpp</code> </td>
		</tr>
	</tbody>
</table>
    <ul>
      <li>
        <code><em>&lt;URI&gt;</em></code>: is the root URI of the Web application 
		where the ENOPosApplicationBinderImpl CAA Web service is deployed,       
      </li>
      <li>
        <code><em>&lt;ENOVIA username&gt;</em></code>: is a valid username declared in 
		the ENOVIA P&amp;O database,       
      </li>
      <li>
        <code><em>&lt;Basic Authentication Username&gt;</em> and <em>&lt;Basic 
		Authentication Password&gt;</em></code>: are a valid set of credentials for 
		authentication on the remote Web server.
      </li>
    </ul>
    <p>
      Here follows a sample command, to be updated with your own environment 
		configuration:
    </p>
    <table class="code" id="table6">
      <tbody>
        <tr>
          <td>
            <code>-w http://stophe1dsy.dsy.ds:9080/B17 -e cjk -u wpsadmin -p 
			wpsadmin -t ENOVWSLCMgmtCpp</code>
          </td>
        </tr>
      </tbody>
    </table>
<p>&nbsp;</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!----------------------------------------------------------------------------->
<h3><a name="3"></a>Step-by-step</h3>
<p>The following section first explains how to generate the Java client binding
for the ENOVWSLCMgmtCpp CAA Web service demonstrated. The remaining sections
then describe the code that must be written in order to consume this Web
service:</p>
<ol>
	<li><a href="#3.1">Creating the Java Client Binding</a></li>
	<li><a href="#3.2">Instantiating the Generated Proxy</a></li>
	<li><a href="#3.4.1">Applying a transition</a></li>
	<li><a href="#3.4.1">Get an array of transition names</a></li>
	<li><a href="#3.5">Sample Usage Scenario</a></li>
</ol>
<p align="right">[<a href="#Top">Top</a>]</p>
<!----------------------------------------------------------------------------->
<h4><a name="3.1"></a>Creating the Java Client Binding</h4>
    <p>
      Please refer to [<a href="#References">4</a>] for details on how to 
		generate the Java client binding using the Axis WSDL2Java emitter.
    </p>
    <p>
      Here follows a sample command in order to generate the Java client binding 
		for the ENOVWSLCMgmtCpp CAA Web service:
    </p>
<table class="code" id="table7">
	<tbody>
		<tr>
			<td><code>%JDK_HOME%\bin\java org.apache.axis.wsdl.WSDL2Java -o 
			C:\CAAENOVWS\src -p 
			com.dassault_systemes.caaenovws/caaenovwsaxis1_3client.generated&nbsp; 
			http://karindsy.dsy.ds:9080/V5R16/wsdl?service=urn:com:dassault_systemes:ENOVWSLCMgmtImpl:ENOVWSLCMgmtImpl:ENOVWSLCMgmtCpp</code></td>
		</tr>
	</tbody>
</table>
<p>The server name, port, and context root URI information must be updated to
match the server where the CAA Web service has been deployed. The list of
generated resources is available from the above section: "<a href="#2.2">Where
To Find the CAAENOVWSLCMgmtCppClient Code</a>".</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!----------------------------------------------------------------------------->
<h4><a name="3.2"></a>Instantiating the Generated Proxy</h4>
<p>In order to be able to consume the ENOVWSLCMgmtCpp CAA Web service 
implementation that has been deployed on a target server, you need to retrieve 
an instance of the <code>ILCMgmtWSBindingStub</code> generated class (also often 
referred to as the <b>proxy</b>). It's a common best practice to manipulate an 
instance through its dedicated interface whenever available. The WSDL2Java 
emitter produces an interface that is implemented by the <code>
ILCMgmtWSBindingStub</code>
class: <code>ILCMgmtWS</code>. It describes the methods available on the remote 
CAA Web service.</p>
<p>
<img src="../CAAIcons/images/warning.gif" alt="Warning" width="30" height="30">&nbsp; Although the <code>
ILCMgmtWSBindingStub</code>
class can be directly instantiated using its own set of constructors, the Axis 
User's Guide recommends to discard this approach. Instead, the recommended 
approach is to use another generated class for that purpose: <code>
ENOVWSLCMgmtImplLocator</code>. It implements the <code>ENOVWSLCMgmtCpp</code>
interface.</p>
<p>The following code describes how to instantiate the generated proxy. Such 
proxy is used in order to marshall method calls and objects to SOAP requests, 
and to unmarshall SOAP responses to objects. This proxy must be configured in 
order to manage authentication on the remote Web server, timeout, and session 
management. Maintaining the HTTP session state is mandatory when consuming 
ENOVIA LCA V5 CAA Web services. </p>
<table class="code">
	<tbody>
		<tr>
			<!-- Not using <pre></pre> because otherwise it doesn't print right -->
			<td>
			<pre>public class CAAENOVWSLCMgmtCppWrapper {
    private String SERVICE_ID = &quot;urn:com:dassault_systemes:ENOVWSLCMgmtImpl:ENOVWSLCMgmtImpl:ENOVWSLCMgmtCpp&quot;;
    private ILCMgmtWS proxy = null;</pre>
			<pre>    /**
     * Creates a new proxy for the ENOVWSLCMgmtCpp CAA Web service
     * implementation and configures it.
     * 
     * @param clientId the client identifier used to maintain the session state
     * accross distinct proxies
     * @param uri the root URI of the Web application hosting the implementation
     * of the ENOVWSLCMgmtCpp CAA Web service
     * @param timeOut the proxy timeout
     */
    public CAAENOVWSLCMgmtCppWrapper(String clientId, String uri, int timeOut) {
        // Compute the SOAP endpoint URI value that bounds to the deployed
        // implementation of the ENOVWSLCMgmtCpp CAA Web service
        String endpoint = uri + &quot;servicerouter?service=&quot; + SERVICE_ID;</pre>
			<pre>        // Retrieve proxy instance
        ENOVWSLCMgmtCppLocator locator = new ENOVWSLCMgmtCppLocator();
        try {
            proxy = locator.getENOVWSLCMgmtCppPort(new URL(endpoint));
        } catch (MalformedURLException e) {
            e.printStackTrace();
            throw new RuntimeException(
                    &quot;Invalid SOAP endpoint URI specified for the ENOVWSLCMgmtCpp CAA Web service proxy&quot;);
        } catch (ServiceException e) {
            e.printStackTrace();
            throw new RuntimeException(
                    &quot;Unable to instantiate the ENOVWSLCMgmtCpp CAA Web service proxy&quot;);
        }</pre>
			<pre>        // Required for HTTP session state management on the current proxy
        ((ILCMgmtWSBindingStub) proxy).setMaintainSession(true);</pre>
			<pre>        if (clientId != null) {
            // Used to maintain the HTTP session state accross distinct proxies
            HandlerInfo info = new HandlerInfo();
            info.setHandlerClass(CustomSessionHandler.class);
            Map handlerConfig = new HashMap();
            handlerConfig.put(CustomSessionHandler.CLIENT_ID, clientId);
            info.setHandlerConfig(handlerConfig);</pre>
			<pre>            HandlerRegistry registry = locator.getHandlerRegistry();
            String portName = locator.getENOVWSLCMgmtCppPortWSDDServiceName();
            QName name = new QName(portName);
            List chain = registry.getHandlerChain(name);
            chain.add(info);
        }</pre>
			<pre>        // Increase the default client time-out
        ((ILCMgmtWSBindingStub) proxy).setTimeout(timeOut);
    }</pre>
			<pre> }</pre>
&nbsp;</td>
		</tr>
	</tbody>
</table>
<p><strong>(1)</strong>: in order to maintain the HTTP session state between
successive calls performed using the same proxy instance, the <code>setMaintainSession</code>
method must be used. This is mandatory in the context of ENOVIA LCA V5 CAA Web
services,<br>
<strong>(2)</strong>: the default timeout is set to 60 seconds. This value can
be increased in order to avoid potential issues at runtime, such as losing the
HTTP connection before receiving the SOAP response. For security, the timeout is
set to 360 seconds (the value specified in the code is in milliseconds),<br>
<strong>(3)</strong>: when security is enabled, it is mandatory to set the <code>username</code>
and <code>password</code> attributes on the generated proxy. The values
specified must match a valid set of credentials for the Basic Authentication
mechanism.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!----------------------------------------------------------------------------->
<h4><a name="3.4"></a>Applying a transition</h4>
<p>To apply a lifecycle transition in ENOVIA LCA V5 use the following method, which
is available through the generated <code> ILCMgmtWS</code> proxy
interface:&nbsp;</p>
<table class="code">
	<tbody>
		<tr>
			<td>Status applyTransition (<code><br>
			</code>iObjectId, <code>
			<br>
			</code>iTransitionName) throws RemoteException, 
            CATServiceExceptionType;</td>
		</tr>
	</tbody>
</table>
<p>This method accepts the following parameters:</p>
<table width="971">
	<tbody>
		<tr>
			<td width="149"><code>[in] iObjectId</code></td>
			<td width="818">&nbsp;The identifier of the target  object</td>
		</tr>
		<tr>
			<td width="149"><code>[in]  </code>iTransitionName</td>
			<td width="818">&nbsp;The name of the transition to apply</td>
		</tr>
	</tbody>
</table>
<p>The following code demonstrates the use of the <code>getAffectedObjects</code>
method:</p>
<table class="code">
	<tbody>
		<tr>
			<!-- Not using <pre></pre> because it doesn't print right -->
			<td>
			<pre>public class CAAENOVWSLCMgmtCppWrapper {
...
    public void applyTransition(String objectUUID, String transitionName)
            throws Exception {
        System.out.println(&quot;&gt;&gt;&gt; Invoking 'applyTransition' on ENOVWSLCMgmtCpp CAA Web service proxy&quot;);
        if (objectUUID == null) {
            throw new IllegalArgumentException(&quot;Object UUID is null&quot;);
        } else if (transitionName == null) {
            throw new IllegalArgumentException(&quot;Transition name is null&quot;);
        }
        System.out.println(&quot;Object UUID: &quot; + objectUUID);
        System.out.println(&quot;Transition name: &quot; + transitionName);</pre>
			<pre>        // Create input data
        Identifier objectId = CAAENOVWSUtils.toIdentifier(objectUUID);</pre>
			<pre>        // Invoke method on remote CAA Web service
        try {
            Status status = proxy.applyTransition(objectId, transitionName);
            System.out.println(&quot;Status: &quot; + status.getStatus());
        } catch (CATServiceExceptionType e) {
            throw e;
        } catch (Throwable t) {
            throw new Exception(&quot;Failed to apply transition&quot;, t);
        }
    }
}</pre>
&nbsp;</td>
		</tr>
	</tbody>
</table>
<h4><a name="3.4.1"></a>Get an array of transition names</h4>
<p>To get an array of lifecycle transition names in ENOVIA LCA V5 use the following method, which
is available through the generated <code> ILCMgmtWS</code> proxy
interface:&nbsp;</p>
<table class="code">
	<tbody>
		<tr>
			<td>Status getTransitions(<br>
            Identifier iObjectId, <br>
            StringArrayTypeHolder oTransitionNames) throws RemoteException, 
            com.dassault_systemes.caaenovws.caaenovwsaxis1_1clientgen.generated.CATServiceExceptionType;</td>
		</tr>
	</tbody>
</table>
<p>This method accepts the following parameters:</p>
<table width="971">
	<tbody>
		<tr>
			<td width="176"><code>[in] iObjectId</code></td>
			<td width="791">&nbsp;The identifier of the target  object</td>
		</tr>
		<tr>
			<td width="176"><code>[out] </code>oTransitionNames</td>
			<td width="791">&nbsp;The string array of transition names which are 
            available to apply</td>
		</tr>
	</tbody>
</table>
<p>The following code demonstrates the use of the getTransitions
method:</p>
<table class="code">
	<tbody>
		<tr>
			<!-- Not using <pre></pre> because it doesn't print right -->
			<td>
			<pre>public class CAAENOVWSLCMgmtCppWrapper {
 ....
    public String[] getTransitions(String objectUUID) throws Exception {
        System.out.println(&quot;&gt;&gt;&gt; Invoking 'getTransitions' on ENOVWSLCMgmtCpp CAA Web service proxy&quot;);
        if (objectUUID == null) {
            throw new IllegalArgumentException(&quot;Object UUID is null&quot;);
        }
        System.out.println(&quot;Object UUID: &quot; + objectUUID);</pre>
			<pre>        // Create input data
        Identifier objectId = CAAENOVWSUtils.toIdentifier(objectUUID);
        StringArrayTypeHolder transitionNames = new StringArrayTypeHolder();</pre>
			<pre>        // Invoke method on remote CAA Web service
        try {
            Status status = proxy.getTransitions(objectId, transitionNames);
            System.out.println(&quot;Status: &quot; + status.getStatus());
        } catch (CATServiceExceptionType e) {
            throw e;
        } catch (Throwable t) {
            throw new Exception(&quot;Failed to get transition(s)&quot;, t);
        }</pre>
			<pre>        if (transitionNames == null || transitionNames.value == null) {
            throw new Exception(&quot;Failed to get transitions&quot;);
        }
        return transitionNames.value;
    }
}</pre>
&nbsp;</td>
		</tr>
	</tbody>
</table>
<p>&nbsp;</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!----------------------------------------------------------------------------->
<h4><a name="3.5"></a>Sample Usage Scenario</h4>
<p>The sample usage scenario consumes the following CAA web services:</p>
<ul>
	<li>ENOVWSLCMgmtCpp CAA web service to get and apply transitions to a part 
    from ENOVIA LCA V5,</li>
	<li>ENOPosApplicationBinderImpl CAA web service to logon on/out ENOVIA LCA V5.
	See [<a href="#References">2</a>] for details,</li>
	<li>ENOVWSProdStructCpp CAA web service to create and delete a part from
	ENOVIA LCA V5. See [<a href="#References">5</a>] for details.</li>
</ul>
<p>The following code demonstrates a sample usage scenario for the
ENOVWSLCMgmtCpp CAA Web service:</p>
<table class="code">
	<tbody>
		<tr>
			<!-- Not using <pre></pre> because it doesn't print right -->
			<td>
			<pre>public class CAAENOVWSLCMgmtCppUseCase {
    private String uri = null;
    private String credUser = null;
    private String credPwd = null;</pre>
			<pre>    public CAAENOVWSLCMgmtCppUseCase(String uri, String credUser, String credPwd) {
        this.uri = uri;
        this.credUser = credUser;
        this.credPwd = credPwd;
    }</pre>
			<pre>    public void runSampleUsageScenario(String enoviaUser) {
        boolean success = false;
        Exception exception = null;
        CAAENOPosApplicationBinderImplWrapper binderWrapper = null;
        SessionToken sessionToken = null;</pre>
			<pre>        try {
            // ------------------------------------------------------------
            // Step 1 - Instantiate and configure the proxy
            // ------------------------------------------------------------</pre>
			<pre>            System.out.println(&quot;STEP 1: Instantiating and configuring CAA Web service proxy&quot;);</pre>
			<pre>            String clientId = new Long(System.currentTimeMillis()).toString();
            int timeOut = 360000;</pre>
			<pre>            // Instantiate the wrapper client classes
            binderWrapper = new CAAENOPosApplicationBinderImplWrapper(clientId,
                    uri, credUser, credPwd, timeOut);
            CAAENOVWSProdStructCppWrapper prodStructWrapper = new CAAENOVWSProdStructCppWrapper(
                    clientId, uri, timeOut);
            CAAENOVWSLCMgmtCppWrapper lcMgmtWrapper = new CAAENOVWSLCMgmtCppWrapper(
                    clientId, uri, timeOut);</pre>
			<pre>            // ------------------------------------------------------------
            // Step 2 - Open session with ENOVIA LCA V5
            // ------------------------------------------------------------</pre>
			<pre>            System.out.println(&quot;--------------------------------------------------------------------------------&quot;);
            System.out.println(&quot;STEP 2: Opening session with ENOVIA LCA V5&quot;);
            System.out.println(&quot;--------------------------------------------------------------------------------&quot;);</pre>
			<pre>            String[] userContexts = binderWrapper.getUserContexts(enoviaUser);</pre>
			<pre>            System.out.println(&quot;Found &quot; + userContexts.length + &quot; context(s) in database&quot;);
            System.out.println(&quot;Displaying list of available contexts:&quot;);
            for (int i = 0; i &lt; userContexts.length; i++) {
                System.out.println(&quot;Context[&quot; + i + &quot;]: &quot; + userContexts[i]);
            }</pre>
			<pre>            System.out.println(&quot;\n--------------------------------------------------------------------------------&quot;);
            System.out.println(&quot;STEP 3: Logging on to ENOVIA LCA V5&quot;);
            System.out.println(&quot;--------------------------------------------------------------------------------&quot;);</pre>
			<pre>            if (userContexts.length == 0) {
                throw new Exception(&quot;No context found for the user specified&quot;);
            }
            sessionToken = binderWrapper.login(userContexts[0]);</pre>
			<pre>            // ------------------------------------------------------------
            // Step 3 - Create a part reference to test with
            // ------------------------------------------------------------</pre>
			<pre>            System.out.println(&quot;--------------------------------------------------------------------------------&quot;);
            System.out.println(&quot;STEP 3: Creating part reference&quot;);
            System.out.println(&quot;--------------------------------------------------------------------------------&quot;);</pre>
			<pre>            ENOVIA createPartResultSet = prodStructWrapper.createPartRef(new String[] { &quot;ILCMgmtWS_CAA_PartRef1&quot; },
                                                                         &quot;&quot;,
                                                                         &quot;FALSE&quot;);</pre>
			<pre>            String[] partRefUUIDs = prodStructWrapper.getENOVIA_VPMPartVersionUUIDs(createPartResultSet);
            if (partRefUUIDs.length &gt; 1) {
                throw new Exception(
                        &quot;Invalid state: more than 1 part reference was returned&quot;);
            } else if (partRefUUIDs.length != 1) {
                throw new Exception(&quot;Failed to create part reference&quot;);
            }
            String partRefUUID = partRefUUIDs[0];</pre>
			<pre>            // ------------------------------------------------------------
            // Step 4 - Get 'Promote' transition
            // ------------------------------------------------------------</pre>
			<pre>            System.out.println(&quot;--------------------------------------------------------------------------------&quot;);
            System.out.println(&quot;STEP 4: Getting transitions&quot;);
            System.out.println(&quot;--------------------------------------------------------------------------------&quot;);</pre>
			<pre>            String[] transitionNames = lcMgmtWrapper.getTransitions(partRefUUID);</pre>
			<pre>            for (int i = 0; i &lt; transitionNames.length; i++) {
                System.out.println(&quot;Transition[&quot; + i + &quot;]: &quot; + transitionNames[i]);
            }</pre>
			<pre>            // ------------------------------------------------------------
            // Step 5 - Apply default transition
            // ------------------------------------------------------------</pre>
			<pre>            System.out.println(&quot;--------------------------------------------------------------------------------&quot;);
            System.out.println(&quot;STEP 5: Applying 'Promote' transition&quot;);
            System.out.println(&quot;--------------------------------------------------------------------------------&quot;);</pre>
			<pre>            // As we just created the part, there should only be 1 transition,
            // 'Promote'
            if (transitionNames.length == 0) {
                throw new Exception(&quot;Failed to get default transition&quot;);
            } else if (transitionNames.length != 1 || !&quot;Promote&quot;.equals(transitionNames[0])) {
                throw new Exception(
                        &quot;Use case does not handle customized lifecycle&quot;);
            }</pre>
			<pre>            lcMgmtWrapper.applyTransition(partRefUUID, transitionNames[0]);</pre>
			<pre>            // ------------------------------------------------------------
            // Step 6 - Get transitions
            // ------------------------------------------------------------</pre>
			<pre>            System.out.println(&quot;--------------------------------------------------------------------------------&quot;);
            System.out.println(&quot;STEP 6: Getting transitions&quot;);
            System.out.println(&quot;--------------------------------------------------------------------------------&quot;);</pre>
			<pre>            transitionNames = lcMgmtWrapper.getTransitions(partRefUUID);</pre>
			<pre>            for (int i = 0; i &lt; transitionNames.length; i++) {
                System.out.println(&quot;Transition[&quot; + i + &quot;]: &quot; + transitionNames[i]);
            }</pre>
			<pre>            // ------------------------------------------------------------
            // Step 7 - Apply 'Demote' transition
            // ------------------------------------------------------------</pre>
			<pre>            System.out.println(&quot;--------------------------------------------------------------------------------&quot;);
            System.out.println(&quot;STEP 7: Applying 'Demote' transition&quot;);
            System.out.println(&quot;--------------------------------------------------------------------------------&quot;);</pre>
			<pre>            // As we promoted the part, there should now only be 2 transitions,
            // 'Promote' &amp; 'Demote'
            if (transitionNames.length == 0) {
                throw new Exception(&quot;Failed to get default transition&quot;);
            } else if (transitionNames.length != 2 || !&quot;Promote&quot;.equals(transitionNames[0]) || !&quot;Demote&quot;.equals(transitionNames[1])) {
                throw new Exception(
                        &quot;Use case does not handle customized lifecycle&quot;);
            }</pre>
			<pre>            // Apply 'Demote' transition
            lcMgmtWrapper.applyTransition(partRefUUID, transitionNames[1]);</pre>
			<pre>            // ------------------------------------------------------------
            // Step 8 - Get default transition again
            // ------------------------------------------------------------</pre>
			<pre>            System.out.println(&quot;--------------------------------------------------------------------------------&quot;);
            System.out.println(&quot;STEP 8: Getting transitions&quot;);
            System.out.println(&quot;--------------------------------------------------------------------------------&quot;);</pre>
			<pre>            transitionNames = lcMgmtWrapper.getTransitions(partRefUUID);</pre>
			<pre>            // As we demoted the part, we should be back to the same start state
            for (int i = 0; i &lt; transitionNames.length; i++) {
                System.out.println(&quot;Transition[&quot; + i + &quot;]: &quot; + transitionNames[i]);
            }</pre>
			<pre>            if (transitionNames.length != 1 || !&quot;Promote&quot;.equals(transitionNames[0])) {
                throw new Exception(&quot;Failed to return to initial state&quot;);
            }</pre>
			<pre>            // ------------------------------------------------------------
            // Step 9 - Cleanup by deleting created part reference
            // ------------------------------------------------------------</pre>
			<pre>            System.out.println(&quot;--------------------------------------------------------------------------------&quot;);
            System.out.println(&quot;STEP 9: Deleting part reference&quot;);
            System.out.println(&quot;--------------------------------------------------------------------------------&quot;);</pre>
			<pre>            prodStructWrapper.deletePartRef(new String[] { partRefUUID });</pre>
			<pre>            success = true;
        } catch (CATServiceExceptionType e) {
            exception = e;
        } catch (Exception e) {
            exception = e;
        } finally {
            // ------------------------------------------------------------
            // Step 4 - Terminate opened session
            // ------------------------------------------------------------</pre>
			<pre>            System.out.println(&quot;--------------------------------------------------------------------------------&quot;);
            System.out.println(&quot;STEP 5: Terminating opened session with ENOVIA LCA V5&quot;);
            System.out.println(&quot;--------------------------------------------------------------------------------&quot;);</pre>
			<pre>            // The session must be closed even if a call to a method on the
            // ENOVWSLCMgmtCpp CAA Web service fails
            try {
                binderWrapper.logout(sessionToken);
            } catch (Exception e) {
                System.err.println(&quot;Failed to logout gracefully&quot;);
            }
        }</pre>
			<pre>        if (success) {
            System.out.println(&quot;================================================================================&quot;);
            System.out.println(&quot;Use case execution successful&quot;);
        } else {
            System.out.println(&quot;================================================================================&quot;);
            System.out.println(&quot;Use case execution failed&quot;);
            System.out.println(&quot;--------------------------------------------------------------------------------&quot;);
            if (exception instanceof CATServiceExceptionType) {
                CATServiceExceptionType e = (CATServiceExceptionType) exception;
                System.out.println(&quot;Error code: &quot; + e.getCode());
                System.out.println(&quot;Error message: &quot; + e.getMessage());
                if (e.getErrorArguments() != null) {
                    String[] errorArguments = e.getErrorArguments();
                    System.out.println(&quot;Error arguments: &quot; + errorArguments.length);
                    for (int i = 0; i &lt; errorArguments.length; i++) {
                        System.out.println(&quot;\tArgument[&quot; + i + &quot;]: &quot; + errorArguments[i]);
                    }
                }
            } else {
                System.out.println(exception.getMessage());
                if (exception.getCause() != null) {
                    // Handle nested exceptions launched from the use case
                    System.out.println(&quot;Exception details:&quot;);
                    exception.getCause().printStackTrace();
                } else if (exception.getStackTrace() != null &amp;&amp; exception.getStackTrace().length != 0) {
                    // Handle unexpected exceptions
                    System.out.println(&quot;Exception details:&quot;);
                    exception.printStackTrace();
                }
            }
        }
    }
}</pre>
&nbsp;</td>
		</tr>
	</tbody>
</table>
    <p>
      The <code>CAAENOVWSUtils.displayResults</code> method can be found at:
    </p>
    <table class="code" id="table8">
      <tbody>
        <tr>
          <td>
            <code><em>&lt;Install&gt;</em>\<em>&lt;Source&gt;</em>\<em>&lt;Package&gt;</em>\CAAENOVWSUtils.java</code>
          </td>
        </tr>
      </tbody>
    </table>
    <ul>
      <li>
        <code><em>&lt;Install&gt;</em></code>: the root directory where the CAA CD-ROM 
		is installed,       
      </li>
      <li>
        <code><em>&lt;Source&gt;</em></code>: 
		\CAAENOVWS.edu\CAAENOVWSAxis1_3Client.mj\src,       
      </li>
      <li>
        <code><em>&lt;Package&gt;</em>\com\dassault_systemes\caaenovws\caaenovwsaxis1_3client</code>.
      </li>
    </ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<!----------------------------------------------------------------------------->
<hr>
<h3><a name="InShort"></a>In Short</h3>
<p>This use case explains how to use the Java client binding generated using the
Axis WSDL2Java emitter in order to consume the ENOVWSLCMgmtCpp CAA Web service.
It also gives an overview of the methods used in this use case:</p>
<ul>
	<li>getTranstions method from ENOVWSLCMgmtCpp CAA Web service to get the 
    list of lifecycle transitions for the created part.</li>
	<li>applyTransition method from ENOVWSLCMgmtCpp CAA Web service to apply the 
    promote transition.</li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<!----------------------------------------------------------------------------->
<hr>
<h3><a name="References"></a>References</h3>
<table border="0" width="100%">
	<tbody>
		<tr>
			<td valign="top">[1]</td>
			<td><a href="../CAAWSTechArticles/CAAWSMaintainSessionWithAxis.htm">Maintaining
			the Session State</a></td>
		</tr>
		<tr>
			<td valign="top">[2]</td>
			<td><a href="../CAAPLMSecUseCases/CAAENOPosAppBinderAxisClient.htm">Consuming
			the ENOPosApplicationBinderImpl CAA Web Service</a></td>
		</tr>
		<tr>
			<td valign="top">[3]</td>
			<td valign="top" align="left"><a href="../CAAWSUseCases/CAAWSBuildAndLaunchUsingAxis.htm">Building
			and Launching a CAA Web Service Use Case</a></td>
		</tr>
		<tr>
			<td valign="top">[4]</td>
			<td><a href="../CAAWSTechArticles/CAAWSClientUsingAxis.htm">Generating
			a Java Client Binding</a></td>
		</tr>

		<tr>
			<td valign="top">[5]</td>
			<td><a href="CAAENOVWSProdStructCppClient.htm">Consuming the 
            ENOVWSProdStructCpp CAA Web Service</a></td>
		</tr>
		<tr>
			<td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
		</tr>
	</tbody>
</table>
<!----------------------------------------------------------------------------->
<hr>
<h3><a name="History"></a>History</h3>
<table border="0" width="100%">
	<tbody>
		<tr>
			<td valign="top">Version: <strong>1</strong> [July 2005]</td>
			<td valign="top">Document created</td>
		</tr>
		<tr>
          <td valign="top">
            Version: <strong>2</strong> [Feb 2006]
          </td>
          <td valign="top">
            Document updated
          </td>
        </tr>
		<tr>
			<td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
		</tr>
	</tbody>
</table>
<!----------------------------------------------------------------------------->
<hr>
<p><i>Copyright © 1994-2006,&nbsp; Dassault Systèmes. All rights reserved.</i></p>
</body>
</html>

