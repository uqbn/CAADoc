<html>

 <head>
 <meta http-equiv="Content-Language" content="fr">
 <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
 <meta name="GENERATOR" content="Microsoft FrontPage 5.0">
 <meta name="ProgId" content="FrontPage.Editor.Document">
 <link rel="Stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css">
 <title>Subscribing to Events</title>
 </head>

 <body>

 <table width="100%">
   <tr>
     <td valign="top">
     <h1>3D PLM PPR Hub Open Gateway</h1>
     </td>
     <td>
     <h2>Knowledge Modeler</h2>
     </td>
     <td rowspan="2" align="right" valign="top">
     <h3><a name="Top"></a>Subscribing to Events</h3>
     <p><em>How to be warned when events occur on parameters</em></td>
   </tr>
   <tr>
     <td class="use" colspan="2">Use Case</td>
   </tr>
 </table>
 <hr>
 <!---------------------------------comment------------------------------------->
 <table class="abstract">
   <tr>
     <td>
     <h3>Abstract</h3>
     <p>An event is an object that notifies another that an event has occurred. 
     This article explains how to subscribe to the events supported by the 
     KnowledgeInterfaces framework.</p>
     <ul>
       <li><b><a href="#Learn">What You Will Learn With This Use Case</a></b></li>
       <li><a href="#Events"><b>About the KnowledgeInterfaces Framework Events</b></a></li>
       <li><a href="#UseCase"><b>The CAALifEvents Use Case</b></a></li>
       <ul>
         <li><a href="#What">What Does CAALifEvents Do</a></li>
         <li><a href="#How">How to Launch CAALifEvents</a></li>
         <li><a href="#Where">Where to Find the CAALifEvents Code</a></li>
       </ul>
       </li>
       <li><a href="#Step"><strong>Step-by-Step</strong></a></li>
       <li><a href="#InShort"><strong>In Short</strong></a></li>
       <li><a href="#References"><strong>References</strong></a></li>
     </ul>
     </td>
   </tr>
 </table>
 <hr>
 <!---------------------------------comment------------------------------------->
 <h3><a name="Learn"></a>What You Will Learn With This Use Case</h3>
 <p>This article explains how to subscribe to &quot;change value&quot;, &quot;change visu&quot; and 
 &quot;delete&quot; events.</p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h3><a name="Events"></a>About the KnowledgeInterfaces Framework Events</h3>
 <p>The LiteralFeatures platform supports four types of events which are 
 described by the CATIParrnEvents interface. These events are:</p>
 <ol>
   <li>the parameter value modification or &quot; ChangeValue&quot; event (CATIParmEvents::GetChangeValueNotification)</li>
   <li>the parameter rename (CATIParmEvents::GetRenameNotification)</li>
   <li>the modification of the parameter appearance or &quot;Change Visu&quot; event (CATIParmEvents::GetChangeVisuNotification)
   <ul>
     <li>when the visibility changes (hidden command)</li>
     <li>when the access rights are modified</li>
     <li>when the relation constraining the parameter is either set or unset, 
     activated or deactivated</li>
     <li>when the magnitude current unit changes</li>
   </ul>
   </li>
   <li>the parameter delete (CATIParmEvents::GetDeleteNotification).</li>
 </ol>
 <p>When designing a literal-based application, if you want to be warned 
 whenever a parameter is modified, you must: be provided with a feature whose 
 purpose is to observe or detect the parameter modifications. This feature must 
 subscribe to the events supported by the LiteralFeatures platform.</p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h3><a name="UseCase"></a>The CAALifEvents Use Case</h3>
 <p>CAALifEvents is a use case of the CAALiteralFeatures.edu framework that 
 illustrates KnowledgeInterfaces framework capabilities.</p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="What"></a>What Does CAALifEvents Do</h4>
 <p>This use case:</p>
 <ol>
   <li>Creates a length type parameter</li>
   <li>Subscribes to the events occurring on this parameter</li>
   <li>Modifies its value</li>
   <li>Checks that a &quot;change value&quot; notification has been issued</li>
   <li>Modifies its access rights</li>
   <li>Checks that a &quot;visu notification&quot; has been issued</li>
   <li>Deletes the parameter</li>
   <li>Checks that a &quot;delete notification&quot; has been issued</li>
 </ol>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="How"></a>How to Launch CAALifEvents</h4>
 <p>To launch CAALifEvents, you will need to set up the build time environment, 
 then compile CAALifEventsMain along with its prerequisites, set up the run time 
 environment, and then execute the use case which main program is CAALifEventsMain [<a href="#References">1</a>].</p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="Where"></a>Where to Find the CAALifEvents Code</h4>
 <p>The CAALifEvents use case is located in:</p>
 <table>
   <tr>
     <td>Windows</td>
     <td><code>InstallRootDirectory\CAALiteralFeatures.edu\CAALifEvents.m\</code></td>
   </tr>
   <tr>
     <td>Unix</td>
     <td><code>InstallRootDirectory/CAALiteralFeatures.edu/CAALifEvents.m/</code></td>
   </tr>
 </table>
 <p>where <code>InstallRootDirectory</code> is the directory where the CAA 
 CD-ROM is installed.</p>
 <p>The main program related to this use case is CAALifEventsMain.</p>
 <p>An implementation of the CAAILifMyFeatureEvents interface is defined in the 
 CAALifMyFeatureEventsExt extension of the CAAMyFeature late type. The interface 
 is defined in the PrivateInterfaces directory, the implementation is defined in 
 the CAALifEvents.m module.</p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h3><a name="Step"></a>Step-by-Step</h3>
 <p>Here is the step-by-step description of the program:</p>
 <ol>
   <li><a href="#Step1">Retrieving the Knowledge Factory</a></li>
   <li><a href="#Step2">Creating a Length Parameter</a></li>
   <li><a href="#Step3">Specifying the Current Unit of the Length Parameter</a></li>
   <li><a href="#Step4">Creating the &quot;CAAMyfeature&quot; StartUp</a></li>
   <li><a href="#Step5">Creating the &quot;OBJ0&quot; instance from the &quot;CAAMyFeature&quot; 
   StartUp</a></li>
   <li><a href="#Step6">Subscribing to the Three Events</a></li>
   <li><a href="#Step7">Modifying the Length Parameter Value</a></li>
   <li><a href="#Step8">Displaying the Number of &quot;change value&quot; Notifications</a></li>
   <li><a href="#Step9">Modifying the Access Rights of the Length Parameter</a></li>
   <li><a href="#Step10">Mofifying the Current Unit of the Length Parameter</a></li>
   <li><a href="#Step11">Displaying the Number of &quot;change visu&quot; Notifications</a></li>
   <li><a href="#Step12">Deleting the Length Parameter</a></li>
   <li><a href="#Step13">Deleting the Feature Event Object</a></li>
 </ol>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="Step1"></a>Retrieving the Knowledge Factory</h4>
 <p>The CATICkeParmFactory is retrieved from the document container. For more 
 information on the purpose of this factory, see [<a href="#References">2</a>].</p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="Step2"></a>Creating a Length Parameter</h4>
 <p>A Length type parameter is created. This parameter is assigned a 1m initial 
 value. Let's remind you that the value you pass in the argument of a 
 CreateLength method is read as an SI unit. This also applies to other literal 
 creation methods. The parameter which is created is the one we are going to 
 &quot;observe&quot;. In other words its is going to subscribe to the events managed by 
 the KnowledgeInterfaces framework.</p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="Step3"></a>Specifying the Current Unit of the Length Parameter</h4>
 <p>The current unit of the &quot;Length&quot; parameter is specified as the first item of 
 the list which is displayed in the Tools-&gt;Options-&gt;Units for parameters of 
 Length type. In our example, the first unit in the list of units for Length 
 type parameter is the mm. Depending on your application settings, you may get a 
 different unit when displaying a parameter value. For more information, see [<a href="#References">3</a>].</p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="Step4"></a>Creating the &quot;CAAMyfeature&quot; StartUp</h4>
 <p>The &quot;CAAMyfeature&quot; StartUp is created. The CAAMyFeature late type is defined 
 in the CAALifBasis.m module. The CAALifMyFeaturesEventsExt extension provides 
 an implementation of the CAAILifMyFeatureEvents interface which is defined in 
 the PrivateInterfaces directory.</p>
 <p>About the CAAILifMyFeatureEvents::Observe method:<br>
 This method which is implemented in the CAALifMyFeaturesEventsExt.cpp extension 
 uses the CATInterfaceEvents::AddSubscription method defined in the 
 ObjectModelerBase framework.</p>
 <table class="code">
   <tr>
     <td>
     <pre>virtual CATCallback AddSubscription( CATInterfaceEvents *<i>eventManager</i>,
        CATCallbackEvent <i>event</i>,
        CATSubscriberMethod <i>method</i>,
        char *<i>interfaceID</i>,
        CATSubscriberData <i>data</i> = NULL ) = 0 ;</pre>
     </td>
   </tr>
 </table>
 <p>Writing the instruction below:</p>
 <table class="code">
   <tr>
     <td>
     <pre>spSpev-&gt;AddSubscription(spParameterEvents,
              spParameterEvents-&gt;GetChangeValueNotification(),
             (CATSubscriberMethod)&amp;CAAILifMyFeatureEvents::IfChangeValue,
              &quot;CAAILifMyFeatureEvents&quot;,
            (CATSubscriberData) this);</pre>
     </td>
   </tr>
 </table>
 <p>means that the parameter the Observe method is applied to calls the service 
 defined in the third argument (IfChangeValue) when the event specified in the 
 second argument occurs. The CAAILifMyFeatureEvents::IfChangeValue method is 
 defined in CAALifMyFeatureEventsExp::Observe extension. It just increments a 
 counter and displays a message in the standard output whenever the parameter 
 value is modified.</p>
 <p>Subscriptions to &quot;delete&quot; and &quot;change visu&quot; events are patterned on the same 
 principle. </p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="Step5"></a>Creating the &quot;OBJ0&quot; instance from the &quot;CAAMyFeature&quot; 
 StartUp</h4>
 <p>The &quot;OBJ0&quot; instance is created from the &quot;CAAMyFeature&quot; StartUp.</p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="Step6"></a>Subscribing to the Three Events</h4>
 <p>Subscribe to the three events defined in the CAAILifMyFeatureEvents::Observe 
 method and implemented in the CAALifMyFeatureEventsExt extension. From this 
 point, all the &quot;change value&quot;, &quot;change visu&quot; and &quot;delete&quot; events should issue a 
 message and increment the counters defined in the Observe method.</p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="Step7"></a>Modifying the Length Parameter Value</h4>
 <p>The &quot;Length&quot; parameter value is replaced with 30 mm. let's remind you that 
 when you use the CATICkeParm::ValuateStored method the value specified in the 
 argument is the document default unit (i.e. mm for length parameters). Upon 
 modification of the &quot;Length&quot; parameter, the counter which record the &quot;change 
 value&quot; events increments. The statements below:</p>
 <table class="code">
   <tr>
     <td>
     <pre>spStore-&gt;ValuateStored (30);
cout &lt;&lt; &quot;The p1 value is &quot; &lt;&lt; spLength-&gt;Show().CastToCharPtr() &lt;&lt; endl;</pre>
     </td>
   </tr>
 </table>
 <p>display in the standard output:</p>
 <table class="code">
   <tr>
     <td>
     <pre>Receiving ChangeValue number 1
The p1 value is 30mm</pre>
     </td>
   </tr>
 </table>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="Step8"></a>Displaying the Number of &quot;change value&quot; Notifications</h4>
 <p>The number of &quot;change value&quot; notifications is displayed. As expected, 1 
 notification has been recorded.</p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="Step9"></a>Modifying the Access Rights of the Length Parameter</h4>
 <p>The access rights of the &quot;Length&quot; parameter are modified. A &quot;change visu&quot; 
 notification should be issued. The statements below:</p>
 <table class="code">
   <tr>
     <td>
     <pre>spLength-&gt;SetUserAccess(CATICkeParm::ReadOnly);
cout &lt;&lt; &quot;Number of \&quot;change visu\&quot; notifications (1 is expected) &quot; ;
    cout &lt;&lt; CAALifMyFeatureEventsExt::nbchangevisu &lt;&lt; endl;</pre>
     </td>
   </tr>
 </table>
 <p>display in the standard output:</p>
 <table class="code">
   <tr>
     <td>
     <pre>Receiving ChangeVisu number 1
Number of &quot;change visu&quot; notifications (1 is expected) 1</pre>
     </td>
   </tr>
 </table>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="Step10"></a>Mofifying the Current Unit of the Length Parameter</h4>
 <p>The current unit of the &quot;Length&quot; parameter is modified. A &quot;change visu&quot; 
 notification should be issued. The statements below:</p>
 <table class="code">
   <tr>
     <td>
     <pre>spMag-&gt;SetCurrentUnit ((*(spMag-&gt;Units()))[2]);
cout &lt;&lt; &quot;The p1 value is &quot; &lt;&lt; spLength-&gt;Show().CastToCharPtr() &lt;&lt; endl;</pre>
     </td>
   </tr>
 </table>
 <p>display in the standard output:</p>
 <table class="code">
   <tr>
     <td>
     <pre>Receiving ChangeVisu number 2
The p1 value is 0.03m</pre>
     </td>
   </tr>
 </table>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="Step11"></a>Displaying the Number of &quot;change visu&quot; Notifications</h4>
 <p>The number of &quot;change visu&quot; notifications is displayed. As expected, 2 
 notifications have been recorded.</p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="Step12"></a>Deleting the Length Parameter</h4>
 <p>The &quot;Length&quot; parameter is deleted. The statements below:</p>
 <table class="code">
   <tr>
     <td>
     <pre>spLco-&gt;remove();
cout &lt;&lt; &quot;Number of \&quot;delete\&quot; notifications (1 is expected) &quot; ;
cout &lt;&lt; CAALifMyFeatureEventsExt::nbdelete &lt;&lt; endl;</pre>
     </td>
   </tr>
 </table>
 <p>display in the standard output the following messages </p>
 <table class="code">
   <tr>
     <td>
     <pre>Receiving Delete number 1
Number of &quot;delete&quot; notifications (1 is expected) 1</pre>
     </td>
   </tr>
 </table>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="Step13"></a>Deleting the Feature Event Object</h4>
 <p>The CAAILifMyFeatureEvents object is deleted. Note that is strongly 
 recommended to delete an event object after all objects it was intended to be 
 applied have been deleted.</p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <hr>
 <!---------------------------------comment------------------------------------->
 <h3><a name="InShort"></a>In Short</h3>
 <p>Four types of events are supported by the LiteralFeatures platform:</p>
 <ol>
   <li>The parameter value modification or &quot; ChangeValue&quot; event </li>
   <li>The parameter rename </li>
   <li>The modification of the parameter appearance or &quot;Change Visu&quot; event</li>
   <li>The parameter delete.</li>
 </ol>
 <p>When developing an application, subscribing to events requires a feature 
 dedicated to the detection of parameter modifications.</p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <hr>
 <!---------------------------------comment------------------------------------->
 <h3><a name="References"></a>References</h3>
 <table width="100%">
   <tr>
     <td valign="top">[1]</td>
     <td>
     <a href="../CAADocUseCases/CAADocRunSample.htm">
     Building and Launching a CAA V5 Use Case</a></td>
   </tr>
   <tr>
     <td valign="top">[2]</td>
     <td><a href="CAALifFirstApplication.htm#Step1">Getting Started with Literal 
     Feature Programming</a></td>
   </tr>
   <tr>
     <td valign="top">[3]</td>
     <td><a href="../CAALifTechArticles/CAALifUnits.htm">About Units</a></td>
   </tr>
   <tr>
     <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
   </tr>
 </table>
 <hr>
 <!---------------------------------comment------------------------------------->
 <h3><a name="History"></a>History</h3>
 <table width="100%">
   <tr>
     <td valign="top">Version: <strong>1</strong> [Jan 2000]</td>
     <td valign="top">Document created</td>
   </tr>
   <tr>
     <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
   </tr>
 </table>
 <hr>
 <!---------------------------------comment------------------------------------->
 <p><i>Copyright © 2000, Dassault Systèmes. All rights reserved.</i></p>

  </body>

</html>
