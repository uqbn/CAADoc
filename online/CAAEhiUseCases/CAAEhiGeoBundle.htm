<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 6.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<link rel="Stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css">
<title>Analyzing a Harness Branch</title>
</head>

<body>

<table width="100%">
  <tr>
    <td valign="top">
      <h1>Equipment &amp; Systems Engineering</h1>
    </td>
    <td valign="top">
      <h2>Electrical Harness Installation</h2>
    </td>
    <td rowspan="2" align="right" valign="top">
      <h3><a name="Top"></a>Analyzing a Harness Branch</h3>
      <em>How to get geometrical definition of a harness branch</em></td>
  </tr>
  <tr>
    <td class="use" colspan="2">Use Case</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->

<table class="abstract">
  <tr>
    <td>
      <h3>Abstract</h3>
      <p>This article discusses the <i>CAAEhiGeoBundle</i> use case. This use
      case explains how to navigate within an existing product structure,
      searching geometrical bundles and bundle segments, and how to get
      geometrical definition of a bundle segment.
      <ul>
        <li><strong><a href="#Learn">What You Will Learn With This Use Case</a></strong></li>
        <li><a href="#UseCase"><strong>The CAAEhiGeoBundle Use Case</strong></a>
          <ul>
            <li><a href="#What">What Does CAAEhiGeoBundle Do</a></li>
            <li><a href="#How">How to Launch CAAEhiGeoBundle</a></li>
            <li><a href="#Where">Where to Find the CAAEhiGeoBundle Code</a></li>
          </ul>
        </li>
        <li><strong><a href="#Step">Step-by-Step</a></strong></li>
        <li><strong><a href="#InShort">In Short</a></strong></li>
        <li><strong><a href="#References">References</a></strong></li>
      </ul>
    </td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->

<h3><a name="Learn"></a>What You Will Learn With This Use Case</h3>
<p>This use case is intended to show you how to browse the content of a harness
branch (geometrical bundles) and to get geometrical definition of bundle
segments.
<p>Following operations are detailed is this use case:
<ul>
  <li>How to initialize the electrical environment .</li>
  <li>How to retrieve all geometrical bundles in product structure.</li>
  <li>How to retrieve all bundle segments contained in a geometrical bundle.</li>
  <li>How to retrieve geometrical curve defining the bundle segment route.</li>
  <li>How to retrieve supports linked to a bundle segment.</li>
  <li>How to manage attributes of a bundle segment.</li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h3><a name="UseCase"></a>The CAAEhiGeoBundle Use Case</h3>
<p>CAAEhiGeoBundle is a use case of the CAAElecHarnessItf.edu framework that
illustrates the ElecHarnessItf framework capabilities.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="What"></a>What Does CAAEhiGeoBundle Do</h4>
<p>The goal of CAAEhiGeoBundle is to navigate within an product structure and to
retrieve and analyze geometrical bundle content. The existing product structure
is found under the pathname of the document passed as an argument to this
program.</p>
<table width="1043">
  <tr>
    <td width="1035"><img border="0" src="images/CAAEhiGeoBundle.jpg" width="712" height="522"></td>
  </tr>
</table>
<p>Above is a CATIA image of a product structure we will use as an example to
browse electrical harness components.
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="How"></a>How to Launch CAAEhiGeoBundle?</h4>
<p>To launch CAAEhiGeoBundle, you will need to set up the build time
environment, then compile CAAEhiGeoBundle.cpp along with its prerequisites, set
up the run time environment, and then execute the sample. This is fully
described in the referenced article [<a href="#References">2</a>].</p>
<p>To launch the use case, execute the following command:</p>
<pre>mkrun -c &quot;CAAEhiGeoBundle input.CATProduct&quot;</pre>
<ul>
  <li><b>input.CATProduct</b> - the path to the existing external CATProduct to
    be browsed. You may reference the supplied CATProduct document called
    &quot;CAA_EhiSample.CATProduct&quot; found in:
	<pre><b>InstallRootDirectory</b>\<b>OS</b>\resources\graphic</pre>
	<p>where <b>InstallRootDirectory</b> is the root directory of your CAA V5 installation, 
	and <b>OS</b> is a directory the name of which depends on the operating system. 
	Refer to [<a href="#References">1</a>] to get the list of the currently supported 
	operating systems and their associated directory names.</p>
</li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Where"></a>Where to Find the <i>CAAEhiGeoBundle</i> Code?</h4>
<p>CAAEhiGeoBundle code is located in the CAAEhiGeoBundle.m use case module of
the CAAElecHarnessItf.edu framework:</p>
<table>
  <tr>
    <td>Windows</td>
    <td><code>InstallRootDirectory/CAAElecHarnessItf.edu/CAAEhiGeoBundle.m</code></td>
  </tr>
  <tr>
    <td>Unix</td>
    <td><code>InstallRootDirectory\CAAElecHarnessItf.edu\CAAEhiGeoBundle.m</code></td>
  </tr>
</table>
<p>where <code>InstallRootDirectory</code> is the root directory of your CAA V5
installation. It is made of a unique source file named <b>CAAEhiGeoBundle</b><b>.cpp</b>.
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h3><a name="Step"></a>Step-by-Step</h3>
<p>There are six logical steps in <i>CAAEhiGeoBundle</i>:</p>
<ol>
  <li><a href="#Prolog">Prolog</a></li>
  <li><a href="#Init_Elec">Initializing Electrical Environment</a></li>
  <li><a href="#Retrieve_GBN">Retrieving all Geometrical Bundle under Root
    Product and Selecting one to Analyze</a></li>
  <li><a href="#Retrieve_BNS">Retrieving all Bundle Segments under Selected
    Geometrical Bundle and Selecting one to Analyze</a></li>
  <li><a href="#Retrieve_CRV">Retrieving Electrical Curve ( Bundle Segment Route
    )</a></li>
  <li><a href="#Get_SPT">Retrieving all Supports Linked to Bundle Segment</a></li>
  <li><a href="#Get_Attribute">Retrieving Electrical Attributes of Bundle
    Segment</a></li>
  <li><a href="#Close">Epilog</a>.</li>
</ol>
<p>We will now comment each of those sections by looking at the code.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Prolog"></a>Prolog</h4>
<p>Once the current session has been created, the CATProduct document can be
loaded into the session . pDoc is a pointer to this document.</p>
<p>The root product of the document is retrieved . pRootProduct is a CATIProduct
handle to the root product .</p>
<p>Methodology describing how to load a CATProduct document and how to retrieve
the root product is described in <a href="#References">[1]</a>.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Init_Elec"></a>Initialize Electrical Environment</h4>
<table class="code">
  <tr>
    <td>
      <pre>...</pre>
      <pre>CATIEleDocServices * piElecDocServices = NULL;
  
  rc = pDoc-&gt;QueryInterface(IID_CATIEleDocServices,(void**) &amp;piElecDocServices );
  if ( SUCCEEDED(rc) &amp;&amp; piElecDocServices )
  {
    rc = piElecDocServices-&gt;Initialize();
  }

...</pre>
    </td>
  </tr>
</table>
<p>Initializing the electrical environment is mandatory to enable access to
electrical object or electrical attributes.
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Retrieve_GBN">Retrieving all Geometrical Bundle under Root Product
and Selecting one to Analyze</a></h4>
<table class="code">
  <tr>
    <td>
      <pre>...</pre>
      <pre>  CATListValCATBaseUnknown_var* pListGeoBundle = NULL;
  pListGeoBundle = piRootProduct-&gt;GetAllChildren(CATIEhiGeoBundle::ClassName());
  piRootProduct -&gt; Release();
  piRootProduct = NULL ;
  
  int NumberOfGeoBundle = 0;
  if ( (NULL!=pListGeoBundle) &amp;&amp; pListGeoBundle-&gt;Size() ) 
  {
    NumberOfGeoBundle = pListGeoBundle-&gt;Size();	

...</pre>
    </td>
  </tr>
</table>
<p>We use generic method CATIProduct::GetAllChildren to retrieve all geometric
bundles under root product.</p>
<table class="code">
  <tr>
    <td>
      <pre>...</pre>
      <pre>  CATIEhiGeoBundle * piGeoBundle = NULL;
  rc = (*pListGeoBundle)[NumberOfGeoBundle]-&gt;QueryInterface(IID_CATIEhiGeoBundle,(void**) &amp;piGeoBundle);

...</pre>
    </td>
  </tr>
</table>
<p>Last element in list of geometric bundle is selected.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<h4><a name="Retrieve_BNS">Retrieving all Bundle Segments under Selected
Geometrical Bundle and Selecting one to Analyze</a></h4>
<table class="code">
  <tr>
    <td>
      <pre>...</pre>
      <pre>  CATListValCATBaseUnknown_var* pListBundleSegment = NULL;
  rc = piGeoBundle-&gt;ListBundleSegments(&amp;pListBundleSegment);

...</pre>
    </td>
  </tr>
</table>
<p>We use <code>CATIEhiBundleSegment::ListBundleSegments</code> to retrieve list
of bundle segments under selected geometric bundle.</p>
<table class="code">
  <tr>
    <td>
      <pre>...</pre>
      <pre>  CATIEhiBundleSegment * piBundleSegment = NULL;
  
  int rank = 1;
  rc = (*pListBundleSegment)[rank]-&gt;QueryInterface(IID_CATIEhiBundleSegment,(void**) &amp;piBundleSegment);

...</pre>
    </td>
  </tr>
</table>
<p>We select first element in list of bundle segments.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<h4><a name="Retrieve_CRV">Retrieving Electrical Curve ( Bundle Segment Route )</a></h4>
<table class="code">
  <tr>
    <td>
      <pre>...</pre>
      <pre>  CATIGSMSpline * piSpline = NULL;
  //
  rc = piBundleSegment-&gt;GetElecCurve(&amp;piSpline);

...</pre>
    </td>
  </tr>
</table>
<p>We get flexible curve linked to bundle segment . This curve may be
manipulated using <i>CATIGSMSpline</i> interface.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<h4><a name="Get_SPT">Retrieving all Supports Linked to Bundle Segment</a></h4>
<table class="code">
  <tr>
    <td>
      <pre>...</pre>
      <pre>  CATListValCATBaseUnknown_var* pListInstanceSupport = NULL;
  int numberOfSupport = 0;
  rc = piBundleSegment-&gt;ListLinkedSupports(&amp;pListInstanceSupport);

...</pre>
    </td>
  </tr>
</table>
<p>Method <i>ListLinkedSupports</i> is used to retrieve all support instances
linked to bundle segment.</p>
<table class="code">
  <tr>
    <td>
      <pre>...</pre>
      <pre>  CATListValCATBaseUnknown_var* pListReferenceSupport = new CATLISTV(CATBaseUnknown_var);
  
  ...
  
  // --- compute list of support references 
  cout &lt;&lt; &quot;   get list of reference  &quot;&lt;&lt; endl &lt;&lt; flush;
  int numberOfReference = 0;
  for ( i=1; i&lt;=numberOfSupport; i++ )
  {
    (*pListInstanceSupport)[i]-&gt;QueryInterface(IID_CATIProduct,(void**) &amp;piInstanceProduct);
    if ( NULL !=  piInstanceProduct )
    {
      CATIProduct_var spReferenceProduct = piInstanceProduct-&gt;GetReferenceProduct();
      if ( NULL_var !=  spReferenceProduct ) pListReferenceSupport-&gt;Append(spReferenceProduct);

...</pre>
    </td>
  </tr>
</table>
<p>Second part illustrates the way to retrieve support references from list of
support instances.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<h4><a name="Get_Attribute">Retrieving Electrical Attributes of Bundle Segment</a></h4>
<table class="code">
  <tr>
    <td>
      <pre>...</pre>
      <pre>  CATIElecAttrAccess * piElecAttribute = NULL;
  piBundleSegment-&gt;QueryInterface(IID_CATIElecAttrAccess,(void**) &amp;piElecAttribute);
   
  ...
  // -- list attributes on object
  cout &lt;&lt; &quot;   get list of attributes of bundle segment &quot;&lt;&lt; endl &lt;&lt; flush;
  CATListValCATUnicodeString* pAttNameList = NULL; 
  //
  rc = piElecAttribute-&gt;ListAttributeNames ( pAttNameList );

...</pre>
    </td>
  </tr>
</table>
<p>We use <i>CATIElecAttrAccess </i>to get electrical attributes of bundle
segment. Using method <code>ListAttributeNames </code>, we first get all
attributes of bundle segment .</p>
<table class="code">
  <tr>
    <td>
      <pre>...</pre>
      <pre>CATUnicodeString AttributeToRead = &quot;Elec_LengthOUT&quot;;
  double  bns_length = 0.;
  CATICkeInst_var spCKEvalue ;
  cout &lt;&lt; &quot;   get length of bundle segment ( MKSA unit system ) &quot;&lt;&lt;endl &lt;&lt; flush;
  cout &lt;&lt; &quot;       . get value (MKSA) of attribute &quot;&lt;&lt; AttributeToRead.ConvertToChar() &lt;&lt;endl &lt;&lt; flush;
  rc = piElecAttribute-&gt;Get(AttributeToRead,spCKEvalue);
  if ( SUCCEEDED(rc) )
  {
    if ( NULL_var != spCKEvalue ) bns_length = spCKEvalue-&gt;AsReal();

...</pre>
    </td>
  </tr>
</table>
<p>Second part illustrates method to get attribute values using <code>CATIElecAttrAccess::GetValue
</code>. Each attribute value is returned as a <i>CATICkeInst</i> interface
smart pointer.<a href="#References">[3]</a></p>
<p>Real attribute values may be read using <code>As<font color="#FF0000">Type</font></code><font color="#FF0000">
</font>method of <i>CATICkeInst</i> interface where <i><font color="#FF0000">Type</font></i>
may be <i><font color="#FF0000">Integer,Real,Boolean,String</font></i> depending
of type of attribute. All values are given in MKSA unit system <a href="#References">[4]</a>
.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<h4><a name="Close">Epilog</a></h4>
<table class="code">
  <tr>
    <td>
      <pre>...</pre>
      <pre>rc = CATDocumentServices::Remove(*pDoc);
...
rc = ::Delete_Session(sessionName);
.</pre>
    </td>
  </tr>
</table>
<p>Opened documents are removed and session is deleted before exit.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<p align="right">&nbsp;</p>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="InShort"></a>In Short</h3>
<p>This use case is has demonstrated how to browse the content of a harness
branch and to get geometrical definition of bundle segments contained in a
geometrical bundle.
<p>Following operations have been detailed is this use case :
<ul>
  <li>How to activate electrical environment using <code>Initialize </code>method
    of <i>CATIEleDocServices</i>.</li>
  <li>How to retrieve geometrical bundles in product structure using <code>GetAllChildren</code>
    method of <i>CATIProduct</i></li>
  <li>How to retrieve bundle segments contained in geometrical bundle using <code>ListBundleSegments</code>
    of <i>CATIEhiBundleSegment</i></li>
  <li>How to get geometrical curve defining bundle segment route using <code>GetElecCurve</code>
    of <i>CATIEhiBundleSegment.</i></li>
  <li>How to get supports linked to bundle segment using <code>ListLinkedSupports
    </code>of <i>CATIEhiBundleSegment.</i></li>
  <li>How to manage attributes of bundle segment using <code>ListAttributeNames </code>and
    <code>GetValue</code> of <i>CATIElecAttrAccess</i>.</li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="References"></a>References</h3>
<table width="100%">
  <tr>
    <td valign="top">[1]</td>
    <td><a href="../CAAPstUseCases/CAAPstBrowse.htm">Browsing
      a Product Structure</a></td>
  </tr>
  <tr>
    <td valign="top">[2]</td>
    <td><a href="../CAADocUseCases/CAADocRunSample.htm">Building
      and Launching a CAA V5 Use Case</a></td>
  </tr>
  <tr>
    <td valign="top">[3]</td>
    <td><a href="../CAALifUseCases/CAALifParamPers.htm">Using
      Persistent Parameters</a></td>
  </tr>
  <tr>
    <td valign="top">[4]</td>
    <td><a href="../CAALifTechArticles/CAALifUnits.htm">About
      Units</a></td>
  </tr>
  <tr>
    <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="History"></a>History</h3>
<table width="100%">
  <tr>
    <td valign="top">Version: <strong>1</strong> [Jul 2001]</td>
    <td valign="top">Document created</td>
  </tr>
  <tr>
    <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<p><i>Copyright © 2001, Dassault Systèmes. All rights reserved.</i></p>

</body>

</html>

