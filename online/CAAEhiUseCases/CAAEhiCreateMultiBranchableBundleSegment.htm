<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<link rel="Stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css">
<title>Managing a Multi Branchable Bundle Segment</title>
</head>

<body>

<table width="100%">
  <tr>
    <td valign="top">
      <h1>Equipment &amp; Systems Engineering</h1>
    </td>
    <td valign="top">
      <h2>Electrical Harness Installation</h2>
    </td>
    <td rowspan="2" align="right" valign="top">
      <h3><a name="Top"></a>Managing a Multi Branchable Bundle Segment</h3>
      <em>How to create and manage a multi branchable bundle segment</em></td>
  </tr>
  <tr>
    <td class="use" colspan="2">Use Case</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->

<table class="abstract">
  <tr>
    <td>
      <h3>Abstract</h3>
      <p>This article discusses the <i>CAAEhiCreateMultiBranchableBundleSegment</i>
      use case. This use case explains how to create a geometrical bundle, a
      multi branchable bundle segment, and how to manage a multi branchable
      bundle segment, particularly adding or removing a branch, defining the
      route of each bundle segment belonging to the multi branchable bundle
      segment.
      <ul>
        <li><strong><a href="#Learn">What You Will Learn With This Use Case</a></strong></li>
        <li><a href="#UseCase"><strong>The
          CAAEhiCreateMultiBranchableBundleSegment Use Case</strong></a>
          <ul>
            <li><a href="#What">What Does
              CAAEhiCreateMultiBranchableBundleSegment Do</a></li>
            <li><a href="#How">How to Launch </a><a href="#What">CAAEhiCreateMultiBranchableBundleSegment</a></li>
            <li><a href="#Where">Where to Find the </a><a href="#What">CAAEhiCreateMultiBranchableBundleSegment</a><a href="#Where">
              Code</a></li>
          </ul>
        </li>
        <li><strong><a href="#Step">Step-by-Step</a></strong></li>
        <li><strong><a href="#InShort">In Short</a></strong></li>
        <li><strong><a href="#References">References</a></strong></li>
      </ul>
    </td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->

<h3><a name="Learn"></a>What You Will Learn With This Use Case</h3>
<p>This use case is intended to show you how to create geometrical bundle and a
multi branchable bundle segment, how to manage this multi branchable bundle
segment.
<p>Following operations are detailed is this use case:
<ul>
  <li>How to initialize the electrical environment .</li>
  <li>How to create a geometrical bundle.</li>
  <li>How to create a multi branchable bundle segment</li>
  <li>How to manage a multi branchable bundle segment</li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h3><a name="UseCase"></a>The CAAEhiCreateMultiBranchableBundleSegment Use Case</h3>
<p>CAAEhiCreateMultiBranchableBundleSegment is a use case of the
CAAElecHarnessItf.edu framework that illustrates the ElecHarnessItf framework
capabilities.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="What"></a>What Does CAAEhiCreateMultiBranchableBundleSegment Do</h4>
<p>The goal of CAAEhiCreateMultiBranchableBundleSegment is to create a
geometrical bundle in a new CATProduct document. Multi branchable bundle
segments are created under geometrical bundle.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="How"></a>How to Launch CAAEhiCreateMultiBranchableBundleSegment?</h4>
<p>To launch CAAEhiCreateMultiBranchableBundleSegment, you will need to set up
the build time environment, then compile
CAAEhiCreateMultiBranchableBundleSegment.cpp along with its prerequisites, set
up the run time environment, and then execute the sample. This is fully
described in the referenced article [<a href="#References">2</a>].</p>
<p>To launch the use case, execute the following command:</p>
<pre>mkrun -c &quot;CAAEhiCreateMultiBranchableBundleSegment PathDir Main GbnName MultiBnsName&quot;</pre>
<ul>
  <li><b>PathDir</b> - the path where to save documents. Under Windows, the path
    could be: E:\HarnessDesign\</li>
  <li><b>Main</b> - the name of the main document saved</li>
  <li><b>GbnName</b> - the part number of the geometrical bundle</li>
  <li><b>MultiBnsName</b> - the part number of the multi branchable bundle
    segment created</li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Where"></a>Where to Find the <i>CAAEhiCreateMultiBranchableBundleSegment</i>
Code?</h4>
<p>CAAEhiCreateMultiBranchableBundleSegment code is located in the
CAAEhiCreateMultiBranchableBundleSegment.m use case module of the
CAAElecHarnessItf.edu framework:</p>
<table>
  <tr>
    <td>Windows</td>
    <td><code>InstallRootDirectory/CAAElecHarnessItf.edu/</code>CAAEhiCreateMultiBranchableBundleSegment<code>.m</code></td>
  </tr>
  <tr>
    <td>Unix</td>
    <td><code>InstallRootDirectory\CAAElecHarnessItf.edu\</code>CAAEhiCreateMultiBranchableBundleSegment<code>.m</code></td>
  </tr>
</table>
<p>where <code>InstallRootDirectory</code> is the root directory of your CAA V5
installation. It is made of a unique source file named <b>CAAEhiCreateMultiBranchableBundleSegment</b><b>.cpp</b>.
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h3><a name="Step"></a>Step-by-Step</h3>
<p>There are six main logical steps in <i>CAAEhiCreateMultiBranchableBundleSegment</i>:</p>
<ol>
  <li><a href="#Prolog">Prolog</a></li>
  <li><a href="#Init_Elec">Initializing Electrical Environment.</a></li>
  <li><a href="#Create_GBN">Creating a Geometrical Bundle.</a></li>
  <li><a href="#Create_BNS">Creating a multi Branchable Bundle Segment.</a></li>
  <li><a href="#GetExtr_BNS">Managing a multi branchable bundle segment.</a></li>
  <li><a href="#Close">Epilog.</a></li>
</ol>
<p>We will now comment each of those sections by looking at the code.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Prolog"></a>Prolog</h4>
<p>Once the current session has been created, the CATProduct document is created
into the session . pGbnDoc is a pointer to this document.</p>
<p>The root product of the document is retrieved . piRootProduct is a
CATIProduct handle to the root product .</p>
<p>Methodology describing how to create a CATProduct document and how to
retrieve the root product is described in <a href="#References">[1]</a>.</p>
<p align="right">&nbsp;[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Init_Elec"></a>Initialize Electrical Environment</h4>
<table class="code">
  <tr>
    <td>
      <pre>...</pre>
      <pre>CATIEleDocServices * piElecDocServices = NULL;
  
  rc = pDoc-&gt;QueryInterface(IID_CATIEleDocServices,(void**) &amp;piElecDocServices );
  if ( SUCCEEDED(rc) &amp;&amp; piElecDocServices )
  {
    rc = piElecDocServices-&gt;Initialize();
  }

...</pre>
    </td>
  </tr>
</table>
<p>Initializing the electrical environment is mandatory to enable access to
electrical objects or electrical attributes .</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Create_GBN"></a>Creating Geometrical Bundle</h4>
<p>Geometrical Bundle is created using CATEhiFactory interface on root product
piGbnRootProduct.</p>
<table class="code">
  <tr>
    <td>
      <pre>...</pre>
      <pre>CATIEhiGeoBundle * piGeoBundle = NULL;  // the geometrical bundle
  //
  CATIEhiFactory * piEhiFactory = NULL;   // the factory
  //
  rc = piGbnRootProduct-&gt;QueryInterface(IID_CATIEhiFactory,(void**) &amp;piEhiFactory );
  //     
...  
  rc = piEhiFactory-&gt;CreateGeometricalBundle(&amp;piGeoBundle);

...</pre>
    </td>
  </tr>
</table>
<p>piGeoBundle is the pointer to geometrical bundle.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<h4><a name="Create_BNS"></a>Creating Multi&nbsp; Branchable&nbsp;Bundle
Segment.</h4>
<p>&nbsp;</p>
<p><u>First step is the creation of multi branchable bundle segment part.</u></p>
<p>A new CATPart document is created and added into the product structure. After
its creation, the multi branchable bundle segment contains one branchable.</p>
<p>&nbsp;For each branch, a bundle segment is created.</p>
<table class="code">
  <tr>
    <td>
      <pre>...</pre>
      <pre>CATIEhiMultiBranchable * piMultiBranchable = NULL;</pre>
      <pre>...
 rc = piGeoBundle-&gt;CreateMultiBranchable (&amp; piMultiBranchable );


...</pre>
    </td>
  </tr>
</table>
<p>piMultiBranchable is a pointer on the multi brancahble bundle segment.</p>
<p>&nbsp;</p>
<p><u>Second step is the creation of the branches of the multi branchable bundle
segment </u>.</p>
<p>Two branches are successively created&nbsp; :</p>
<table class="code">
  <tr>
    <td>
      <pre>...</pre>
      <pre> CATIEhiBranchable* piNewBranchable=NULL;</pre>
      <pre>  rc = piMultiBranchable-&gt;AddBranchable(&amp;piNewBranchable);

...</pre>
    </td>
  </tr>
</table>
<p>After the last call to AddBranchable, the multi branchable contains three
branchables.</p>
<p>&nbsp;</p>
<p><u>Third step is the retrieving of branchables of the multi branchable</u></p>
<p>Three branchables are retrieved from the multi branchable :</p>
<table class="code">
  <tr>
    <td>
      <pre>...</pre>
      <pre>  CATListValCATBaseUnknown_var* pListBranchable = NULL;
  rc = piMultiBranchable-&gt;ListBranchables(&amp;pListBranchable);

  ...

  CATIEhiBranchable * piBranchable1 = NULL;
  CATIEhiBranchable * piBranchable2 = NULL;
  CATIEhiBranchable * piBranchable3 = NULL;


  rc = (*pListBranchable)[1]-&gt;QueryInterface(IID_CATIEhiBranchable,(void**) &amp;piBranchable1);</pre>
      <pre>  ...

  rc = (*pListBranchable)[2]-&gt;QueryInterface(IID_CATIEhiBranchable,(void**) &amp;piBranchable2);</pre>
      <pre>  ...

  rc = (*pListBranchable)[3]-&gt;QueryInterface(IID_CATIEhiBranchable,(void**) &amp;piBranchable3);

...</pre>
    </td>
  </tr>
</table>
<p>&nbsp;</p>
<p><u>Fourth&nbsp; step is the definition of bundle segment computation
parameters </u>.</p>
<p>Bundle segment centre curve is computed according geometrical parameters (
minimum bend radius, constraint points, tangency constraints ) and physical
parameter ( gravity)</p>
<p>Two design methodologies are available : distributed <b>slack</b> or<b>
length </b>mode.</p>
<ol>
  <li>Distributed slack : a percentage of extra length is added to minimum
    length computed by the system ( according minimum bend radius ).</li>
  <li>Length : it is the length the user wants to respect for a given bundle
    segment. Input length must be greater than minimum length.</li>
</ol>
<p>Following attributes have to be defined :</p>
<ul>
  <li><b>bend radius </b>: minimum bend radius of the bundle segment centre
    curve.</li>
  <li><b>build mode</b> : string defining the methodology used to compute bundle
    segment centre curve : &quot;Slack&quot; or &quot;Length&quot; .</li>
  <li><b>slack</b> : value in percent of distributed slack slack added.</li>
  <li><b>length</b> : length of bundle segment (in meter).</li>
  <li><b>diameter</b>: diameter of bundle segment circular section.</li>
</ul>
<p>Branchable 1 is created with <b>Slack </b>mode.</p>
<table class="code">
  <tr>
    <td>
      <pre>...</pre>
      <pre>  CATUnicodeString mode=&quot;Slack&quot;;

  double slack=2;
  double length=0.;
  double bend_radius=15.;
  double diameter = 3.;

  rc = SetBranchableAttributes ( piBranchable1, mode, slack, length, bend_radius, diameter );
  
...</pre>
    </td>
  </tr>
</table>
<p>Branchable 2 is created with <b>slack </b>mode.</p>
<table class="code">
  <tr>
    <td>
      <pre>...</pre>
      <pre>  mode=&quot;Slack&quot;; 
  slack = 1.5;
  length = 0.;
  bend_radius = 12.;
  diameter = 2.;

  rc = SetBranchableAttributes ( piBranchable2, mode, slack, length, bend_radius, diameter );
  
...</pre>
    </td>
  </tr>
</table>
<p>Branchable 3 is created with <b>slack </b>mode.</p>
<table class="code">
  <tr>
    <td>
      <pre>...</pre>
      <pre>   mode=&quot;Slack&quot;;</pre>
      <pre>   slack = 1;
   length = 0.;
   bend_radius = 25.;
   diameter = 5.;

   rc = SetBranchableAttributes ( piBranchable3, mode, slack, length, bend_radius, diameter );
  
...</pre>
    </td>
  </tr>
</table>
<p>&nbsp;</p>
<p>CATIElecAttrAccess interface is used in SetBranchableAttributes ( internal
method ) to define bundle segment attribute values.</p>
<table class="code">
  <tr>
    <td>
      <pre>...

  HRESULT SetBranchableAttributes ( CATIEhiBranchable * piBranchable,
                                    CATUnicodeString &amp; mode, double &amp; slack, double &amp; length,
                                    double &amp; bend_radius, double &amp; diameter )
  {
     HRESULT rc = E_FAIL;
     //
     if (!piBranchable) return rc; // pointer not valuated : exit E_FAIL
     if ( mode != &quot;Slack&quot; &amp;&amp; mode != &quot;Length&quot; &amp;&amp; mode != &quot;Bend&quot; ) return rc; // invalid mode : exit E_FAIL
     // 
     CATBaseUnknown * pCurve = NULL;
     rc = piBranchable-&gt;GetElecCurve(&amp;pCurve); 
     if (FAILED(rc) || (NULL==pCurve)) return E_FAIL;

     //
     CATIElecAttrAccess * piElecAttr = NULL;
     rc = pCurve-&gt;QueryInterface(IID_CATIElecAttrAccess,(void**) &amp;piElecAttr );
     pCurve-&gt;Release();
     pCurve=NULL;
     if (FAILED(rc) || (NULL==piElecAttr)) return E_FAIL;

     //
     CATUnicodeString attribute;
     // --- set build mode 
     attribute = &quot;Elec_Creation_Mode&quot;;
     rc = piElecAttr-&gt;Set(attribute,mode);
     if (FAILED(rc))
     {
        piElecAttr-&gt;Release();
        piElecAttr=NULL; 
        return rc;
     }

     // --- build mode = &quot;Slack&quot; : set slack
     if ( mode == &quot;Slack&quot; )
     {
       attribute = &quot;Elec_Di_Slack&quot;;
       rc = piElecAttr-&gt;Set(attribute,slack);
       if (FAILED(rc))
       {
         piElecAttr-&gt;Release();
         piElecAttr=NULL; 
         return rc;
       }
     }
     //
     double val;
     // --- build mode = &quot;Length&quot;: set length
     if ( mode == &quot;Length&quot; )
     {
        val = length * 0.001;
        attribute = &quot;Elec_Length&quot;;
        rc = piElecAttr-&gt;Set(attribute,val);
        if (FAILED(rc))
        {
           piElecAttr-&gt;Release();
           piElecAttr=NULL; 
           return rc;
        }
     }
     // --- set bend radius
     attribute = &quot;Elec_Bend_Radius&quot;;
     val = bend_radius * 0.001;
     rc = piElecAttr-&gt;Set(attribute,val);
     //
     piElecAttr-&gt;Release();
     piElecAttr=NULL;
     if (FAILED(rc)) return rc;
     //
     // --- set diameter value
     CATListValCATBaseUnknown_var * pListOfBns = NULL; 
     rc = piBranchable-&gt;ListBundleSegments ( &amp;pListOfBns );

     if (SUCCEEDED(rc)) 
     {
        int nb_bns = pListOfBns?pListOfBns-&gt;Size():0;
        for ( int i=1; i&lt;=nb_bns; i++ )
        {
           if (NULL_var != (*pListOfBns)[i]) 
           { 
               rc = (*pListOfBns)[i]-&gt;QueryInterface(IID_CATIElecAttrAccess,(void**)&amp;piElecAttr);
               if (SUCCEEDED(rc) &amp;&amp; (NULL!=piElecAttr))
               {
                   attribute = &quot;Elec_Diameter&quot;;
                   val = diameter * 0.001;
                   rc = piElecAttr-&gt;Set(attribute,val);

                   piElecAttr-&gt;Release();
                   piElecAttr=NULL;
                   if (FAILED(rc)) break;
               }
           }
       }
    }
    delete pListOfBns;
    pListOfBns=NULL;
    //
    return rc; 
  }

...</pre>
    </td>
  </tr>
</table>
<p>&nbsp;</p>
<p><u>Fifth step is the definition of bundle route.</u></p>
<p>Using CATIGSMFactory, points are created in bundle segment part ( points
coordinates are given in MKS unit )</p>
<p>EhiRouteCurve is an sample internal method used to create points and add
point to bundle segment curve. Input of method is the bundle segment and the
coordinates of the points defining bundle segment route.</p>
<p>For example, here is the code to define the route of Branchable 1 :</p>
<table class="code">
  <tr>
    <td>
      <pre>...</pre>
      <pre> rc = piBranchable1-&gt;GetElecCurve(&amp;pRoute);
 

 rc = pRoute-&gt;QueryInterface(IID_CATIGSMSpline,(void**)&amp;pGSMSpline);

 //
 int nb_point = 2;
 double points[9];

 // +- P1
 points[0]=0.;
 points[1]=0;
 points[2]=0.;
 //
 // +- P2
 points[3]=0.;
 points[4]=200.;
 points[5]=0.; 

 rc = EhiRouteCurve (pGSMSpline, nb_point, points ); 
  
...</pre>
    </td>
  </tr>
</table>
<p>Bundle segment curve is retrieved using CATIEhiBranchable::GetElecCurve and
points are added to curve with CATIGSMSpline::AddPoint</p>
<table class="code">
  <tr>
    <td>
      <pre>...</pre>
      <pre>//
HRESULT EhiRouteCurve ( CATIGSMSpline* pGSMSpline, int nb_point, double* point_coord )
{
  //
  HRESULT rc = E_FAIL;
  //
  if (!pGSMSpline) return rc; // pointer not valuated : exit E_FAIL 
  if ( nb_point &lt; 2 ) return rc; // number of points &lt; 2 : exit E_FAIL;
  //
  //
  // -- retrieving container
  CATIContainer_var spCont; // the container 
  CATISpecObject_var spObj = pGSMSpline;
  if ( NULL_var != spObj ) spCont = spObj-&gt;GetFeatContainer();
  //
  // -- retrieving factories : 
  // - litteral feature factory
  // - GSM factory
  CATICkeParmFactory_var spCKEfacto = spCont; // litteral feature factory
  CATIGSMFactory_var spGSMfacto = spCont; // GSM factory
  if ( NULL_var == spCKEfacto || NULL_var == spGSMfacto )
  {
    return rc; // cannot retrieve factories : exit E_FAIL
  }

  // -- create and add points to curve
  // 
  CATICkeParm_var X;
  CATICkeParm_var Y; 
  CATICkeParm_var Z; 
  CATIGSMPointCoord_var spPoint;
  //
  for ( int i=1; i&lt;=nb_point; i++ )
  {
    //
    double unit = 0.001;
    double Px = unit * point_coord[ 3*(i-1)] ;
    double Py = unit * point_coord[1+3*(i-1)] ;
    double Pz = unit * point_coord[2+3*(i-1)] ;
    //
    X = spCKEfacto-&gt;CreateLength ( &quot;X&quot;, Px );
    Y = spCKEfacto-&gt;CreateLength ( &quot;Y&quot;, Py );
    Z = spCKEfacto-&gt;CreateLength ( &quot;Z&quot;, Pz );
    //
    spPoint = spGSMfacto-&gt;CreatePoint(X,Y,Z); 
    if ( NULL_var != spPoint ) // --- point created 
    { 
       CATIGSMProceduralView_var(spPoint)-&gt;InsertInProceduralView();
       CATISpecObject_var (spPoint)-&gt;Update(); // compute point geometry 
       // --- add constraint point to electrical curve
       pGSMSpline-&gt;Add(spPoint);
    }
  }
  //
  // -- update curve geometry
  spObj-&gt;Update();
  //
  rc = S_OK;
  //
  return rc; // exit S_OK;
}

...</pre>
    </td>
  </tr>
</table>
<p align="center">&nbsp;</p>
<p><u>Sixth step is the computation of bundle segment representation.</u></p>
<p>CATIEhiGeoBundle::ComputeMultiBranchable is used to compute bundle segment
shape ( part design RIB ). This method may be used to re-compute shape after
parameter modification.</p>
<table class="code">
  <tr>
    <td>
      <pre>...</pre>
      <pre>  //   + compute multi branchable
  //         
  rc = piGeoBundle-&gt;ComputeMultiBranchable ( piMultiBranchable );</pre>
      <pre> 
...</pre>
    </td>
  </tr>
</table>
<p align="center">&nbsp;</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<h4><a name="GetExtr_BNS"></a>Managing a multi branchable bundle segment.</h4>
<p>Some methods of CATIEhiBranchable interface are called in the sample, for
example GetMultiBranchable which returns the multi branchable from a branchable,
GetElecCurve which returns the electrical curve from a branchable or
ListBundleSegments which returns the list of bundle segments contained in a
branchable.</p>
<table class="code">
  <tr>
    <td>
      <pre>...</pre>
      <pre>   CATIEhiMultiBranchable* piMultiBranchableRead=NULL;
   rc = piBranchable1-&gt;GetMultiBranchable(&amp;piMultiBranchableRead);
...</pre>
    </td>
  </tr>
</table>
<p>Then, the method RemoveBranchable of CATIEhiMultiBranchable is used to delete
the third branch of the multi branchable.</p>
<table class="code">
  <tr>
    <td>
      <pre>...</pre>
      <pre>    rc = piMultiBranchable-&gt;RemoveBranchable(piBranchable3);
...</pre>
    </td>
  </tr>
</table>
<h4 align="center"><span style="font-weight: 400">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><img border="0" src="images/CAAEhi13.jpg" width="693" height="630"></h4>
<h4><span style="font-weight: 400">Above is a CATIA image showing the multi
branchable bundle segment after removing the third branch.</span></h4>
<p align="right">[<a href="#Top">Top</a>]</p>
<h4><a name="Close">Epilog</a></h4>
<p>The multi branchable bundle segement is saved first.</p>
<table class="code">
  <tr>
    <td>
      <pre>...</pre>
      <pre>  CATIProduct_var spMultiBranchableI = piMultiBranchable;
 
  CATIProduct_var spMultiBranchableR = spMultiBranchableI-&gt;GetReferenceProduct();

  CATILinkableObject_var spLinkable=spMultiBranchableR;

  CATDocument * pMultiBnsPartDoc = spLinkable-&gt;GetDocument(); </pre>
      <pre>  rc = CATDocumentServices::SaveAs (*pMultiBnsPartDoc , PathOutput+MultiBns1File );</pre>
      <pre>...</pre>
    </td>
  </tr>
</table>
<p>Then, the geometrical bundle and the main document are saved.</p>
<table class="code">
  <tr>
    <td>
      <pre>...</pre>
      <pre> rc = CATDocumentServices::SaveAs (*pGbnDoc , PathOutput+GbnFile );</pre>
      <pre> rc = CATDocumentServices::SaveAs (*pMainDoc , PathOutput+MainFile );


...</pre>
    </td>
  </tr>
</table>
<p>Document is removed and session is deleted before exit.</p>
<table class="code">
  <tr>
    <td>
      <pre>...</pre>
      <pre>rc = CATDocumentServices::Remove(*pGbnDoc);
...
rc = ::Delete_Session(sessionName);
...</pre>
    </td>
  </tr>
</table>
<p>[<a href="#Top">Top</a>]</p>
<p align="right">&nbsp;</p>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="InShort"></a>In Short</h3>
<p>This use case has demonstrated how to create and manage a multi branchable
bundle segment
<p>Following operations have been detailed is this use case :
<ul>
  <li>How to activate electrical environment using <code>Initialize </code>method
    of <i>CATIEleDocServices</i>.</li>
  <li>How to create a geometrical bundle using <code>CreateGeometricalBundle</code>
    method of <i>CATIEhiFactory.</i></li>
  <li>How to create a multi branchable bundle segment in the geometrical bundle
    using <code>CreateMultiBranchable</code> of <i>CATIEhiGeoBundle.</i></li>
  <li>How to add branches in a multi branchable bundle segment using <code>AddBranchable</code>
    of <i>CATIEhiMultiBranchable.</i></li>
  <li>How to manage attributes of bundle segment using <i>CATIElecAttrAccess </i>&nbsp;interface
    .</li>
  <li>How to route bundle segment using GSM interfaces.</li>
  <li>How to compute multi branchable bundle segment representation using <code>ComputeMultiBranchable</code>
    of <i>CATIEhiGeoBundle</i>.</li>
  <li>How to remove a branch of a multi branchable bundle segment using <code>RemoveBranchable</code>
    of <i>CATIEhiMultiBranchable.</i>.</li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="References"></a>References</h3>
<table width="1143">
  <tr>
    <td valign="top" width="75">[1]</td>
    <td width="1054"><a href="../CAAPstUseCases/CAAPstAddComponent.htm">Adding
      Components to a Product Structure</a></td>
  </tr>
  <tr>
    <td valign="top" width="75">[2]</td>
    <td width="1054"><a href="../CAADocUseCases/CAADocRunSample.htm">Building
      and Launching a CAA V5 Use Case</a></td>
  </tr>
  <tr>
    <td valign="top" width="75"></td>
    <td width="1054"></td>
  </tr>
  <tr>
    <td valign="top" align="right" colspan="2" width="1135">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="History"></a>History</h3>
<table width="100%">
  <tr>
    <td valign="top">Version: <strong>1</strong> [Jan 2003]</td>
    <td valign="top">Document created</td>
  </tr>
  <tr>
    <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<p><i>Copyright © 2002, Dassault Systèmes. All rights reserved.</i></p>

</body>

</html>
