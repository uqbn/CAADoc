<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<link rel="Stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css">
<title>Creating Features in an Applicative Container</title>
</head>

<body>

<table width="100%">
  <tr>
    <td valign="top">
      <h1>Equipment &amp; Systems</h1>
    </td>
    <td valign="top">
      <h2>Schematics Platform Modeler</h2>
    </td>
    <td rowspan="2" align="right" valign="top">
      <h3><a name="Top"></a>Creating Schematic Application Sample &quot;StartUp&quot; 
      objects</h3>
      <em>Working with Schematic Components</em></td>
  </tr>
  <tr>
    <td class="use" colspan="2">Use Case</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->

<table class="abstract">
  <tr>
    <td>
      <h3>Abstract</h3>
      <p>This article discusses the CAASchAppCreateCATfct use case.</p>
      <ul>
        <li><strong><a href="#Learn">What You Will Learn With This Use Case</a></strong></li>
        <li><a href="#UseCase"><strong>The CAASchAppCreateCATfct Use Case</strong></a>
          <ul>
            <li><a href="#What">What Does CAASchAppCreateCATfct Do</a></li>
            <li><a href="#How">How to Launch </a><a href="#What">
            CAASchAppCreateCATfct</a></li>
            <li><a href="#Where">Where to Find the  </a><a href="#What">
            CAASchAppCreateCATfct</a><a href="#Where"> Code</a></li>
          </ul>
        </li>
        <li><strong><a href="#Step">Step-by-Step</a></strong></li>
        <li><strong><a href="#InShort">In Short</a></strong></li>
        <li><strong><a href="#References">References</a></strong></li>
      </ul>
    </td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="Learn"></a>What You Will Learn With This Use Case</h3>
<p>This use case is intended to help you understand how to create the &quot;base 
features&quot;, or StartUps, of a typical schematic application. They are the base 
objects of schematic feature extensions used in sample programs to illustrate the 
implementations of schematic platform interfaces in this Framework.</p>
<p>[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h3><a name="UseCase"></a>The CAASchAppCreateCATfct Use Case</h3>
<p>CAASchAppCreateCATfct is a use case of the CAASchPlatformModeler.edu framework 
that illustrates the procedures to define &quot;base feature&quot; classes and their 
attributes. </p>
<p>[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="What"></a>What Does CAASchAppCreateCATfct Do</h4>
<p>The sample takes an input &quot;.CATfct&quot; file that contains the basic classes 
ASMPRODUCT, CONNECTOR, and CONNECTION. It then adds new sample schematic application 
classes (which are derived from the basic classes and shown in light blue in the diagram 
below) and attributes to the file and saves all the modification to a directory specified 
by the user.</p>
<table width="100%">
  <caption>Fig.1: Class hierarchy defined in the output CAASCHEDUApp.CATfct </caption>
  <tr>
    <td align="center"><img border="0" src="images/CAASchCATFct.gif" width="545" height="195"></td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="How"></a>How to Launch CAASchAppCreateCATfct</h4>
<p>To launch CAASchAppCreateCATfct, you will need to set up the build time
environment, then compile CAASchAppCreateCATfct along with its prerequisites, set up
the run time environment, and then execute the sample. This is fully described
in the referenced article [<a href="#References">1</a>]. When launching the use
case, you must pass the following arguments:</p>
<ul>
  <li><b>CAASCHEDUAppIn.CATfct</b> - the entire pathname, name and extension
    (.CATfct) of the input file. Normally, it should be stored in the CNext/resources/graphic file directory.</li>
  <li><b>CAASCHEDUApp.CATfct - </b>the entire pathname, name and extension (.CATfct) of the file
    to be generated by CAASchAppCreateCATfct.</li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Where"></a>Where to Find the CAASchAppCreateCATfct Code</h4>
<p>CAASchAppCreateCATfct code is located in the CAASchAppCreateCATfct.m use case module of
the CAASchPlatformModeler.edu framework:</p>
<table>
  <tr>
    <td>Windows</td>
    <td><code>InstallRootDirectory\CAASchPlatformModeler.edu\CAASchAppCreateCATfct.m</code></td>
  </tr>
  <tr>
    <td>Unix</td>
    <td><code>InstallRootDirectory/CAASchPlatformModeler.edu/CAASchAppCreateCATfct.m</code></td>
  </tr>
</table>
<p>where <code>InstallRootDirectory</code> is the root directory of your CAA V5
installation. The name of the source file is CAASchAppCreateCATfctMain.cpp.</p>
<p>Additional prerequisite code is located in the CAASchAppUtilities.m&nbsp; module of the same framework.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h3><a name="Step"></a>Step-by-Step</h3>
<p>There are 3 logical steps in CAASchAppCreateCATfct:</p>
<ol>
  <li><a href="#Prolog">Prolog</a></li>
  <li><a href="#AppReferenceObject">Add new classes and attributes&nbsp; </a></li>
  <li><a href="#Epilog">Epilog</a></li>
</ol>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Prolog"></a>Prolog</h4>
<p>In this use case, we open an input &quot;CATfct&quot; that contains the basic classes 
that our sample classes are to be derived from.&nbsp;Initializing the environment involves 
the following:</p>
<ul>
  <li>Creating a session, namely &quot;CAASchCreateCATfctMain_Session&quot;. This is fully 
      described in the referenced article [<a href="#References">2</a>].</li>
  <li>Deleting any existing output file from previous execution of this sample.</li>
  <li>Declaring the user client ID and using that in opening the &quot;CATfct&quot; document
      using the method <b>::UpgradeCatalog</b>, which allows the catalog to be upgraded. 
	  This method returns a CATICatalog pointer to the opened StartUp document.</li>
  <pre>
CATUnicodeString uClientId (SCHEDUAppClientID);
rc = ::UpgradeCatalog(&uCATFctToLoad, &piCatalog, &uClientId);
  </pre>
  </li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="AppReferenceObject"></a>Adding new classes and attributes</h4>
<p>Method <b>CAACreateBaseFeatureSU</b> is the main method that creates new classes and 
attributes for the sample application. The code can be divided into the following steps:</p>
<ul>
 <li><h4>Initializing a StartUp list</h4>
  <pre>CATListPtrCATBaseUnknown *pCAASUList = new CATListPtrCATBaseUnknown();</pre>
  <p>This list will contain a pointer to CATBaseUnknown for each created StartUp.</p>
 </li>
 <li><h4>Initializing StartUp class, super class, and name lists</h4>
  <pre>
...
CATListValCATUnicodeString CAALUClass;
CATListValCATUnicodeString CAALUSuperClass;
CATListValCATUnicodeString CAALUName;
//               class                              SuperClass 
CAALUClass.Append(SCHEDUClass_Part);      CAALUSuperClass.Append(SCHEDUClass_ASMPRODUCT);
...
CAALUName.Append(SCHEDUName_Part);
...
  </pre>
  <p>Three CATUnicodeString lists are created: the first for the StartUp class names, 
     the second for the StartUp superclass names, and the third for the StartUp names. 
     The indices of a given StartUp is the same in these three lists. 
     The CATUnicodeString classes are initiliazed in CAASchAppClassNames.h, located 
     in the PrivateInterfaces folder of CAASchPlatformModeler.edu framework.</p>
 </li>

 <li><h4>Creating the StartUps</h4>
  <pre>
...
CATBaseUnknown *pBU = NULL;
for (int iClass=1; iClass<=NbSizeClass; iClass++)
{ 
  rc =E_FAIL;
  pBU =NULL;
  CATUnicodeString uName       (CAALUName[iClass]);
  CATUnicodeString uClass      (CAALUClass[iClass]);
  CATUnicodeString uSuperClass (CAALUSuperClass[iClass]);
  if (uSuperClass.GetLengthInChar())
  {
    rc =iCatalog-><b>CreateSUInCatalog</b> (&pBU,               // Pointer to the created StartUp
                                      &uName,             // StartUp name
                                      &uClass,            // StartUp class name
                                      "CATISpecObject",   // Required CATISpecObject type
                                      &uSuperClass);      // StartUp super class name
  } 
  else
  {
    rc = iCatalog-><b>CreateSUInCatalog</b> (&pBU,
                                      &uName,
                                      &uClass,
                                      "CATISpecObject");
  }  
  if (SUCCEEDED(rc) && (NULL != pBU))
  { 
    pCAASUList->Append (pBU);
    ...
  </pre>
  <p>For each StartUp, the CATICatalog::<b>CreateSUInCatalog</b> method is called 
     from the CATICatalog pointer to the StartUp catalog. If the StartUp has 
     no super class, <b>CreateSUInCatalog</b> signature with four arguments is used. 
     When  the StartUp is successfully created, the retrieved pointer to that 
     StartUp is stored in the list for later use, such as adding attributes.</p>
 </li>

 <li><h4>Adding Attributes to one of the StartUps</h4>
  <pre>
...
int BUOfConnectorIndex = 7;
CATISpecObject *piSpecCntrSU = (CATISpecObject *) ((*pCAASUList)[BUOfConnectorIndex]);
CATISpecAttribute *piSpecAttr = NULL;
if (NULL != piSpecCntrSU)
{
  piSpecAttr = piSpecCntrSU-><b>AddAttribute</b> (SCHEDUATTR_Connector_FlowCapacity, // Attribute name
                                           tk_integer);                       // Attribute type
...
  </pre>
  <p>A CATISpecObject pointer is retrieved to the seventh created StartUp, 
     and the CATISpectObject::<b>AddArttribute</b> method is called to add a tk_integer 
     attribute. The attribute name is initialized in CAASchAppClassNames.h, 
     located in the PrivateInterfaces folder of CAASchPlatformModeler.edu framework.</p>
 </li>

 <li><h4>Cleaning-up</h4>
  <p>The pointers in the StartUp list are released and set to NULL, 
     and the list itself is deleted.</p>
 </li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Epilog"></a>Epilog</h4>
<p>The following steps conclude the use case:</p>
<ul>
  <li>Saving the modified/upgraded StartUp catalog &quot;CATfct&quot; by calling
      the SaveCatalog global function.
   <pre>rc = ::SaveCatalog (&piCatalog,&uCATFctToOutput);</pre>
  </li>
  <li>Deleting the created session &quot;CAASchCreateCATfctMain_Session&quot;. 
      This is described in the referenced article [<a href="#References">2</a>].</li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="InShort"></a>In Short</h3>
<p>This use case has demonstrated how to define new classes and attributes for a 
typical schematic application. </p>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="References"></a>References</h3>
<table width="100%">
  <tr>
    <td valign="top">[1]</td>
    <td><a href="../CAADocUseCases/CAADocRunSample.htm">Building
      and Launching a CAA V5 Use Case</a></td>
  </tr>
  <tr>
    <td valign="top">[2]</td> 
    <td><a href="../CAAOmbUseCases/CAAOmbLoadDoc.htm">Loading 
      a Document</a></td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="History"></a>History</h3>
<table width="100%">
  <tr>
    <td valign="top">Version: <strong>1</strong> [April 2004]</td>
    <td valign="top">Document created</td>
  </tr>
  <tr>
    <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<p><i>Copyright © 2000, Dassault Systèmes. All rights reserved.</i></p>

</body>

</html>
