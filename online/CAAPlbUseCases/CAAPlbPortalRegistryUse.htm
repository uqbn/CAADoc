<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<link rel="Stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css">
<title>Using the Portal Registry</title>
</head>

<body>

<table width="100%">
  <tr>
    <td valign="top">
      <h1>3D PLM Enterprise Architecture</h1>
    </td>
    <td valign="top">
      <h2>Webtop</h2>
    </td>
    <td rowspan="2" align="right" valign="top">
      <h3><a name="Top"></a>Using the Portal Registry</h3>
      <em>Using the registry of the Portal</em></td>
  </tr>
  <tr>
    <td class="use" colspan="2">Use Case</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->

<table class="abstract">
  <tr>
    <td>
      <h3>Abstract</h3>
      <p>This article shows how to use the Portal Registry</p>
      <ul>
        <li><a href="#Learn"><strong>What You Will Learn With This Use Case</strong></a></li>
        <li><a href="#UseCase"><strong>The PortalURLSnifferCATlet Use Case</strong></a>
          <ul>
            <li><a href="#What">What Does PortalURLSnifferCATlet Do</a></li>
            <li><a href="#How">How to Launch PortalURLSnifferCATlet</a></li>
            <li><a href="#Where">Where to Find the PortalURLSnifferCATlet Code</a></li>
          </ul>
        </li>
        <li><a href="#Step"><strong>Step-by-Step</strong></a></li>
        <li><a href="#InShort"><strong>In Short</strong></a></li>
        <li><a href="#References"><strong>References</strong></a></li>
      </ul>
    </td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->

<h3><a name="Learn"></a>What You Will Learn With This Use Case</h3>
<p>This use case is intended to show how to use the registry of the Portal.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h3><a name="UseCase"></a>The PortalURLSnifferCATlet Use Case</h3>
<p>The PortalURLSnifferCATlet is a use case of the CAAPortalBase.edu framework
that illustrates how an application of the Portal can use the PortalRegistry.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="What"></a>What Does PortalURLSnifferCATlet Do</h4>
<p>For this use case, the PortalURLSnifferCATlet implements the
PortalURLListener interface and so, listens to PortalURLEvent on the Hookup.
This CATlet listens to PortalURLEvents sent to the Portal desktop. For each
PortalURLEvent sent to the Portal, the CATlet displays information extracted of
the last PortalURL of the event, and of the PortalRegistry. Be careful, a CATlet
never need to listen PortalURLListener. The Portal desktop is the only one
component to listen this event. This use case do it only for showing a sample of
Portal registry use, and providing an application of PortalURL exchange
supervision in the Portal.</p>
<p>The PortalRegistry class is initialized with the MIMEtypes.xml file (and on
Windows, it is updated by the native registry). This file describes each MIME
Types recognized by the Portal. All the information contained in the MIME Type
structure is available by calls on the PortalRegistry class.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="How"></a>How to Launch PortalURLSnifferCATlet</h4>
<p>To launch the PortalURLSnifferCATlet, you will need to set up the build time
environment, then compile PortalURLSnifferCATlet along with its prerequisites,
set up the run time environment, and then execute the use case [<a href="#References">1</a>].</p>
<p>Specify the FilePrefix CAAPLB in the Portal launching command, logon to the
Portal and do the following steps:</p>
<ul>
  <li>Select the PortalURLSniffer Workbook. (If you already have a personal
    Workbook list customization and the PortalURLSniffer Workbook does not
    appear, then customize your personal Workbook list and add the
    PortalURLSniffer Workbook)</li>
  <li>Select the file tree Workbook.</li>
  <li>In the file tree, select a file document and send it to a viewer. A
    PortalURL on this file is created and sent to the Portal desktop and so to
    the viewer application. (See the PortalURL documentation [<a href="#References">2</a>])</li>
  <li>Reselect the PortalURLSniffer Workbook. It displays information of the
    last PortalURL sent.</li>
</ul>
<table>
  <tr>
    <td><b>Reselect the PortalURLSniffer Workbook</b></td>
  </tr>
  <tr>
    <td><img border="0" src="images/CAAPortalURLSniffer.jpg" width="1145" height="599"></td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="Where"></a>Where to Find the PortalURLSnifferCATlet Code?</h4>
<p>The PortalURLSnifferCATlet use case is located in the CAAPLBUrlSniffer.mj
module of the CAAPortalBase.edu framework: It prerequisites the two modules
PLBbase.mj and PLBtools.mj of the framework PortalBase.</p>
<table>
  <tr>
    <td>Windows</td>
    <td><code>InstallRootDirectory\CAAPortalBase.edu\CAAPLBUrlSniffer.mj\</code></td>
  </tr>
  <tr>
    <td>Unix</td>
    <td><code>InstallRootDirectory/CAAPortalBase.edu/CAAPLBUrlSniffer.mj/</code></td>
  </tr>
</table>
<p>where <code>InstallRootDirectory</code> is the directory where the CAA CD-ROM
is installed.</p>
<p align="right"><a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h3><a name="Step"></a>Step-by-Step</h3>
<p>This use case show how to use Portal Registry (and PortalURL) in order to
extract information on MIME Type, and associated command. This use case explains
3 different steps of the Portal registry use:</p>
<table>
  <tr>
    <th>#</th>
    <th>Step</th>
    <th>Where</th>
  </tr>
  <tr>
    <td valign="top"><a href="#Step1">1</a></td>
    <td valign="top">Get the MIME Type of a document by the PortalURL, or by the
      file extension</td>
    <td valign="top">PortalURLSnifferCATlet .java</td>
  </tr>
  <tr>
    <td valign="top"><a href="#Step2">2</a></td>
    <td valign="top">Get the command class and NLS name associated with a MIME
      Type</td>
    <td valign="top">PortalURLSnifferCATlet .java</td>
  </tr>
  <tr>
    <td valign="top"><a href="#Step3">3</a></td>
    <td valign="top">Get the command instances name for a MIME Type</td>
    <td valign="top">PortalURLSnifferCATlet .java</td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step1"></a>Getting the MIME Type of a Document</h4>
<p>The PortalURLSnifferCATlet class implements the PortalURLListener interface,
so receives PortalURLEvent and extracts of it the MIME Type information as
follows:</p>
<table class="code">
  <tr>
    <td>
      <pre>package com.dassault_systemes.portalbase.caa.catlet;
...
public class PortalURLSnifferCATlet extends CATlet
                                    implements PortalURLListener

{
  ...
 /**
  * Implementation of the PortalURLListener interface
  */
  public void portalURLSelected(PortalURLEvent event)
  {
    ...
    <b>PortalURL url</b> = event.getPortalURL(nbElement-1);

    // --- extract the MIME Type value of the PortalURL
    String mimeType = <b>url.getMIMEType();</b>
    ...
    // --- extracts the MIME Type value of the document by the extension of the file
    // --- first gets the data extension of the document content in the url
    String extension = url.getDataExtension();
    if (extension != null)
    {
      // --- get the PortalMIMETypes defined in the registry for the specified extension
      <b>PortalMIMETypes portalMIMETypes</b> = <b>PortalRegistry.getMIMETypesForExtension(extension);</b>

      if (portalMIMETypes != null)
      {
	     String mimeTypeExt = <b>portalMIMETypes.getType()</b>;
        ...
      }
    }
  ...
  }
...
}</pre>
    </td>
  </tr>
</table>
<p>The <i>PortalURLSnifferCATlet</i> class implements the <i>PortalURLListener</i>
interface. In the method <i>portalURLSelected</i> and, the CATlet reads the last
<i>PortalURL</i> of the <i>PortalURLEvent</i> in order to extract information on
the MIME Type of the document. The <i>PortalURL</i> class implements a method <i>getMIMEType</i>
which returns directly the MIME Type of the document refer to the url. An other
way to find the MIME Type of a document, is to use the file extension and to
call the <i>getMIMETypesForExtension </i>method of the PortalRegistry class (as
the Windows registry).</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="Step2"></a>Getting the Command Associated with a MIME Type</h4>
<p>The PortalURLSnifferCATlet gets the command class name and the NLS command
name associated to the PortalURL as follows:</p>
<table class="code">
  <tr>
    <td>
      <pre>package com.dassault_systemes.portalbase.caa.catlet;
...
public class PortalURLSnifferCATlet extends CATlet
                                    implements PortalURLListener

{
  ... 
 /**
  * Implementation of the PortalURLListener interface
  */
  public void portalURLSelected(PortalURLEvent event)
  {
    ...
    <b>PortalURL url</b> = event.getPortalURL(nbElement-1);

    // --- extracts the MIME Type value of the PortalURL
    String mimeType = url.getMIMEType();
    // --- gets the command name associated with this url, otherwise set it to the default one
    String cmdDesc = url.getCommandName();
    if (cmdDesc == null) cmdDesc = PortalMIMECommand.DEFAULT_DESCRIPTION;

    // --- gets the PortalMIMECommand defined in the registry for the specified mimeType and description
    <b>PortalMIMECommand mimeCmd = PortalRegistry.getMIMECommandForType(mimeType, cmdDesc);</b>

    if (mimeCmd != null)
    {
      // --- gets the value of the command class name 
      String commandClassName = <b>mimeCmd.getCommandName()</b>;
      // --- gets the NLS command name
      String nlsCmdName = <b>mimeCmd.getNLSName();</b>
    }
  ...
  }
...
}</pre>
    </td>
  </tr>
</table>
<p>In the MIME Type structure is defined different commands. Each command has a
unique name which can be used for the selection of the destination command of a
document. The command description name &quot;default&quot; is reserved by the
Portal. It specifies that the associated command is the default one used when no
command are specified in the PortalURL query.</p>
<p>The method <i>getMIMECommandForType</i> of the <i>PortalRegistry</i> returns
the <i>PortalMIMECommand</i> defined in the MIME Type <i>mimeType</i> with the
command name <i>cmdDesc</i>. The PortalMIMECommand class contains the class name
or the url of the command, the description of the command and the NLS name.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="Step3"></a>Getting the Command Instance Names of a MIME Type</h4>
<p>The PortalURLSnifferCATlet gets the instance names of all the commands
already instantiated for the MIME Type and command description as follows:</p>
<table class="code">
  <tr>
    <td>
      <pre>package com.dassault_systemes.portalbase.caa.catlet;
...
public class PortalURLSnifferCATlet extends CATlet
                                    implements PortalURLListener

{
  ...
 /**
  * Implementation of the PortalURLListener interface
  */
  public void portalURLSelected(PortalURLEvent event)
  {
    ...
    <b>PortalURL url</b> = event.getPortalURL(nbElement-1);

    // --- extracts the MIME Type value of the PortalURL
    String mimeType = url.getMIMEType();
    // --- gets the command name associated with this url, otherwise set it to the default one
    String cmdDesc = url.getCommandName();
    if (cmdDesc == null) cmdDesc = PortalMIMECommand.DEFAULT_DESCRIPTION;
    ...
    // --- gets the instances name of all the commands already launched 
    // --- and which are defined in the registry for the specified mimeType and cmdDesc
    <b>String[] instanceNames = PortalRegistry.getInstancesNameForType(mimeType, cmdDesc);</b>
    ...
    }
  ...
}</pre>
    </td>
  </tr>
</table>
<p>The <i>PortalRegistry</i> class returns an array of instance names of the
command defined in the MIME Type <i>mimeType</i> with the command name <i>cmdDesc</i>.
If a null command description is specified in the method then the <i>PortalRegistry</i>
returns an array of all the instance names of all the commands defined in this
MIME Type <i>mimeType</i>.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<!---------------------------------comment------------------------------------->

<h3><a name="InShort"></a>In Short</h3>
<p>The PortalRegistry class implements methods which allow the access to the
MIME Type information contained in the MIMEtypes.xml file. For instance, it
enables you to find the command associated with a MIME Type by the document
extension or by the MIME Type name.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<!---------------------------------comment------------------------------------->

<h3><a name="References"></a>References</h3>
<table width="100%">
  <tr>
    <td valign="top">[1]</td>
    <td>Building and Launching a CAA Enovia V5 Use Case</td>
  </tr>
  <tr>
    <td valign="top">[2]</td>
    <td><a href="../CAAPlbTechArticles/CAAPlbPortalURI.htm">The
      PortalURL</a></td>
  </tr>
  <tr>
    <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="History"></a>History</h3>
<table width="100%">
  <tr>
    <td valign="top">Version: <strong>1</strong> [Jan 2000]</td>
    <td valign="top">Document created</td>
  </tr>
  <tr>
    <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<p><i>Copyright © 2000, Dassault Systèmes. All rights reserved.</i></p>

</body>

</html>
