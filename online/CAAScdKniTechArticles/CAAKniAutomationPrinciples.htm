<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<link rel="stylesheet" type="text/css" href="../CAAScrBase/caav5.css">
<title>Knowledge Advisor Overview</title>
</head>

<body>

<table border="0" width="100%">
  <tr>
    <td>
      <h2>Automation</h2>
    </td>
    <td align="right" valign="top">
      <h2><a name="Top"></a>Knowledge Advisor Overview</h2>
    </td>
  </tr>
</table>
<hr>
<p>This article provides the basis for understanding how to create macros using
knowledgeware features. These<br>
knowledgeware features are supplied in the Infrastructure product (parameters,
formulas and design tables) as<br>
well as in the Knowledge Advisor product (rules and checks).</p>
<p>The CATIA Knowledge Advisor automation objects are those whereby you can
create and manipulate the knowledgeware features in a script. These automation
objects can be divided into two categories:</p>
<ol>
  <li>
    <p>The objects which provide you with the creation methods. They are the <i>Relations</i>
    and <i>Parameters</i> collections. These objects are only implemented on
    CATPart documents.</li>
  <li>
    <p>The knowledgeware objects whereby you can manipulate the Parameter,
    Formula, Rule, Check and&nbsp; Design Table features once they have been
    created. The hierarchy of these objects is described in the <a href="CAAKniTocParameter.htm">Parameter</a>
    and <a href="CAAKniTocRelation.htm">Relation</a> tree structures.</li>
</ol>
<p>The Use Cases provided as samples are fully commented and should help you
understand how to<br>
proceed to write simple macros as well as fully-fledged macros manipulating
knowledgeware features.</p>
<h3>Creating Knowledgeware Objects</h3>
<p>The entry point is the Relations or Parameters collection. To retrieve the
appropriate collection, you must: retrieve the Part object of the active
document. This Part object aggregates all the objects making up the CATPart: the
Bodies, the Relations, the Parameters to name but a few. Mull over the Part
properties, they all provide you with collections or factories to create
objects.</p>
<p>You can retrieve a Parameters object that way:</p>
<pre>Dim oActiveDoc As Document 
Set oActiveDoc = CATIA.ActiveDocument 

Dim oParams As Parameters 
Set oParams = oActiveDoc.Part.Parameters </pre>
<p>but prior to writing this, you must check that your document is a CATPart.</p>
<p>To create the object, you just have to use the appropriate Create<i>xxx </i>method.</p>
<pre>Dim oSphereRadius As Parameter 
Set oSphereRadius = oParameters.CreateInteger(&quot;StringLength&quot;,0) </pre>
<h3>Scanning the Knowledgeware Objects in their Collections</h3>
<p>Parameters as well as Relations can be scanned in their collections. An item
is retrieved from its collection using the <b>Item</b> method and the index of
the item in the collection. Usually, the argument representing the index in the <b>Item</b>
method is a Variant. This means that it can either represent the rank of the
item in the collection or the name you assigned to this item using the <b>Name</b>
property. The rank in a collection begins at 1. For example, assume that the
Parameter named &quot;StringLength&quot; is the sixth parameter in the
Parameters collection. To retrieve this parameter in the oParameters collection,
write:</p>
<pre>Dim oParam1 As Parameter
Set oParam1 = oParams.Item(6)</pre>
<p>or write:</p>
<pre>Dim oParam1 As Parameter
Set oParam1 = oParams.Name(&quot;StringLength&quot;)</pre>
<p>Each collection has a <b>Count</b> property that holds the number of items in
the collection. This is a handy property to scan the whole collection.</p>
<p><i><b>Warning</b></i></p>
<p>When counting the items in a Parameters collection, mind that you count all
the document parameters and not only the user parameters.</p>
<h3>Manipulating Knowledgeware Objects</h3>
<p>After they have been created, knowledgeware objects are managed through their
properties and methods. To find out what they are, see the <a href="#" onclick="javascript:CAAlink('IDL', 'KnowledgeInterfaces'); return false;">Knowledge
Advisor Automation API Reference</a>.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<!----------------------------------comment------------------------------------->

<p><i>Copyright © 1994-2004, Dassault Systèmes. All rights reserved.</i></p>

</body>

</html>
