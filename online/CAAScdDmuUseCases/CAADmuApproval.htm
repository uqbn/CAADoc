<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>Creating an Approbation Stamp</title>
<link rel="stylesheet" type="text/css" href="../CAAScrBase/caav5.css">
<script language="JavaScript" src="../CAAScrJavaScript/submit.js"></script>
</head>

<body>

<table border="0" width="100%">
  <tr>
    <td>
      <h2>DMU Navigator</h2>
    </td>
    <td align="right" valign="top">
      <h2><a name="Top"></a>Creating an Approbation Stamp</h2>
    </td>
  </tr>
</table>
<hr>
<! ---------------------------------comment------------------------------------->
<table border="0" width="100%">
  <tr>
    <td valign="top"><img border="0" src="../CAAScrBase/images/atarget.gif" height="32"></td>
    <td>
      <p><a name="Learn"></a>This macro shows you how to use annotated views and
      marker2Ds, to approve a given state of a product. This approbation is
      officialized by a stamp in a corner of the viewer. The macro assumes that
      a CATProduct has been loaded.</p>
      <! ---------------------------------comment------------------------------------->
      <p>This approbation stamp &quot;ACME, Approved by John Smith, 1/31/01
      2:32:04 PM&quot; can be seen in the bottom-right of the image :</p>
      <p align="center"><img border="0" src="images/CAADmuApproval1-sm.gif"></p>
      <p>&nbsp;</p>
    </td>
  </tr>
  <tr>
    <td valign="top"><img border="0" src="../CAAScrBase/images/ainfo.gif" height="32"></td>
    <td>
      <p><a name="How"></a>CAADmuApproval is launched in CATIA [<a href="#References">1</a>].
      A previously opened document is needed.</p>
      <p><a href="CAADmuApprovalSource.htm" target="Source">CAADmuApproval.CATScript</a>
      is located in the CAAScdDmuUseCases module. <a href="macros/CAADmuApproval.CATScript">Execute
      macro</a> (Windows only).</p>
      <p>&nbsp;</p>
    </td>
  </tr>
  <tr>
    <td valign="top"><img border="0" src="../CAAScrBase/images/ascenari.gif" height="32"></td>
    <td>
      <p><a name="Step"></a>CAADmuApproval includes six steps:</p>
      <ol>
        <li><a href="#Prolog">Prolog</a></li>
        <li><a href="#Name">Acquisition of the responsible's name</a></li>
        <li><a href="#AnnotatedView">Creation of the annotated view</a></li>
        <li><a href="#Text">Creation of the text</a></li>
        <li><a href="#Frame">Creation of the frame</a></li>
        <li><a href="#Apply">Application of the view</a></li>
      </ol>
      <! ---------------------------------comment------------------------------------->
      <h4><a name="Prolog"></a>Prolog</h4>
      <p>Some constants are initialized : they describes the relative
      positioning of the different markers.</p>
      <! ---------------------------------comment------------------------------------->
      <h4><a name="Name"></a>Acquisition of the responsible's name</h4>
      <p>A variable is defined for the <i>responsible</i> name.&nbsp; The <i>InputBox</i>
      function asks the user to enter it's name string whose default value will
      be &quot;John Smith&quot;.&nbsp;</p>
      <p align="center"><img border="0" src="images/CAADmuApproval2-sm.gif"></p>
      <! ---------------------------------comment------------------------------------->
      <h4><a name="AnnotatedView"></a>Creation of the annotated view</h4>
      <p>The <i>cAnnotatedViews</i> collection (see <code><a href="#" onclick="javascript:CAAlink('IDL', 'NavigatorInterfaces', 'AnnotatedViews'); return false;">AnnotatedViews</a></code>
      ) is the factory to create <i>oAnnotatedView</i> object (see <code><a href="#" onclick="javascript:CAAlink('IDL', 'NavigatorInterfaces', 'AnnotatedView'); return false;">AnnotatedView</a></code>
      ) : this collection is retrieved using the <code><a href="#" onclick="javascript:CAAlink('IDL', 'ProductStructureInterfaces', 'Product', 'GetTechnologicalObject'); return false;">GetTechnologicalObject</a></code>
      method, with the string <code>&quot;AnnotatedViews&quot;</code>, on the
      root product of the active document.</p>
      <p><code><a href="#" onclick="javascript:CAAlink('IDL', 'NavigatorInterfaces', 'AnnotatedViews', 'Add'); return false;">Add</a></code>
      method is used on the <i>cAnnotatedViews</i> collection to create the <i>oAnnotatedView</i>
      object.</p>
      <! ---------------------------------comment------------------------------------->
      <h4><a name="Text"></a>Creation of the text</h4>
      <p>The <i>oAnnotatedView</i> object enables the creation of markers thru <i>cMarker2Ds</i>
      collection (see <code><a href="#" onclick="javascript:CAAlink('IDL', 'NavigatorInterfaces', 'Marker2Ds'); return false;">Marker2Ds</a></code>
      ): this collection is retrieved using the <code><a href="#" onclick="javascript:CAAlink('IDL', 'NavigatorInterfaces', 'AnnotatedView', 'Marker2Ds'); return false;">Marker2Ds</a></code>
      method on the <i>oAnnotatedView</i> object.</p>
      <p>The string of the approval text,&quot;ACME, Approved by John Smith,
      1/31/01 2:32:04 PM&quot;, is built using standard script features and the <i>responsible</i>
      name.</p>
      <p>Its position is computed to fit with the bottom-right position
      specification.</p>
      <p>The text, a <i>oMarker2DText</i> object (see <code><a href="#" onclick="javascript:CAAlink('IDL', 'NavigatorInterfaces', 'Marker2D'); return false;">Marker2D</a></code>
      ), is created using the <code><a href="#" onclick="javascript:CAAlink('IDL', 'NavigatorInterfaces', 'Marker2Ds', 'Add2DText'); return false;">Add2DText</a></code>
      method on the <i>cMarker2Ds</i> collection giving the position and the
      string.</p>
      <p align="center"><img border="0" src="images/CAADmuApproval3-sm.gif"></p>
      <! ---------------------------------comment------------------------------------->
      <h4><a name="Frame"></a>Creation of the frame</h4>
      <p>The position of the frame is computed to order to fit with the text.</p>
      <p>The frame, a <i>oMarker2DRectangle</i> object (see <code><a href="#" onclick="javascript:CAAlink('IDL', 'NavigatorInterfaces', 'Marker2D'); return false;">Marker2D</a></code>
      ), is created using the <code><a href="#" onclick="javascript:CAAlink('IDL', 'NavigatorInterfaces', 'Marker2Ds', 'Add2DRectangle'); return false;">Add2DRectangle</a></code>
      method on the <i>cMarker2Ds</i> collection giving the position.</p>
      <p align="center"><img border="0" src="images/CAADmuApproval4-sm.gif"></p>
      <! ---------------------------------comment------------------------------------->
      <h4><a name="Apply"></a>Application of the view</h4>
      <p>The annotated view is updated, in order to keep all modifications,
      using the <code><a href="#" onclick="javascript:CAAlink('IDL', 'NavigatorInterfaces', 'AnnotatedView', 'Update'); return false;">Update</a></code>
      method of the <i>oAnnotatedView</i> object.</p>
      <p>The <code><a href="#" onclick="javascript:CAAlink('IDL', 'NavigatorInterfaces', 'NavigatorWorkbench', 'View'); return false;">View</a></code>
      command is used to apply the <i>oAnnotatedView</i> object to the current
      viewer : it enables the display of the view and it's markers. This command
      is available on the <i>NavigatorWorkbench</i> object(see <code><a href="#" onclick="javascript:CAAlink('IDL', 'NavigatorInterfaces', 'NavigatorWorkbench'); return false;">NavigatorWorkbench</a></code>
      ) which can be retrieved using the <code><a href="#" onclick="javascript:CAAlink('IDL', 'InfInterfaces', 'Document', 'GetWorkbench'); return false;">GetWorkbench</a></code>
      method with the string <code>&quot;NavigatorWorkbench&quot;</code>, on the
      active document.</p>
    </td>
  </tr>
</table>
<! ---------------------------------comment------------------------------------->
<p align="center"><img border="0" src="../CAAScrBase/images/aendtask.gif" height="32"></p>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<! ---------------------------------comment------------------------------------->
<h4><a name="InShort"></a>In Short</h4>
<p>This use case has shown how to use annotated views and markers in order to
build an approbation stamp. Specifically, it has illustrated how to :</p>
<ul>
  <li>create an annotated view</li>
  <li>retrieve the markers' collection</li>
  <li>create text and figure markers</li>
  <li>visualize an existing annotated view</li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<! ---------------------------------comment------------------------------------->
<h4><a name="References"></a>References</h4>
<table border="0" width="100%">
  <tr>
    <td valign="top">[1]</td>
    <td><a href="../CAAScdInfUseCases/CAAInfLauchMacro.htm">Replaying
      a macro</a></td>
  </tr>
  <tr>
    <td valign="top">[2]</td>
    <td><a href="../CAAScdDmuTechArticles/CAADmuTocDMU.htm">DMU
      Navigator automation objects</a></td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<p align="center"><a href="../CAAScdBase/CAADmuScriptHome.htm">DMU
Navigator Home</a> <a href="../CAAScdBase/CAASpaScriptHome.htm">DMU
Space Analysis Home</a> <a href="../CAAScdBase/CAAKiiScriptHome.htm">DMU
Kinematics Simulation Home</a></p>
<! ---------------------------------comment------------------------------------->
<p><i>Copyright © 2001, Dassault Systèmes. All rights reserved.</i></p>

</body>
