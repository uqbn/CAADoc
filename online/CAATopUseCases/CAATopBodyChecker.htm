<html>

 <head>
 <meta http-equiv="Content-Language" content="en-us">
 <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
 <meta name="GENERATOR" content="Microsoft FrontPage 5.0">
 <meta name="ProgId" content="FrontPage.Editor.Document">
 <link rel="Stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css">
 <title>Creating a Multi Patch NURBS Surface</title>
 </head>

 <body>

 <table width="100%">
   <tr>
     <td valign="top">
     <h1>Geometric Modeler</h1>
     </td>
     <td valign="top">
     <h2>Topology</h2>
     </td>
     <td rowspan="2" align="right" valign="top">
     <h3><a name="Top"></a>Using the Body Checker</h3>
     <p><em>How to check the validity of a surface </em></td>
   </tr>
   <tr>
     <td class="use" colspan="2">Use Case</td>
   </tr>
 </table>
 <hr>
 <!---------------------------------comment------------------------------------->
 <table class="abstract">
   <tr>
     <td>
     <h3>Abstract</h3>
     <p>A CGM surface which exhibits curvature radii less than the resolution is 
     not valid. The &quot;Body Checker&quot; can be used to determine whether a surface is 
     valid with respect to this criteria.&nbsp; </p>
     <ul>
       <li><a href="#Learn"><strong>What You Will Learn With This Use Case</strong></a></li>
       <li><a href="#UseCase"><strong>The CAATopBodyChecker Use Case</strong></a>
       <ul>
         <li><a href="#What">What Does CAATopBodyChecker Do?</a></li>
         <li><a href="#How">How to Launch CAATopBopdyChecker</a></li>
         <li><a href="#Where">Where to Find the CAATopBodyChecker Code</a></li>
       </ul>
       </li>
       <li><a href="#Step"><strong>Step-by-Step</strong></a></li>
       <li><a href="#References"><strong>References</strong></a></li>
     </ul>
     </td>
   </tr>
 </table>
 <hr>
 <!---------------------------------comment------------------------------------->
 <h3><a name="Learn"></a>What You Will Learn With This Use Case</h3>
 <p>This use case is intended to help you determine whether a surface is valid 
 in terms of curvature radius. This is done by using the CATBodyChecker.h 
 interface. Today, the rule to check whether a shell self-intersects is not 
 implemented yet (see the interface documentation in the encyclopedia).</p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <!---------------------------------comment------------------------------------->
 <!---------------------------------comment------------------------------------->
 <h3><a name="UseCase"></a>The CAATopBodyChecker Use Case</h3>
 <p>CAATopBodyChecker is a use case of the CAATopologicalOperators.edu framework 
 that illustrates the TopologicalOperators framework capabilities.</p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="What"></a>What Does CAATopBodyChecker Do?</h4>
 <p>The CAATopBodyChecker use case:</p>
 <ul>
   <li>loads the container and retrieves the body to be checked</li>
   <li>creates and uses the body checker</li>
   <li>displays the diagnosis</li>
   <li>closes the container.</li>
 </ul>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="How"></a>How to Launch CAATopBodyChecker</h4>
 <p>To launch CAATopBodyChecker , you will need to set up the build time 
 environment, then compile CAATopBodyChecker .m along with its prerequisites, 
 set up the run time environment, and then execute the use case [<a href="#References">1</a>].</p>
 <font face="Helv" size="2" color="#000000"></font>
 <font face="Courier New" size="2" color="#000000">
 <p>With Windows CAATopBodyChecker <code>e:\bodyChecker1.NCGM</code></p>
 <p>With UNIX CAATopBodyChecker <code>/u/bodyChecker1.NCGM</code></p>
 </font><font color="#000000" face="Times New Roman">
 <p>where </font><font face="Times New Roman">bodyChecker1.NCGM is the input 
 file delivered in the CAATopologicalOperators.edu/FunctionTests/InputData file.</font>
 </font></p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="Where"></a>Where to Find the CAATopBodyChecker Code</h4>
 <p>The CAATopBodyChecker use case is made of a main named CAATopBodyChecker 
 .cpp located in the CAATopBodyChecker .m module of the 
 CAATopologicalOperators.edu framework:</p>
 <table>
   <tr>
     <td>Windows</td>
     <td><code>InstallRootDirectory\CAATopologicalOperators.edu\</code>CAATopBodyChecker
     <code>.m\</code></td>
   </tr>
   <tr>
     <td>Unix</td>
     <td><code>InstallRootDirectory/CAATopologicalOperators.edu/</code>CAATopBodyChecker
     <code>.m/</code></td>
   </tr>
 </table>
 <p>where <code>InstallRootDirectory</code> is the directory where the CAA 
 CD-ROM is installed.</p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h3><a name="Step"></a>Step-by-Step</h3>
 <p>There are thee main steps in CAATopBodyChecker.cpp: </p>
 <ol>
   <li><a href="#Creates the Geometry Factory">Loading the container and 
   retrieving the body to be checked</a></li>
   <li><a href="#KV">Creating the CATBodyChecker object </a></li>
   <li><a href="#Displaying the Diagnosis">Displaying the diagnosis</a></li>
   <li><a href="#Writes the Model and Closes the Factory">Closing the container</a></li>
 </ol>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="Creates the Geometry Factory"></a>Loading the container and 
 retrieving the body to be checked</h4>
 <p>The geometry factory (CATGeoFactory) creates and manages all the 
 CATICGMObject (and the curves and surfaces in particular). In this use case, 
 the factory is defined by reading a NCGM file that was previously stored,&nbsp; 
 the global function <code>::CATLoadCGMContainer</code> must be used to retrieve 
 the factory. The body is retrieved by using the 
 CATICGMContainer::FindObjectFromTag method. There is only one body in the 
 container which is loaded. 2353356 is the body tag.</p>
 <table class="code">
   <tr>
     <td>
     <pre>CATGeoFactory* piGeomFactory = CATLoadCGMContainer(filetoread);
...
CATICGMObject * piCGMObj1 = piGeomFactory-&gt;FindObjectFromTag(2353356); </pre>
     </td>
   </tr>
 </table>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="KV">Creating and Running the CATBodyChecker</a></h4>
 <p>The CATBodyChecker object is created by using the CATBodyChecker::Create 
 static function. To activate all the checker rules, you must specify the
 <font face="Courier New">BodyChkModeFull</font> mode. So far, only the check of 
 the curvature radius is implemented for curves and surfaces.</p>
 <table class="code">
   <tr>
     <td>
     <pre>CATBodyChecker * pBodyChecker = CATBodyChecker::Create(piGeomFactory, &amp;topdata, piBodyToBeChecked);
<font color="#008000">//
// b - Specify the Full Mode</font>
if (NULL != pBodyChecker)
{
CATBodyChecker::CheckMode eChkMode = CATBodyChecker::BodyChkModeFull;
pBodyChecker-&gt;SetCheckMode(eChkMode);
<font color="#008000">//
// c - Run the operator</font>
CATBoolean bRet = FALSE;
bRet = pBodyChecker-&gt;Run();
....</pre>
     </td>
   </tr>
 </table>
 <p align="right">[<a href="#Top">Top</a>] </p>
 <h4><a name="Displaying the Diagnosis">Displaying the Diagnosis</a></h4>
 <p>All the errors found in the body to be checked are displayed if you have 
 specified the Full Mode. If the light mode is specified, several errors of the 
 same type can be diagnosed.</p>
 <table class="code" width="730">
   <tr>
     <td width="724">
     <pre>pBodyChecker-&gt;BeginningDiagnosis();
while( pBodyChecker-&gt;NextDiagnosis() )
{
CATUnicodeString strDiagnosis;
pBodyChecker-&gt;GetDiagnosis(strDiagnosis);

cout &lt;&lt; strDiagnosis.ConvertToChar() &lt;&lt; endl;
}</pre>
     </td>
   </tr>
 </table>
 <p>This is the message which is displayed on the standard output at execution:</p>
 <p><font face="Courier New"><span style="background-color: #C0C0C0">
 CATTabulatedCylinder[2353360] : Surface has invalid curvature<br>
 Invalid curvature radius found = 0.000403962 &lt;= Allowed [0.001]<br>
 At surface parameter = (PatchU=48, ParamU=373.951; PatchV=1, ParamV=0)</span></font></p>
 <p>&nbsp;</p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="Writes the Model and Closes the Factory"></a>Closing the Factory</h4>
 <p>The use case ends with the closure of the geometry factory, done by the <tt>
 ::CATCloseCGMContainer</tt> global function.</p>
 <table class="code">
   <tr>
     <td>
     <pre> <em>//
 // Closes the container
 //</em>	
 <strong>::CATCloseCGMContainer</strong>(piGeomFactory);</pre>
     </td>
   </tr>
 </table>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <hr>
 <!---------------------------------comment------------------------------------->
 <!---------------------------------comment------------------------------------->
 <h3><a name="References"></a>References</h3>
 <table width="100%">
   <tr>
     <td>[1]</td>
     <td>
     <a href="../CAADocUseCases/CAADocRunSample.htm">
     Building and Launching a CAA V5 Use Case</a></td>
   </tr>
   <tr>
     <td>[2]</td>
     <td><a href="CAATopOverview.htm">Overview of the Topological Operators</a></td>
   </tr>
 </table>
 <table width="100%">
   <tr>
     <td valign="top" align="right">[<a href="#Top">Top</a>]</td>
   </tr>
 </table>
 <hr>
 <!---------------------------------comment------------------------------------->
 <h3><a name="History"></a>History</h3>
 <table width="100%">
   <tr>
     <td valign="top">Version: <strong>1</strong> [Aug 2004]</td>
     <td valign="top">Document created</td>
   </tr>
   <tr>
     <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
   </tr>
 </table>
 <hr>
 <!---------------------------------comment------------------------------------->
 <p><i>Copyright © 2004, Dassault Systèmes. All rights reserved.</i></p>

 </body>

</html>
