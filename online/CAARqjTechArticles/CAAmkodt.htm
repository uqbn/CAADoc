<html>

<head>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 6.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<link rel="Stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css">
<title>Java Test Objects and the mkodt Command</title>
</head>

<body>

<table width="100%">
  <tr>
    <td valign="top">
      <h1>RADE</h1>
    </td>
    <td valign="top">
      <h2>Java Unit Test Manager</h2>
    </td>
    <td rowspan="2" align="right" valign="top">
      <h3><a name="Top"></a>Java Test Objects and the mkodt Command</h3>
      <em>Principles of use</em></td>
  </tr>
  <tr>
    <td class="tech" colspan="2">Technical Article</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->

<table class="abstract">
  <tr>
    <td>
      <h3>Abstract</h3>
      <p>This article explains the basic principles of java test objects. You
      will find here everything to understand the test file tree and to create
      and to run your java test objects.</p>
      <ul>
        <li><a href="#What"><b>What You Will Learn with This Article</b></a></li>
        <li><a href="#mkodt command"><b>The mkodt Command</b></a>
          <ul>
            <li><a href="#Test file tree">Test File Tree</a></li>
            <li><a href="#Options available on mkodt">Options Available with
              mkodt</a></li>
            <li><a href="#Environment variable evaluated by user">Environment
              Variables Evaluated by mkodt</a></li>
            <li><a href="#Environment variables evaluated by mkodt">Environment
              Variables Evaluated by the User</a></li>
            <li><a href="#Test results : mkodt output">Test Results: mkodt
              Output</a></li>
          </ul>
        </li>
        <li><a href="#Test shell script creation"><b>Test Shell Script Creation</b></a>
          <ul>
            <li><a href="#Available commands in a test shell scriptj">Available
              Commands in a Test Shell Script</a>
              <ul>
                <li><a href="#SetOdtParam">SetOdtParam</a></li>
                <li><a href="#WhichDir">WhichDir</a></li>
                <li><a href="#ODTInit">ODTInit</a></li>
                <li><a href="#JavaReplay">JavaReplay</a></li>
              </ul>
            </li>
            <li><a href="#What's forbidden in a test shell script">What's
              Forbidden in a Test Shell Script</a></li>
          </ul>
        </li>
      </ul>
    </td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->

<h3><a name="What"></a>What You Will Learn with This Article</h3>
<p>This article is intended to help you understand how to create and to run java
test objects using the mkodt command. If you want to have more information and
examples of java test objects, see the <a href="CAAmkodtUseCases.htm">use cases</a>
documentation.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h3><a name="mkodt command"></a>The mkodt Command</h3>
<p>The mkodt command runs java test objects which are delivered in test
frameworks. This command gives the choice (by using different options) of
running one test object or all test objects found in a given framework or in a
workspace. The command is available with mkmk commands. To access to this
command, you have to run the mkmk_profile or the adl_profile.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="Test file tree"></a>Test File Tree</h4>
<p>The CAA file tree is composed by framework. To each code framework correspond
a test framework which contains a FunctionTests directory; In this directory,
you must find everything you need to run test objects.</p>
<ul>
  <li><b>File Tree</b>
    <p><img border="0" src="images/fte.gif" width="737" height="838"></p>
  </li>
  <li><b>File Tree Description</b>
    <table border="1" width="100%">
      <tr>
        <th width="24%">Directory
        <th width="76%">Description
      </tr>
      <tr>
        <td width="24%">TestCases</td>
        <td width="76%">ODT shell-scripts</td>
      </tr>
      <tr>
        <td width="24%">SwitchTestCases</td>
        <td width="76%">Switch ODT shell-scripts</td>
      </tr>
      <tr>
        <td width="24%">InputData</td>
        <td width="76%">Input of shell-scripts. Every necessary files to run
          ODTs</td>
      </tr>
      <tr>
        <td width="24%">OutputRef</td>
        <td width="76%">Reference output of ODTs</td>
      </tr>
      <tr>
        <td width="24%">Output/$OS</td>
        <td width="76%">Output generated by mkodt on each operating system</td>
      </tr>
    </table>
  </li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="Options available on mkodt"></a>Options Available with mkodt</h4>
<p>Use the concepts of &quot;<em>workspace</em>&quot; and &quot;<em>project&quot;</em></p>
<ul>
  <li>
    <p>Help mode<br>
    mkodt -h</li>
  <li>
    <p>Contextual mode</li>
  <li>
    <p>Descriptive mode<br>
    To be explained</li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="Environment variables evaluated by mkodt"></a>Environment Variables
Evaluated by mkodt</h4>
<table border="1" width="100%">
  <tr>
    <th width="33%">Variable</th>
    <th width="16%">Use</th>
    <th width="51%">Meaning</th>
  </tr>
  <tr>
    <td><code>WSROOT</code></td>
    <td>Read only</td>
    <td>References the workspace directory containing the test objects to be
      run.</td>
  </tr>
  <tr>
    <td><code>ADL_ODT_TMP</code></td>
    <td>Read only</td>
    <td>References a temporary directory, for instance <em>/tmp</em> on Unix and
      <em>C:\TEMP</em> on Windows.</td>
  </tr>
  <tr>
    <td><code>ADL_ODT_IN</code></td>
    <td>Read only</td>
    <td>References a directory where all data needed as input for a program are
      stored.</td>
  </tr>
  <tr>
    <td><code>ADL_ODT_OUT</code></td>
    <td>Read/write</td>
    <td>References an output directory where any output data can be stored</td>
  </tr>
  <tr>
    <td><code>ADL_ODT_REF</code></td>
    <td>Read only</td>
    <td>References a directory where reference data are stored. Reference data
      are data used to compare what a program produces with what should be<br>
      produced....</td>
  </tr>
  <tr>
    <td><code>ADL_ODT_JRE</code></td>
    <td>Read/write</td>
    <td>References the Java RunTime Environment used to launch the ODT.</td>
  </tr>
  <tr>
    <td><code>ADL_ODT_NULL</code></td>
    <td>Read only</td>
    <td>References a special file which can be used to redirect outputs from a
      program (<em>/dev/null</em> with Unix or <em>NUL</em> with Windows.)</td>
  </tr>
  <tr>
    <td><code>ADL_ODT_SLASH</code></td>
    <td>Read only</td>
    <td>References the <b>/</b> on Unix and the <b>\</b>
      on Windows</td>
  </tr>
  <tr>
    <td><code>ADL_ODT_SEPARATOR</code></td>
    <td>Read only</td>
    <td>References the <b>:</b> (colon) on Unix and the <b>;</b> (semi-colon)
      on Windows</td>
  </tr>
  <tr>
    <td><code>ADL_ODT_CONCATENATION</code></td>
    <td>Read/write</td>
    <td>References a concatenation which is used by the WhichDir command</td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="Environment variable evaluated by user"></a>Environment Variables
Evaluated by the User</h4>
<table border="1" width="100%">
  <tr>
    <th width="35">Variable</th>
    <th width="65%">Meaning</th>
  </tr>
  <tr>
    <td><code>ADL_ODT_CONCATENATION</code></td>
    <td><b><span style="FONT-FAMILY: Comic Sans MS; FONT-SIZE: 13.5pt"></span></b>References
      a concatenation which is used by the WhichDir command</td>
  </tr>
  <tr>
    <td><code>ADL_ODT_OUT</code></td>
    <td>References an output directory in which<br>
      any output data can be stored. This directory can be evaluated before
      running mkodt.</td>
  </tr>
  <tr>
    <td><code>ADL_ODT_JRE</code></td>
    <td>
      <p>References the JRE (<b>J</b>ava <b>R</b>unTime <b>E</b>nvironment)
      where the ODT is going to be replayed:</p>
      <p>ADL_ODT_JRE can be set to:</p>
      <ol>
        <li><b>msjre_a</b> (Windows) ( Microsoft's JRE available on Windows</li>
        <li><b>sun</b><b>jre_a</b> (Windows and SunOS) (SUN's JRE available on Windows and SunOS)</li>
        <li><b>ibmjre_a</b> (AIX) (IBM's JRE available on AIX)</li>
        <li><b>hpjre_a</b> (HP) (HP's JRE available on HP)</li>
      </ol>
      <p>If this variable is not set before launching mkodt, it will be set by
      default to:</p>
      <ol>
        <li>Replay on Windows: <b>sunjre_a</b></li>
        <li>Replay on SunOS: <b>sunjre_a</b></li>
        <li>Replay on AIX: <b>ibmjre_a</b></li>
        <li>Replay on HP: <b>hpjre_a</b></li>
      </ol>
    </td>
  </tr>
  <tr>
    <td><code>ODT_PERTINENCE</code></td>
    <td>To suspend the pertinence measure, use: ( = -NoPert option)<code><br>
      ODT_PERTINENCE=No</code> (before running mkodt)</td>
  </tr>
  <tr>
    <td><code>MKMK_LST_RTV</code></td>
    <td>To give a runtime path concatenation, set the MKMK_LST_RTV variable
      before running mkodt ( = -r option)</td>
  </tr>
  <tr>
    <td><code>PATH_TEST</code></td>
    <td>To add a concatenation to the PATH (and LIBPATH or LD_LIBRARY_PATH or
      SHLIB_PATH) before running the ODT.</td>
  </tr>
  <tr>
    <td><code>ODT_MAX_TIME</code></td>
    <td>Set this variable to change the max_time value.</td>
  </tr>
  <tr>
    <td><code>ODT_MAX_TIME_COEF</code></td>
    <td>Set this variable to change the max_time value:
      max_time=max_time*ODT_MAX_COEFF/100</td>
  </tr>
  <tr>
    <td><code>MKODT_SUPENV (VPM)</code></td>
    <td>Set this variable to use environment extension; This variable must
      contain a shell-script path that will be run before the ODT shell-script.
      If this variable is not set, mkodt looks for <i>mkodt_supenv_($ADL_FR_CATIA)
      </i>file in the PATH<i>.</i></td>
  </tr>
  <tr>
    <td><code>OPTION_FOR_SETCATENV</code></td>
    <td>Set this variable to add options to setcatenv (set the CATIA
      environment)</td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="Test results : mkodt output"></a>Test Results: mkodt Output</h4>
<p>The mkodt command generates two output files in the <i>Output/$OS</i>
directory. These files are:</p>
<ol>
  <li><i>xxx.traces</i>: contains traces generated by the shell script.</li>
  <li>
    <p><i>xxx.mkodt_result</i>: contains result of the ODT replay. The file
    format is:
    <pre>FrameworkName -f ODTName ReturnCode date ? ODTType Pertinence Elapsed_time max_time</pre>
    <p>where:</p>
    <ul>
      <li><code>ODTType = S</code> if the ODT is a Switch ODT, otherwise <code>ODTType = .</code></li>
        <li><code>Pertinence = 0</code> if the ODT is not pertinent, otherwise
          ODT is pertinent</li>
        <li><code>max_time = .</code> if the max_time value is not modified in
          the ODT</li>
        </ul>
      </li>
    </ol>
        <p align="right">[<a href="#Top">Top</a>]</p>
    <!---------------------------------comment------------------------------------->
    <h3><a name="Test shell script creation"></a>Test shell script creation</h3>
    <h4><a name="Available commands in a test shell scriptj"></a>Available
    commands in a test shell script<em>j</em></h4>
    <h5><a name="SetOdtParam"></a>SetOdtParam</h5>
    <p>A shell can include the <i>SetOdtParam </i>instruction to control some
    aspects of its execution.</p>
    <ul>
      <li>
        <p><b>SetOdtParam max_time=xx</b></li>
    </ul>
    <blockquote>
      <p><i>max_time</i> is the maximum time allowed for test to be completed.
      The default value of <i>max_time</i> is 5 minutes. <i>max_time</i> can not
      exceed <b>60 minutes</b>. If a test exceeds this <i>max_time</i>, the
      corresponding process is killed and the ODT exit with a return code 99.</p>
    </blockquote>
    <ul>
      <li>
        <p><b>SetOdtParam USER=xxx</b></li>
    </ul>
    <blockquote>
      <p>This instruction is used to specify the user (xxx) when the ODT will be
      replayed.</p>
    </blockquote>
    <ul>
      <li>
        <p><b>SetOdtParam Replay_xxxx=NO (where xxx is an OS name: AIX, 
        SunOS, HP-UX, Unix, Windows_NT, aix_a, solaris_a, hpux_b or
        intel_a)</b></li>
    </ul>
    <blockquote>
      <p>This instruction indicates that the current test object must not be run
      on the given operating system - this property is useful when all test
      objects are run automatically and not by hand. More than one such
      instruction can be written in a shell.</p>
    </blockquote>
    <ul>
      <li>
        <p><b>SetOdtParam Replay_xxxx=NO (where xxx is a JRE name: msjre_a,
        ibmjre_a, sgijre_a or hpjre_a)</b></li>
    </ul>
    <blockquote>
      <p>This instruction indicates that the current test object must not be run
      on the given Java RunTime Environment () - this property is useful when
      all test objects are run automatically and not by hand. More than one such
      instruction can be written in a shell (see also <a href="#Environment variable evaluated by user">the
      ADL_ODT_JRE environment variable</a>).</p>
    </blockquote>
    <ul>
      <li>
        <p><b>SetOdtParam TYPE=JAVABATCH</b></li>
    </ul>
    <blockquote>
      <p>This instruction type the ODT as a java ODT. It will create the minimum
      java environment updating the PATH and the CLASSPATH. This line must be
      present in every java ODTs.</p>
    </code>
  </blockquote>
  <ul>
    <li>
      <p><b>SetOdtParam TYPE=xxx </b></li>
  </ul>
  <blockquote>
    <p>This instruction type the ODT, that is to say that this ODT can be
    selected in a Release by setting the environment variable ReplayExcluType.</p>
    <p><b><i>Example:</i></b></p>
    <p>If the ODT is:</p>
    <pre class="code">SetOdtParam TYPE=MonTYPE
exit $</pre>
    <p>if in the Release, ReplayExcludType is set to <code><b>
	MonTYPE</b></code>, this ODT will not
    be replayed.</p>
    <p>This instruction is used in Product Release to select ODTs to replay.</p>
    <p><b><i>Example:</i></b></p>
    <p>in a product Release P1: set ReplayExckudType=TYPE1!TYPE2 (on NT) or
    export ReplayExcluType=TYPE1&amp;TYPE2 on UNIX.</p>
    <p>This Release P1 is not going to replay ODT that contain:</p>
    <p>SetOdtParam TYPE=TYPE1</p>
    <p>Or / And:</p>
    <p>SetOdtParam TYPE=TYPE2</p>
  </blockquote>
  <h5><a name="WhichDir"></a>WhichDir</h5>
  <blockquote>
    <p>This command is used to find a directory or a file in the workspace
    concatenation ( ADL_ODT_CONCATENATION).</p>
    <p>This command will be used to add files (.zip, ,jar, ...) to the CLASSPATH
    environment variable already set.</p>
  </blockquote>
  <h5><a name="ODTInit"></a>ODTInit</h5>
  <blockquote>
    <p>This command can be used in ODTs that contain an initialization step;
    indeed, some ODTs could use the same data, for example, the same Part. In a
    replay, this command will factorize the initialization step&#8230;.</p>
    <p>To use this command, you have to create a shell-script, named
    ODTInit_logicname.sh in the ADL_ODT_IN directory of the test framework; This
    shell will create the output data that will be used in the others ODTs. To
    use the output of the ODTInit_logicname.sh file, you have to start the ODT
    shell-script with:</p>
    <pre>ODTInit logicname</pre>
    <p>The purpose of this command is to gain time on the ODT replay.</p>
  </blockquote>
  <h5><a name="JavaReplay"></a>JavaReplay</h5>
  <blockquote>
    <p>This command must be used to launch your apllet or java application with
    in arguments all the arguments you would give to java or jview.</p>
    <p>This command will launch the java you choosed (by setiing the
    ADL_ODT_JRE).</p>
  </blockquote>
  <h5><a name="What's forbidden in a test shell script"></a>What's Forbidden in a
  Test Shell Script</h5>
  <table border="1" width="100%">
    <tr>
      <th width="50%">Forbidden</td>
      <th width="50%">Authorized</td>
    </tr>
    <tr>
      <td width="50%">#!/bin/ksh</td>
      <td width="50%">#</td>
    </tr>
    <tr>
      <td width="50%">No export of PATH, LIBPATH and ADL_ODT_xxx</td>
      <td width="50%">-</td>
    </tr>
    <tr>
      <td width="50%">Don't use the rm and mv commands</td>
      <td width="50%">-</td>
    </tr>
    <tr>
      <td width="50%">Don't use &quot;/&quot; in the PATH</td>
      <td width="50%">Use $ADL_ODT_SLASH</td>
    </tr>
    <tr>
      <td width="50%">Don't use &quot;:&quot; in the PATH</td>
      <td width="50%">Use $ADL_ODT_SEPARATOR</td>
    </tr>
    <tr>
      <td width="50%">Don't run process in background
        (process&amp; )</td>
      <td width="50%">-</td>
    </tr>
    <tr>
      <td width="50%">No file Path: /u/lego/CXR3/BSF/&#8230;</td>
      <td width="50%">Use ADL_ODT_xxx variables</td>
    </tr>
    <tr>
      <td width="50%">Don't use /tmp</td>
      <td width="50%">Use ADL_ODT_TMP</td>
    </tr>
    <tr>
      <td width="50%">Don't use /dev/null</td>
      <td width="50%">Use ADL_ODT_NULL</td>
    </tr>
    <tr>
      <td width="50%">-</td>
      <td width="50%">Test the return code of your modules</td>
    </tr>
    <tr>
      <td width="50%">return xx</td>
      <td width="50%">exit xx</td>
    </tr>
    <tr>
      <td width="50%">../../InputData (relative Path)</td>
      <td width="50%">Use ADL_ODT_xxx variables</td>
    </tr>
    <tr>
      <td width="50%">/dir/WS/OS/code/bin/LOAD</td>
      <td width="50%">LOAD</td>
    </tr>
    <tr>
      <td width="50%">No double bracket [[&#8230;]]</td>
      <td width="50%">Use [&#8230;]</td>
    </tr>
  </table>
  <p align="right">[<a href="#Top">Top</a>]</p>
  <hr>
        <!---------------------------------comment------------------------------------->

  <h3><a name="References"></a>References</h3>
  <table width="100%">
    <tr>
      <td valign="top">[1]</td>
      <td><a href="../CAARqjQuickRefs/CAARqjmkodt.htm">mkodt Options
        and Variables</a></td>
    </tr>
    <tr>
      <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
    </tr>
  </table>
  <hr>
        <!---------------------------------comment------------------------------------->
  <h3><a name="History"></a>History</h3>
  <table width="100%">
    <tr>
      <td valign="top">Version: <strong>1</strong> [March 2001]</td>
      <td valign="top">Document created</td>
    </tr>
    <tr>
      <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
    </tr>
  </table>
  <hr>
        <!---------------------------------comment------------------------------------->
  <p><i>Copyright © 2000, Dassault Systèmes. All rights reserved.</i></p>
</code>

</body>

</html>
