<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<link rel="Stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css">
<title>Creating a Document's Window - Part 2</title>
</head>

<body>

<table width="100%">
  <tr>
    <td valign="top">
      <h1>3D PLM Enterprise Architecture</h1>
    </td>
    <td valign="top">
      <h2>User Interface - Frame</h2>
    </td>
    <td rowspan="2" align="right" valign="top">
      <h3><a name="Top"></a>Creating a Document's Window - Part 2</h3>
      <em>How to create a multi-viewers window</em></td>
  </tr>
  <tr>
    <td class="use" colspan="2">Use Case</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->

<table class="abstract">
  <tr>
    <td>
      <h3>Abstract</h3>
      <p>This article shows how to create a window to display a document. It
      explains more precisely the specificity of a multi-viewers window. In the
      other hand, the use case described in the &quot;Creating a Document's
      Window - Part 1&quot; article [<a href="#References">1</a>] enables you to
      understand how to launch a document's window from a command.
      <ul>
        <li><a href="#Learn"><strong>What You Will Learn With This Use Case</strong></a></li>
        <li><a href="#UseCase"><strong>The CAAAfrCustomWindow Use Case</strong></a>
          <ul>
            <li><a href="#What">What Does CAAAfrCustomWindow Do</a></li>
            <li><a href="#How">How to Launch CAAAfrCustomWindow</a></li>
            <li><a href="#Where">Where to Find the CAAAfrCustomWindow Code</a></li>
          </ul>
        </li>
        <li><a href="#Step"><strong>Step-by-Step</strong></a></li>
        <li><a href="#InShort"><strong>In Short</strong></a></li>
        <li><a href="#References"><strong>References</strong></a></li>
      </ul>
    </td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->

<h3><a name="Learn"></a>What You Will Learn With This Use Case</h3>
<p>This use case is intended to show how to create a window with several viewers
for document of a given type [<a href="#References">2</a>].</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h3><a name="UseCase"></a>The CAAAfrCustomWindow Use Case</h3>
<p>CAAAfrCustomWindow is a use case of the CAAApplicationFrame.edu framework
that illustrates the ApplicationFrame framework capabilities.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="What"></a>What Does CAAAfrCustomWindow Do</h4>
<p>The CAAAfrCustomWindow use case creates a document window for CAASample
documents.</p>
<p><img src="images/CAAAfrCustomWindow.jpg" alt="CAAAfrCustomWindow.jpg (42069 bytes)" width="638" height="548"></p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="How"></a>How to Launch CAAAfrCustomWindow</h4>
<p>See the section entitled &quot;How to Launch the CAAGeometry Use Case&quot;
in the &quot;<a href="../CAASysUseCases/CAASysCAAGeometryOverview.htm">The
CAAGeometry Sample</a>&quot; use case for a detailed description of how this use
case should be launched. For the specific scenario :</p>
<p>Do not type the module name on the command line, but type CNEXT instead. When
the application is ready, do the following:
<ul>
  <li>Select <b>File</b>-&gt;<b>New</b></li>
  <li>In the New box, select <b>CAASample</b> and click <b>OK</b></li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="Where"></a>Where to Find the CAAAfrCustomWindow Code</h4>
<p>The CAAAfrCustomWindow use case is made up of a single class named
CAAAfrCustomWindow located in the CAAAfrGeoWindows.m module of the
CAAApplicationFrame.edu framework:</p>
<table>
  <tbody>
    <tr>
      <td>Windows</td>
      <td><code>InstallRootDirectory\CAAApplicationFrame.edu\CAAAfrGeoWindows.m\</code></td>
    </tr>
    <tr>
      <td>Unix</td>
      <td><code>InstallRootDirectory/CAAApplicationFrame.edu/CAAAfrGeoWindows.m/</code></td>
    </tr>
  </tbody>
</table>
<p>where <code>InstallRootDirectory</code> is the directory where the CAA CD-ROM
is installed. It includes the CAAAfrCustomWindow.h&nbsp; header file in the
PrivateInterfaces directory of the CAAApplicationFrame.edu framework and the
CAAAfrCustomWindow.cpp source file in the src directory.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h3><a name="Step"></a>Step-by-Step</h3>
<p>To create the custom window, there are five steps:</p>
<table width="100%">
  <tr>
    <th>#</th>
    <th>Step</th>
    <th>Where</th>
  </tr>
  <tr>
    <td valign="top"><a href="#Step1">1</a></td>
    <td valign="top">Create the custom window class</td>
    <td valign="top">LocalInterfaces and src</td>
  </tr>
  <tr>
    <td valign="top"><a href="#Step2">2</a></td>
    <td valign="top">Provide the dialog object behavior</td>
    <td valign="top"><code>Build</code> method</td>
  </tr>
  <tr>
    <td valign="top"><a href="#Step3">3</a></td>
    <td valign="top">Provide the MDI document window behavior</td>
    <td valign="top"><code>Build</code> method</td>
  </tr>
  <tr>
    <td valign="top"><a href="#Step4">4</a></td>
    <td valign="top">Duplicate the window</td>
    <td valign="top"><code>Duplicate</code> method</td>
  </tr>
  <tr>
    <td valign="top"><a href="#Step5">5</a></td>
    <td valign="top">Delete the window</td>
    <td valign="top"><code>DeleteWindow</code> and Destructor</td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="Step1"></a>Creating the Custom Window Class</h4>
<p>This document window includes two 3D viewers of different sizes located in
the upper part of the window, and a 2D viewer located in the lower part of the
window. The class for this window is <em>CAAAfrCustomWindow</em>, whose header
file is as follows.</p>
<table class="code">
  <tr>
    <td>
      <pre>class CAAAfrCustomWindow: public CATFrmWindow
{
  public:
    CAAAfrCustomWindow(const CATString &amp; iName, CATFrmEditor * iEditor=NULL);
    virtual ~CAAAfrCustomWindow();
    
    virtual CATFrmWindow * <b>DuplicateWindow</b>();
    virtual void <b>DeleteWindow</b>();
    
    void <b>Build</b>();
    
    void <b>GetViewers</b>(CATNavigation3DViewer ** oV1,
                       CATNavigation3DViewer ** oV2, 
                       CATNavigation2DViewer ** oV3);
   ...
  private:
    CATNavigation3DViewer * _pViewer1;
    CATNavigation3DViewer * _pViewer2;
    CATNavigation2DViewer * _pViewer3;
    CATPathElement        * _pRootObjectPath;
};</pre>
    </td>
  </tr>
</table>
<p><em>CAAAfrCustomWindow</em> has&nbsp;</p>
<ul>
  <li>a constructor and a destructor.</li>
  <li>a <code>DuplicateWindow</code> method used by the New Window command of
    the Window menu.</li>
  <li>a <code>DeleteWindow</code> method called when the end user closes the
    window or closes the document.</li>
  <li>a <code>Build</code> method as all the Dialog boxes.</li>
  <li>a <code>GetViewers</code> method to retrieve pointers to its three
    viewers.&nbsp;</li>
  <li>Its data members are the three navigation viewers and the&nbsp;root model
    to display.</li>
</ul>
<p>The constructor class is simple.</p>
<table class="code">
  <tr>
    <td>
      <pre>CAAAfrCustomWindow::CAAAfrCustomWindow(const CATString &amp; iName,
                                       CATFrmEditor    * iEditor)
                  : <b>CATFrmWindow</b>(iName, iEditor),
                    _pViewer1(NULL), _pViewer2(NULL), _pViewer3(NULL),
                    _pRootObjectPath(NULL),
{
} </pre>
    </td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="Step2"></a>Providing the Dialog Object Behavior</h4>
<p>The dialog object behavior consists in:
<ul>
  <li><a href="#S21">Instantiating the different viewers to display</a></li>
  <li><a href="#S22">Arranging these viewers in the document window</a></li>
  <li><a href="#S23">Setting the current viewer</a></li>
</ul>
<p>The constructor creates the viewers, arranges them in the window and sets one
of them the current viewer.
<ol>
  <li><a name="S21"></a>Instantiating the different viewers to display
    <table class="code">
      <tr>
        <td>
          <pre>void CAAAfrCustomWindow::Build()
{
  int width, height;
  CATString  ViewerName; 

  CATDlgFrame * FrameWindow = <b>GetViewerFrame</b>() ;
  CATString FrameName = &quot;FrameName&quot;;
  CATDlgFrame * Frame = new CATDlgFrame(FrameWindow, FrameName,
                                        CATDlgGridLayout|CATDlgFraNoFrame);

  ViewerName = &quot;Viewer3Dnum1&quot;;
  width = 200 ; height = 200;
  _pViewer1 = new CATNavigation3DViewer(Frame, ViewerName, width, height);
    
  ViewerName = &quot;Viewer3Dnum2&quot; ;
  width = 200 ; height = 300 ;
  _pViewer2 = new CATNavigation3DViewer(Frame, ViewerName, width, height);

  ViewerName = &quot;Viewer2D&quot; ;
  width = 200 ; height = 500 ;
  _pViewer3 = new CATNavigation2DViewer(Frame, ViewerName, width, height);
...   </pre>
        </td>
      </tr>
    </table>
    <p>The viewer sizes are given in pixels. The MDI application window, here
    named Frame, is the parent of the viewers. This frame has been created to be
    inserted between the frame created by the <i>CATFrmWindow</i> ( <code>FrameWindow</code>
    ) and the viewers. It allows us to arrange the viewers with the grid layout
    and not with the tabulation layout [<a href="#References">3</a>] which is a
    little bit more complex. The <code>FrameWindow</code> frame has not been
    created with the <code>CATDlgGridLayout</code> style [<a href="#References">1</a>].&nbsp;</p>
  </li>
  <li><a name="S22"></a>Arranging these viewers in the document window
    <table class="code">
      <tr>
        <td>
          <pre>...
  FrameWindow-&gt;Attach4Sides(Frame);
  _pViewer1-&gt;SetGridConstraints(0,0,1,1,CATGRID_4SIDES);
  _pViewer2-&gt;SetGridConstraints(0,1,1,1,CATGRID_4SIDES);
  _pViewer3-&gt;SetGridConstraints(1,0,2,1,CATGRID_4SIDES);
  Frame-&gt;SetGridRowResizable(0,1);
  Frame-&gt;SetGridRowResizable(1,1);
  Frame-&gt;SetGridColumnResizable(0,1);
  Frame-&gt;SetGridColumnResizable(1,1);
...      </pre>
        </td>
      </tr>
    </table>
    <p>The <code>Attach4Sides</code> method attaches the <code>Frame</code>
    object to the four sides of the <code>FrameWindow</code> object. It is a
    method used by the tabulation layout.&nbsp;</p>
    <p>Then the <code>SetGridConstraints</code> method applied to <code>_Viewer1</code>
    is located on grid cells beginning with the cell at the intersection of the
    row 0 and column 0, and expands from left to right on 1 row, and from top to
    bottom on 1 column. <code>CATGRID_4SIDES</code> means that the viewer
    occupies the whole cell space. Row 0 and 1, as well as columns 0 and 1, as
    first argument of the <code>SetGridxxResizable</code> methods, are declared
    to be resizable since the second argument is 1 (on the opposite, 0 means non
    resizable.)</p>
    <p><img src="images/CAAAfrCustomWindow.gif" alt="CAAAfrCustomWindow.gif (2992 bytes)" width="323" height="219"></p>
  </li>
  <li><a name="S23"></a>Setting the current viewer
    <table class="code">
      <tr>
        <td>
          <pre>...
  _pViewer1-&gt;Reframe();
  SetViewer(_pViewer1);
...      </pre>
        </td>
      </tr>
    </table>
    <p>The <code>Reframe</code> method ensures that the whole contents of <code>_pViewer1</code>
    is displayed, while the <code>SetViewer</code> method sets <code>_pViewer1</code>
    as the current viewer. You will retrieve this viewer with the <code>GetViewer</code>
    method of the <i>CATFrmWindow</i> class.&nbsp;</p>
    <p>We have now a nice document window, but few interactive mechanisms are
    available. Let's assign them now.</p>
  </li>
</ol>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="Step3"></a>Providing the MDI Document Window Behavior</h4>
<p>The MDI document window behavior consists in:
<ul>
  <li><a href="#S31">Retrieving the visualization manager and the document root
    object</a></li>
  <li><a href="#S32">Requesting the document to create its graphics
    representation(s) and attaching them to the visualization manager</a></li>
  <li><a href="#S33">Managing the links between these objects and all the other
    objects enabling interactivity.</a></li>
</ul>
<ol>
  <li><a name="S31"></a>Retrieving the visualization manager and the document
    root object
    <p>Still in the <code>Build</code> method, let's now the unique
    visualization manager be aware of the document to display, under which
    viewpoints.&nbsp;The <code>GetEditor</code> method of the <i>CATFrmWindow</i>
    enables you to retrieve the editor of the constructor class.</p>
    <table class="code">
      <tr>
        <td>
          <pre>...
  CATFrmEditor * pEditor = <b>GetEditor</b>();
  CATVisManager * pVisuManager = CATVisManager::<b>GetVisManager</b>();

  // Here is the code to retrieve the root model, pRootObject
...</pre>
        </td>
      </tr>
    </table>
    <p>In this article the code to retrieve the model to display is not
    explained once it is not useful for a real V5 document.&nbsp;</p>
  </li>
  <li><a name="S32"></a>Requesting the document to create its graphics
    representation(s) and attaching them to the visualization manager
    <table class="code">
      <tr>
        <td>
          <pre>...
  if ( (NULL != pEditor  ) &amp;&amp; (NULL != pRootObject ) &amp;&amp; (NULL != pVisuManager) )
    { 
      _pRootObjectPath = new CATPathElement(pRootObject);

      CATCommand * CommandSelector = (CATCommand*) pEditor-&gt;<b>GetCommandSelector</b>();

      list&lt;IID&gt; ListIVisu3d, ListIVisu2d;
      IID visu3d = IID_CATI3DGeoVisu;
      IID visu2d = IID_CATI2DGeoVisu;
      ListIVisu3d.fastadd(&amp;visu3d);
      ListIVisu2d.fastadd(&amp;visu2d);
     
      CATViewpoint * pViewPoint1 = NULL;
      CATViewpoint * pViewPoint2 = NULL;
      CATViewpoint * pViewPoint3 = NULL;

      pViewPoint1 = (CATViewpoint*) &amp;(_pViewer1-&gt;GetMain3DViewpoint());
      pVisuManager-&gt;<b>AttachTo</b>(_pRootObjectPath,pViewPoint1,ListIVisu3d,CommandSelector);

      pViewPoint2 = (CATViewpoint*) &amp;(_pViewer2-&gt;GetMain3DViewpoint());
      pVisuManager-&gt;AttachTo(_pRootObjectPath,pViewPoint2,ListIVisu3d,CommandSelector);

      pViewPoint3 = (CATViewpoint*) &amp;(_pViewer3-&gt;GetMain2DViewpoint());
      pVisuManager-&gt;AttachTo(_pRootObjectPath,pViewPoint3,ListIVisu2d,CommandSelector);
...</pre>
        </td>
      </tr>
    </table>
    <p>If the editor, the visualization manager, and the root object are
    successfully retrieved, this root object is then turned to a <i>CATPathElement</i>,
    the command selector, that is, the command that stands at the top of the
    command tree [<a href="#References">4</a>], is retrieved, and the lists of
    2D and 3D interfaces implemented by the objects of the documents are set up.
    Then for each viewer, its main viewpoint is retrieved and attached to the
    visualization manager along with the document's root object, the list of
    interfaces to use, and the command selector.</p>
  </li>
  <li><a name="S33"></a>Managing the links between these objects and all the
    other objects enabling interactivity
    <table class="code">
      <tr>
        <td>
          <pre>...
      CATPSO * pPSO = pEditor-&gt;<b>GetPSO</b>() ;  // Preselected Set Objects 
      CATHSO * pHSO = pEditor-&gt;<b>GetHSO</b>() ;  // Highlighted Set Objects 

      pVisuManager-&gt;<b>AttachPSOTo</b>(pPSO, pViewPoint1);
      pVisuManager-&gt;AttachPSOTo(pPSO, pViewPoint2);
      pVisuManager-&gt;AttachPSOTo(pPSO, pViewPoint3);
      pVisuManager-&gt;<b>AttachHSOTo</b>(pHSO, pViewPoint1);
      pVisuManager-&gt;AttachHSOTo(pHSO, pViewPoint2);
      pVisuManager-&gt;AttachHSOTo(pHSO, pViewPoint3);

      CATISO * pISO = pEditor-&gt;<b>GetISO</b>(); 
      pISO-&gt;<b>AddViewer</b>(_pViewer1);
      pISO-&gt;AddViewer(_pViewer2);
      pISO-&gt;AddViewer(_pViewer3);
    }
  }
}
...</pre>
        </td>
      </tr>
    </table>
    <p>This piece of code retrieves the Preselected Set of Objects (PSO) and the
    Highlighted Set of Objects (HSO) from the editor, and requests the
    visualization controller to attach the appropriate viewpoints to the PSO and
    to the HSO. Now, when the end user moves the mouse above a representation in
    a viewer, the path element corresponding to this representation is put in
    the PSO, is highlighted and put in the HSO.&nbsp;</p>
    <p>The Interactive Set of Objects (ISO) is also retrieved. These objects are
    those which don't belong to the document, but that are so handy to
    manipulate representations in viewers, such as handles to move or deform
    them. The ISO now knows the three viewers.</p>
    <p>The document window <code>Build</code> method is now complete.</p>
  </li>
</ol>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="Step4"></a>Duplicating a Document Window</h4>
<p>This is done thanks to the Duplicate method.</p>
<table class="code">
  <tr>
    <td>
      <pre>...
CATFrmWindow * CAAAfrCustomWindow :: DuplicateWindow()
{
  CATString NameOfThis = GetBaseName().CastToCharPtr();
  CAAAfrCustomWindow * pWindowToReturn = NULL;
  pWindowToReturn = new <strong>CAAAfrCustomWindow</strong>(NameOfThis,GetEditor());
  pWindowToReturn-&gt;<b>Build</b>();
  
  pWindowToReturn-&gt;<strong>SetBaseName</strong>(GetBaseName());

  float r,v,b ;
  if (NULL != _pViewer1) _pViewer1-&gt;<strong>GetBackgroundColor</strong>(&amp;r, &amp;v, &amp;b);

  CATNavigation3DViewer * pV1 = NULL;
  CATNavigation3DViewer * pV2 = NULL;
  CATNavigation2DViewer * pV3 = NULL;

  pWindowToReturn-&gt;<strong>GetViewers</strong>(&amp;pV1, &amp;pV2, &amp;pV3);
  if (NULL != pV1) pV1-&gt;<strong>SetBackgroundColor</strong>(r, v, b);

  return  pWindowToReturn;
}
...</pre>
    </td>
  </tr>
</table>
<p>The <code>Duplicate</code> method is now complete. It performs the following:
<ul>
  <li>Creates a window of the same type than the current one</li>
  <li>Sets the same name than the current one. The <code>SetBaseName</code>
    method modifies the name of the first window if only one exists. At the base
    name, an index is added [<a href="#References">2</a>].</li>
  <li>Retrieves the background color of the first viewer as a RGB triplet</li>
  <li>Retrieves the created window viewers</li>
  <li>Sets the retrieved background color to the first viewer of the created
    window</li>
</ul>
<p>This method uses the <code>GetViewers</code> method below:</p>
<table class="code">
  <tr>
    <td>
      <pre>void CAAAfrCustomWindow :: GetViewers(CATNavigation3DViewer ** oV1,
                                      CATNavigation3DViewer ** oV2, 
                                      CATNavigation2DViewer ** oV3)
{
  *oV1 = _pViewer1;
  *oV2 = _pViewer2;
  *oV3 = _pViewer3;
}</pre>
    </td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>

<!---------------------------------comment------------------------------------->

<h4><a name="Step5"></a>Deleting the Window</h4>
<table class="code">
  <tr>
    <td>
      <pre>...
void CAAAfrCustomWindow::DeleteWindow()
{
  if ( (NULL != GetEditor()) &amp;&amp; (NULL != pViewer1) &amp;&amp;
       (NULL != pViewer2)    &amp;&amp; (NULL != pViewer3) )
  {
    // Detaches Viewers from the ISO 
    CATISO *pISO = NULL;
    pISO = <b>GetEditor</b>()-&gt;GetISO();
    if (NULL != pISO) pISO-&gt;<b>RemoveViewer</b>(_pViewer1);
    if (NULL != pISO) pISO-&gt;RemoveViewer(_pViewer2);
    if (NULL != pISO) pISO-&gt;RemoveViewer(_pViewer3);

    // Retrieves Viewpoints
    CATViewpoint * pViewpoint1 = NULL;
    CATViewpoint * pViewpoint2 = NULL;
    CATViewpoint * pViewpoint3 = NULL;
    pViewpoint1 = (CATViewPoint *) &amp;(_pViewer1-&gt;GetMain3DViewpoint());
    pViewpoint2 = (CATViewPoint *) &amp;(_pViewer2-&gt;GetMain3DViewpoint());
    pViewpoint3 = (CATViewPoint *) &amp;(_pViewer3-&gt;GetMain2DViewpoint());

    // Retrieves the unique visu manager
    CATVisManager *pVisuManager = <b>CATVisManager::GetVisManager</b>();
    if ( (NULL != pViewpoint1) &amp;&amp;
         (NULL != pViewpoint2) &amp;&amp;
         (NULL != pViewpoint3) &amp;&amp; (NULL != pVisuManager) )
    {
      // Detaches Viewpoints from PSO and HSO
      pVisuManager-&gt;<b>DetachPSOFrom</b>(pViewpoint1);
      pVisuManager-&gt;DetachPSOFrom(pViewpoint2);
      pVisuManager-&gt;DetachPSOFrom(pViewpoint3);
      pVisuManager-&gt;<b>DetachHSOFrom</b>(pViewpoint1);
      pVisuManager-&gt;DetachHSOFrom(pViewpoint2);
      pVisuManager-&gt;DetachHSOFrom(pViewpoint3);

      // Detaches Viewpoints from the visu manager
      pVisuManager-&gt;<b>DetachFrom</b>(_pRootObjectPath, pViewpoint1);
      pVisuManager-&gt;DetachFrom(_pRootObjectPath, pViewpoint2);
      pVisuManager-&gt;DetachFrom(_pRootObjectPath, pViewpoint3);
    }
  }
  <b>CATFrmWindow::DeleteWindow</b>();
}

CAAAfrCustomWindow::~CAAAfrCustomWindow()
{
  if (NULL != _pRootObjectPath) delete _pRootObjectPath;
  _pRootObjectPath = NULL;
}
...    </pre>
    </td>
  </tr>
</table>
<p>The document window is deleted thanks to the <code>DeleteWindow</code>
method, that removes the viewers from the ISO, then retrieves their viewpoints
and detaches them from the PSO and from the HSO, and&nbsp; that recursively
calls the <code>DeleteWindow</code> method of the base class. The destructor
simply deletes the path to the root object. No need to delete the viewers, since
as any dialog object, they will be automatically deleted when the window itself
will be deleted.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<!---------------------------------comment------------------------------------->

<h3><a name="InShort"></a>In Short</h3>
<p>This use case explains the structure of a document's window class:</p>
<ul>
  <li>A <code>Build</code> method
    <ul>
      <li>To create and arrange the viewers in the window,</li>
      <li>To attach the root's document and the Interactive Set Objects to the
        command tree.</li>
    </ul>
  </li>
  <li>A <code>DuplicateWindow</code> method to create a new instance from an
    existing one.&nbsp;</li>
  <li>A <code>DeleteWindow</code> method to detach the root's document and the
    Interactive Set Objects from the command tree.&nbsp;</li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<!---------------------------------comment------------------------------------->

<h3><a name="References"></a>References</h3>
<table border="0" width="100%">
  <tr>
    <td valign="top">[1]</td>
    <td><a href="CAAAfrSampleCustomWindow1.htm">Creating a Document's Window -
      Part 1</a></td>
  </tr>
  <tr>
    <td valign="top">[2]</td>
    <td><a href="../CAAAfrTechArticles/CAAAfrLayoutV5.htm">Understanding
      the Application Frame Layout</a></td>
  </tr>
  <tr>
    <td valign="top">[3]</td>
    <td><a href="../CAADlgTechArticles/CAADlgObjectLayout.htm">Arranging
      Dialog Objects</a></td>
  </tr>
  <tr>
    <td valign="top">[4]</td>
    <td><a href="../CAADegTechArticles/CAADegCommandModel.htm">The
      CAA Command Model</a></td>
  </tr>
  <tr>
    <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="History"></a>History</h3>
<table border="0" width="100%">
  <tr>
    <td valign="top">Version: <strong>1</strong> [Jan 2000]</td>
    <td valign="top">Document created</td>
  </tr>
  <tr>
    <td valign="top">Version: <strong>2</strong> [Mar 2003]</td>
    <td valign="top">Document updated</td>
  </tr>
  <tr>
    <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<p><i>Copyright © 2000, Dassault Systèmes. All rights reserved.</i></p>

</body>

</html>
