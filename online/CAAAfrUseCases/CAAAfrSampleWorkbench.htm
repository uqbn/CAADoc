<html>

 <head>
 <meta http-equiv="Content-Language" content="en-us">
 <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
 <meta name="GENERATOR" content="Microsoft FrontPage 6.0">
 <meta name="ProgId" content="FrontPage.Editor.Document">
 <link rel="Stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css">
 <title>Creating a Workbench</title>
 </head>

 <body>

 <table width="100%">
   <tr>
     <td valign="top">
     <h1>3D PLM Enterprise Architecture</h1>
     </td>
     <td valign="top">
     <h2>User Interface - Frame</h2>
     </td>
     <td rowspan="2" align="right" valign="top">
     <h3><a name="Top"></a>Creating a Workbench</h3>
     <p><em>Exposing and organizing commands dedicated to a given task</em></td>
   </tr>
   <tr>
     <td class="use" colspan="2">Use Case</td>
   </tr>
 </table>
 <hr>
 <!---------------------------------comment------------------------------------->
 <table class="abstract">
   <tr>
     <td>
     <h3>Abstract</h3>
     <p>This article shows how to create a workbench. </p>
     <ul>
       <li><a href="#Learn"><strong>What You Will Learn With This Use Case</strong></a></li>
       <li><a href="#UseCase"><strong>The CAAAfrGeoCreationWbench Use Case</strong></a>
       <ul>
         <li><a href="#What">What Does CAAAfrGeoCreationWbench Do</a></li>
         <li><a href="#How">How to Launch CAAAfrGeoCreationWbench</a></li>
         <li><a href="#Where">Where to Find the CAAAfrGeoCreationWbench Code</a></li>
       </ul>
       </li>
       <li><a href="#Step"><strong>Step-by-Step</strong></a></li>
       <li><a href="#Troubleshooting"><strong>Troubleshooting</strong></a></li>
       <li><a href="#InShort"><strong>In Short</strong></a></li>
       <li><a href="#References"><strong>References</strong></a></li>
     </ul>
     </td>
   </tr>
 </table>
 <hr>
 <!---------------------------------comment------------------------------------->
 <h3><a name="Learn"></a>What You Will Learn With This Use Case</h3>
 <p>This use case is intended to show how to create a workbench to be added to a 
 given workshop. Like the workshop, the workbench is an object that gathers the 
 commands to work on the document and arrange them in toolbars and menus. 
 Command headers are used to make the link between the workbench and the 
 commands.</p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h3><a name="UseCase"></a>The CAAAfrGeoCreationWbench Use Case</h3>
 <p>CAAAfrGeoCreationWbench is a use case of the CAAApplicationFrame.edu 
 framework that illustrates the ApplicationFrame framework capabilities.</p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="What"></a>What Does CAAAfrGeoCreationWbench Do</h4>
 <p>The CAAAfrGeoCreationWbench use case creates a workbench named <strong>CAA 
 Geometrical Creation</strong> for the CAAGeometry document. Its specifications 
 cover most of the cases you will meet. Two toolbars are provided:</p>
 <table border="0">
   <tr>
     <td>
     <img border="0" src="images/CAAAfrGeomWbenchSolidElt.jpg" width="171" height="60"></td>
     <td valign="top">The <strong>Solids</strong> toolbar. It includes five new 
     commands: Cuboid, Sphere, Torus, and Cylinder 1 and 2.</td>
   </tr>
   <tr>
     <td>
     <img border="0" src="images/CAAAfrGeomWbenchSurfaceElt.jpg" width="109" height="60"></td>
     <td valign="top">The <strong>Surfaces</strong> toolbar. It includes three 
     new commands: Revolution Surface, Nurbs Surface, and Offset Surface.</td>
   </tr>
 </table>
 <p>The only change in the menu bar is the addition of these commands in the 
 Insert menu using two submenus below the existing ones.</p>
 <table>
   <tr>
     <td valign="top">
     <img border="0" src="images/CAAAfrGeomWbenchSolidsSM.jpg" width="229" height="330"></td>
     <td valign="top">
     <img border="0" src="images/CAAAfrGeomWbenchSurfacesSM.jpg" width="283" height="306"></td>
   </tr>
 </table>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="How"></a>How to Launch CAAAfrGeoCreationWbench</h4>
 <p>See the section entitled &quot;How to Launch the CAAGeometry Use Case&quot; in the &quot;<a href="../CAASysUseCases/CAASysCAAGeometryOverview.htm">The 
 CAAGeometry Sample</a>&quot; use case for a detailed description of how this use 
 case should be launched. For the specific scenario :</p>
 <p>Do not type the module name on the command line, but type CNEXT instead. 
 When the application is ready, do the following: </p>
 <ul>
   <li>Select Start-&gt;Infrastructure-&gt;CAA V5: Geometrical Creation</li>
 </ul>
 <p>This creates a new CAAGeometry document with the CAA V5: Geometrical 
 Creation workbench active. </p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="Where"></a>Where to Find the CAAAfrGeoCreationWbench Code</h4>
 <p>The CAAAfrGeoCreationWbench use case is made of classes and interfaces 
 located in the CAAAfrGeoCreationWbench.m module and in the ProtectedInterfaces 
 directory of the CAAApplicationFrame.edu framework:</p>
 <table>
   <tr>
     <td>Windows</td>
     <td><code>
     InstallRootDirectory\CAAApplicationFrame.edu\CAAAfrGeoCreationWbench.m\</code></td>
   </tr>
   <tr>
     <td>Unix</td>
     <td><code>
     InstallRootDirectory/CAAApplicationFrame.edu/CAAAfrGeoCreationWbench.m/</code></td>
   </tr>
 </table>
 <p>where <code>InstallRootDirectory</code> is the directory where the CAA 
 CD-ROM is installed.</p>
 <p>These classes and interfaces are:</p>
 <table width="100%">
   <tr>
     <td><i>CAAAfrGeoCreationWkb</i></td>
     <td>Workbench description class</td>
   </tr>
   <tr>
     <td><i>CAAAfrGeoCreationWkbFactory</i></td>
     <td>Factory class for the workbench class</td>
   </tr>
   <tr>
     <td><i>CAAIAfrGeoCreationWkbFactory</i></td>
     <td>Factory interface implemented by <i>CAAAfrGeoCreationWkbFactory</i></td>
   </tr>
   <tr>
     <td><i>TIE_CAAIAfrGeoCreationWkbFactory</i></td>
     <td>TIE class for the factory interface</td>
   </tr>
   <tr>
     <td><i>CAAIAfrGeoCreationWkbAddin</i></td>
     <td>Add-in interface exposed by the workbench and that all its add-ins must 
     implement</td>
   </tr>
   <tr>
     <td><i>TIE_CAAIAfrGeoCreationWkbAddin</i></td>
     <td>TIE class for the add-in interface</td>
   </tr>
 </table>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h3><a name="Step"></a>Step-by-Step</h3>
 <p>But before creating the workbench, you should: </p>
 <ul>
   <li>Make sure that the workshop to which it is dedicated exposes the <em>
   CATIxxxConfiguration</em> interface, where xxx is the workshop identifier, in 
   a PublicInterfaces or ProtectedInterfaces directory. This interface is 
   mandatory and you have to strictly respect its naming nomenclature, otherwise 
   the workbench won't be available.</li>
 </ul>
 <p>&nbsp;</p>
 <ul>
   <li>Create the module directory to store the workbench code along with its 
   two subdirectories LocalInterfaces and src. Then you will need to create the 
   following files.
   <table>
     <tr>
       <td colspan="3">In the framework's ProtectedInterfaces directory</td>
     </tr>
     <tr>
       <td valign="top">&nbsp;</td>
       <td valign="top">CAAIAfrGeoCreationWkbAddin.h</td>
       <td valign="top">The header file of the workbench exposed interface to 
       enable clients to create add-ins</td>
     </tr>
     <tr>
       <td colspan="3">In the CAAAfrGeoCreationWbench.m\LocalInterfaces 
       directory</td>
     </tr>
     <tr>
       <td valign="top">&nbsp;</td>
       <td valign="top">CAAIAfrGeoCreationWkbFactory.h</td>
       <td valign="top">The header file of the workbench factory interface</td>
     </tr>
     <tr>
       <td valign="top">&nbsp;</td>
       <td valign="top">CAAAfrGeoCreationWkbFactory.h</td>
       <td valign="top">The header file of the workbench factory class</td>
     </tr>
     <tr>
       <td valign="top">&nbsp;</td>
       <td valign="top">CAAAfrGeoCreationWkb.h</td>
       <td valign="top">The header file of the workbench description class</td>
     </tr>
     <tr>
       <td colspan="3">In the CAAAfrGeoCreationWbench.m\src directory</td>
     </tr>
     <tr>
       <td valign="top">&nbsp;</td>
       <td valign="top">CAAIAfrGeoCreationWkbAddin.cpp</td>
       <td valign="top">The source file of the workbench exposed interface to 
       enable clients to create add-ins</td>
     </tr>
     <tr>
       <td valign="top">&nbsp;</td>
       <td valign="top">CAAIAfrGeoCreationWkbFactory.cpp</td>
       <td valign="top">The source file of the workbench factory interface</td>
     </tr>
     <tr>
       <td valign="top">&nbsp;</td>
       <td valign="top">CAAAfrGeoCreationWkbFactory.cpp</td>
       <td valign="top">The source file of the workbench factory class</td>
     </tr>
     <tr>
       <td valign="top">&nbsp;</td>
       <td valign="top">CAAAfrGeoCreationWkb.cpp</td>
       <td valign="top">The source file of the workbench description class</td>
     </tr>
     <tr>
       <td valign="top">&nbsp;</td>
       <td valign="top">TIE_CAAIAfrGeoCreationWkbAddin.tsrc</td>
       <td valign="top">The file to create the TIE for CAAIAfrGeometryWksAddin</td>
     </tr>
     <tr>
       <td valign="top">&nbsp;</td>
       <td valign="top">TIE_CAAIAfrGeoCreationWkbFactory.tsrc</td>
       <td valign="top">The file to create the TIE for CAAIAfrGeometryWksFactory</td>
     </tr>
     <tr>
       <td colspan="3">In the dictionary, that is the CNext\code\dictionary 
       directory, referenced at run time using the CATDictionaryPath environment 
       variable, create or update</td>
     </tr>
     <tr>
       <td valign="top">&nbsp;</td>
       <td valign="top">CAAApplicationFrame.edu.dico</td>
       <td valign="top">The interface dictionary</td>
     </tr>
     <tr>
       <td valign="top">&nbsp;</td>
       <td valign="top">CAAApplicationFrame.edu.fact</td>
       <td valign="top">The factory dictionary</td>
     </tr>
     <tr>
       <td colspan="3">In the CNext\resources\msgcatalog directory, referenced 
       at run time using the CATMsgCatalogPath environment variable</td>
     </tr>
     <tr>
       <td valign="top">&nbsp;</td>
       <td valign="top">CAAAfrGeoCreationWkb.CATNls</td>
       <td valign="top">The workbench message file</td>
     </tr>
     <tr>
       <td valign="top">&nbsp;</td>
       <td valign="top">CAAAfrGeoCreationWkbHeader.CATNls and<br>CAAAfrGeoCreationWkbHeader.CATRsc</td>
       <td valign="top">The command header resource files</td>
     </tr>
   </table></li>
 </ul>
 <p>To create the CAA Geometrical Creation workbench, there are seven steps:</p>
 <table width="100%">
   <tr>
     <th>#</th>
     <th>Step</th>
     <th>Where</th>
   </tr>
   <tr>
     <td valign="top"><a href="#Step1">1</a></td>
     <td valign="top">Create the workbench factory interface</td>
     <td valign="top">LocalInterfaces and src</td>
   </tr>
   <tr>
     <td valign="top"><a href="#Step2">2</a></td>
     <td valign="top">Create the workbench factory</td>
     <td valign="top">LocalInterfaces and src</td>
   </tr>
   <tr>
     <td valign="top"><a href="#Step3">3</a></td>
     <td valign="top">Create the workbench description class</td>
     <td valign="top">LocalInterfaces and src</td>
   </tr>
   <tr>
     <td valign="top"><a href="#Step4">4</a></td>
     <td valign="top">Create the command headers</td>
     <td valign="top"><code>CreateCommands</code> method</td>
   </tr>
   <tr>
     <td valign="top"><a href="#Step5">5</a></td>
     <td valign="top">Create the workbench and arrange the commands</td>
     <td valign="top"><code>CreateWorkbench</code> method</td>
   </tr>
   <tr>
     <td valign="top"><a href="#Step6">6</a></td>
     <td valign="top">Provide the resources and insert the workbench into the 
     Start menu</td>
     <td valign="top">Resource files</td>
   </tr>
   <tr>
     <td valign="top"><a href="#Step7">7</a></td>
     <td valign="top">Create the workbench exposed interface</td>
     <td valign="top">ProtectedInterfaces and src</td>
   </tr>
 </table>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="Step1"></a>Creating the Workbench Factory Interface</h4>
 <p>This factory interface is named <em>CAAIAfrGeoCreationWkbFactory</em>. To 
 create this interface, create: </p>
 <ol>
   <li>The header file</li>
   <li>The source file</li>
   <li>The TIE tsrc file.</li>
 </ol>
 <p>This is shown below. </p>
 <ol>
   <li>Its header file CAAIAfrGeoCreationWkbFactory.h is as follows<br>
   <table class="code">
     <tr>
       <td>
       <pre>#include &lt;CATIGenericFactory.h&gt; 

extern IID <strong>IID_CAAIAfrGeoCreationWkbFactory</strong>;

class CAAIAfrGeoCreationWkbFactory : public <strong>CATIGenericFactory</strong>
{
  <strong>CATDeclareInterface</strong>;
  public :
};</pre>
       </td>
     </tr>
   </table>
   <p>A factory interface is a CAA interface, that is, an abstract class that 
   derives from <em>CATIGenericFactory</em>. As any interface, it has an IID 
   declared as IID_ followed by the interface name, and includes the <code>
   CATDeclareInterface</code> macro that declares that this abstract class is an 
   interface. No additional method than those of <em>CATIGenericFactory</em> is 
   necessary. Don't forget the public keyword required by the TIE compiler.</li>
   <li>Its source file CAAIAfrGeoCreationWkbFactory.cpp is as follows.
   <table class="code">
     <tr>
       <td>
       <pre>#include &lt;CAAIAfrGeoCreationWkbFactory.h&gt;

IID IID_CAAIAfrGeoCreationWkbFactory = <strong>{
    0xb32eed10,
    0xd4c1,
    0x11d3,
    {0xb7, 0xf5, 0x00, 0x08, 0xc7, 0x4f, 0xe8, 0xdd}
  };</strong>

<strong>CATImplementInterface</strong>(CAAIAfrGeoCreationWkbFactory, CATIGenericFactory);</pre>
       </td>
     </tr>
   </table>
   <p>This file includes a GUID [<a href="#References">1</a>], shown in bold 
   typeface. The <code>CATImplementInterface</code> macro is used in conjunction 
   with <code>CATDeclareInterface</code> in the header file to make an interface 
   from this abstract class and to declare that it OM-derives from <em>
   CATIGenericfactory</em>.</li>
   <li>Create a file named TIE_CAAIAfrGeoCreationWkbFactory.tsrc in the src 
   directory, and containing:
   <table class="code">
     <tr>
       <td>
       <pre>#include &quot;CAAIAfrGeoCreationWkbFactory.h&quot;</pre>
       </td>
     </tr>
   </table>
   <p>The Multi-Workspace Application Builder (mkmk) will generate the TIE for 
   this interface for you, that is, the TIE_CAAIAfrGeoCreationWkbFactory.h file 
   in the ProtectedGenerated directory.</li>
 </ol>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="Step2"></a>Creating the Workbench Factory</h4>
 <p>&nbsp;<img src="../CAAIcons/images/warning.gif" alt="warning.gif (206 bytes)" width="30" height="30">The 
 factory class that creates workbench instances must concatenate the name of the 
 class to instantiate, that is, the workbench description class <strong>
 CAAAfrGeoCreationWkb</strong>, with the string <strong>Factory</strong>. This 
 gives <strong>CAAAfrGeoCreationWkbFactory.</strong></p>
 <p>To create this class, create: </p>
 <ol>
   <li>The header file, using the <code>CATDeclareConfigurationFactory</code> 
   macro</li>
   <li>The source file, using the <code>CATImplementConfigurationFactory</code> 
   macro</li>
   <li>Update the interface dictionary and the factory dictionary.</li>
 </ol>
 <ol>
   <li>Create the CAAAfrGeoCreationWkbFactory.h header file.
   <table class="code">
     <tr>
       <td>
       <pre>#include &quot;CATWorkshopConfigurationFactory.h&quot; 

CATDeclareConfigurationFactory(CAAAfrGeoCreationWkb);</pre>
       </td>
     </tr>
   </table>
   <p>The <code>CATDeclareConfigurationFactory</code> macro argument is the name 
   of the workbench description class.&nbsp;</li>
   <li>Create the CAAAfrGeoCreationWkbFactory.cpp file.
   <table class="code">
     <tr>
       <td>
       <pre>#include &lt;CAAAfrGeoCreationWkb.h&gt;
#include &lt;CAAAfrGeoCreationWkbFactory.h&gt;

#include &lt;TIE_CAAIAfrGeoCreationWkbFactory.h&gt;

CATImplementConfigurationFactory(CAAAfrGeoCreationWkb,
                                 CAAIAfrGeoCreationWkbFactory);</pre>
       </td>
     </tr>
   </table>
   <p>The <code>CATImplementConfigurationFactory</code> arguments are the name 
   of the workbench description class and the name of the workbench factory 
   interface respectively. The <code>CATDeclareConfigurationFactory</code> and
   <code>CATImplementConfigurationFactory</code> macros create the workbench 
   factory implementation class as a data extension of the <em>
   CATApplicationFrame</em> component</li>
   <li>You should now update the two dictionary files:
   <ul>
     <li>The <em>interface dictionary</em>, that is a file whose name is the 
     framework name suffixed by dico, such as CAAApplicationFrame.dico, and that 
     you should create or update in the framework CNext/code/dictionary 
     directory. The interface dictionary contains the following declaration to 
     state that the <em>CATApplicationFrame</em> component implements the <em>
     CAAIAfrGeoCreationWkbFactory</em> interface, by means of the extension 
     class created by the macros, whose code is located in the 
     libCAAAfrGeoCreationWbench shared library or DLL:<br>
     <table class="code">
       <tr>
         <td>
         <pre>CATApplicationFrame  CAAIAfrGeoCreationWkbFactory  libCAAAfrGeoCreationWbench</pre>
         </td>
       </tr>
     </table>
     </li>
     <li>The <em>factory dictionary</em>, that is a file whose name is the 
     framework name suffixed by fact, such as CAAApplicationFrame.fact, and that 
     you should create or update in the framework CNext/code/dictionary 
     directory. The factory dictionary contains the following declaration to 
     state that the <em>CAAIAfrGeoCreationWkbFactory</em> interface is an 
     interface to a factory whose implementation creates a <em>
     CAAAfrGeoCreationWkb</em> class instance:
     <table class="code">
       <tr>
         <td>
         <pre>CAAAfrGeoCreationWkb CAAIAfrGeoCreationWkbFactory</pre>
         </td>
       </tr>
     </table>
     </li>
   </ul>
   <p>At run time, the pathname of the directory that contains these 
   dictionaries files is concatenated to other dictionary pathnames in the 
   CATDictionaryPath environment variable.</li>
 </ol>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="Step3"></a>Creating the Workbench Description Class</h4>
 <p>The <em>CAAAfrGeoCreationWkb</em> class implements the <em>
 CATICAAAfrGeometryWksConfiguration</em> interface exposed by the CAAGeometry 
 workshop . It includes the following methods: </p>
 <ul>
   <li><code>CreateCommands</code> to instantiate the command headers for the 
   commands of the workbench</li>
   <li><code>CreateWorkbench</code> to create the containers for the workbench, 
   the menus, and the toolbars, and arrange the commands in the menus and 
   toolbars</li>
   <li><code>GetCustomInterface</code>s which returns the names of the 
   interfaces exposed by the workbench to enable its customization</li>
   <li><code>GetAddinInterface</code> which returns the name of the interface 
   exposed by the workbench to create add-ins.</li>
 </ul>
 <p>You should: </p>
 <ul>
   <li>Create the header and source files for the <em>CAAAfrGeoCreationWkb</em> 
   class</li>
   <li>Update the dictionary.</li>
 </ul>
 <ol>
   <li>Create the CAAAfrGeoCreationWkb.h file
   <table class="code">
     <tr>
       <td>
       <pre>#include &quot;CATBaseUnknown.h&quot;
#include &quot;CATListPV.h&quot;

class CATCmdWorkbench;

class CAAAfrGeoCreationWkb : public CATBaseUnknown
{
  CATDeclareClass;
  public:
     CAAAfrGeoCreationWkb();
     virtual ~CAAAfrGeoCreationWkb();

     void              CreateCommands();
     CATCmdWorkbench * CreateWorkbench();
     CATClassId        GetAddinInterface();
     void              GetCustomInterfaces(CATListPV * oDefaultIIDList , 
                                           CATListPV * oCustomIIDList) ;
  private:
     CAAAfrGeoCreationWkb(const CAAAfrGeoCreationWkb &amp;iObjectToCopy);
};</pre>
       </td>
     </tr>
   </table>
   <p>The <i>CAAAfrGeoCreationWkb</i> class C++-derives from <i>CATBaseUnknown</i>. 
   The <code>CATDeclareClass</code> macro declares that the class <i>
   CAAAfrGeoCreationWkb</i> belongs to a component. The class has a constructor, 
   a destructor, the four methods of the <i>CATIWorkbench</i> interface, and a 
   copy constructor. Note that the copy constructor is set as private. This 
   prevents the compiler from creating the copy constructor as public without 
   you know. This copy constructor is not implemented in the source file.</li>
   <li>Create the CAAAfrGeoCreationWkb.cpp file. The file skeleton is shown 
   below. The implementation of each method is described in separate sections.
   <table class="code">
     <tr>
       <td>
       <pre>#include &lt;CAAAfrGeoCreationWkb.h&gt;

#include &lt;CATCommandHeader.h&gt; // See <a href="#Step4">Creating the Command Headers</a>
MacDeclareHeader(CAAAfrGeoCreationWkbHeader);

#include &lt;CATCreateWorkshop.h&gt;

CATImplementClass(CAAAfrGeoCreationWkb, Implementation, CATBaseUnknown, CATNull);
#include &lt;TIE_CATICAAAfrGeometryWksConfiguration.h&gt; 
TIE_CATICAAAfrGeometryWksConfiguration(CAAAfrGeoCreationWkb);

CAAAfrGeoCreationWkb::CAAAfrGeoCreationWkb() {}
CAAAfrGeoCreationWkb::~CAAAfrGeoCreationWkb() {}

void CAAAfrGeoCreationWkb::CreateCommands()
{
  ...  // See <a href="#Step4">Creating the Command Headers</a>
}

CATCmdWorkbench * CAAAfrGeoCreationWkb::CreateWorkbench()
{
  ...  // See <a href="#Step5">Creating the Workbench and Arranging the Commands</a>
}

CATClassId CAAAfrGeoCreationWkb::GetAddinInterface()
{
  return &quot;CAAIAfrGeoCreationWkbAddin&quot;;
}

void CAAAfrGeoCreationWkb::GetCustomInterfaces(CATListPV * oDefaultIIDList,
                                               CATListPV * oCustomIIDList)
{}</pre>
       </td>
     </tr>
   </table>
   <p>The <i>CAAAfrGeoCreationWkb</i> class states that it implements the <em>
   CATICAAAfrGeometryWksConfiguration</em> interface thanks to the <code>
   TIE_CATICAAAfrGeometryWksConfiguration</code> macro. The <code>
   CATImplementClass</code> macro declares that the <i>CAAAfrGeoCreationWkb</i> 
   class is a component main class [<a href="#References">2</a>], thanks to the
   <code>Implementation</code> keyword, and that it OM-derives from 
   CATBaseUnknown [<a href="#References">2</a>]. The fourth parameter must 
   always be set to <code>CATNull</code> for component main classes.</p>
   <p>The <code>GetCustomInterfaces</code> method must be empty. The names of 
   the interface exposed by the workbench to enable clients to create add-ins is 
   returned by the <code>GetAddinInterface</code> method. See <a href="#Step7">
   Creating the Workbench Exposed Interface</a> to create this interface.</li>
   <li>Updating the Dictionary
   <p>Update the interface dictionary, that is a file named, for example, 
   CAAApplicationFrame.dico, whose directory's pathname is concatenated at run 
   time in the CATDictionaryPath environment variable, and containing the 
   following declaration to state that the <em>CAAAfrGeoCreationWkb</em> class 
   implements the <em>CATICAAAfrGeometryWksConfiguration</em> interface, and 
   whose code is located in the libCAAAfrGeoCreationWbench shared library or 
   DLL. The update is in bold typeface:</p>
   <table class="code">
     <tr>
       <td>
       <pre>CATApplicationFrame  CAAIAfrGeoCreationWkbFactory         libCAAAfrGeoCreationWbench
<strong>CAAAfrGeoCreationWkb CATICAAAfrGeometryWksConfiguration   libCAAAfrGeoCreationWbench</strong></pre>
       </td>
     </tr>
   </table>
   </li>
 </ol>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="Step4"></a>Creating the Command Headers</h4>
 <p>This is done by the <code>CreateCommands</code> method. Each command 
 available in your workbench must have a command header. A command header is an 
 instance of a command header class, and different commands can share the same 
 command header class to create their command header. Refer to The Command 
 Headers for more details.</p>
 <p>A single command header class is created for the commands, named 
 CAAAfrGeoCreationWkbHeader using the <code>MacDeclareHeader</code> macro. You 
 can also create the class more classically if the command may be sometimes 
 unavailable. This is described in The Command Headers. </p>
 <ol>
   <li>Create the CAAAfrGeoCreationWkbHeader command header class. To do this, 
   add the following in CAAAfrGeoCreationWkb.cpp:
   <table class="code">
     <tr>
       <td>
       <pre>#include &lt;CATCommandHeader.h&gt;
MacDeclareHeader(CAAAfrGeoCreationWkbHeader);</pre>
       </td>
     </tr>
   </table>
   <p>The <code>MacDeclareHeader</code> macro creates the header file and the 
   source file for the CAAAfrGeoCreationWkbHeader class, and associates with 
   this class the resource files CAAAfrGeoCreationWkbHeader.CATNls and 
   CAAAfrGeoCreationWkbHeader.CATRsc. See <a href="#Step6">Providing the 
   Resources and Inserting the Workbench into the Start Menu</a>.</li>
   <li>Create the code to instantiate your command headers in the empty <code>
   CreateCommands</code> method. This method should contain one instantiation 
   statement of the command header class per command. Each statement has the 
   following form, for example for the Cuboid command.
   <table class="code">
     <tr>
       <td>
       <pre>void CAAAfrGeoCreationWkb::CreateCommands()
{
  ...
  new CAAAfrGeoCreationWkbHeader(&quot;CAAAfrCuboidHdr&quot;,
                                 &quot;CAADegGeoCommands&quot;,
                                 &quot;CAADegCreateCuboidCmd&quot;,
                                 (void *) NULL);
  ...
}  </pre>
       </td>
     </tr>
   </table>
   <p>The command header constructor has the following arguments:
   <ul>
     <li><code>CAAAfruboidHdr</code> is the identifier you need to assign to the 
     command header. It will be used afterwards:
     <ul>
       <li>To associate the command starters you will define to put the command 
       in a menu and in toolbars with the command header. This is done for this 
       workbench in <a href="#Step5">Creating the Workbench and Arranging the 
       Commands</a>.</li>
       <li>To build the variables that define the command header resources, such 
       as the name seen by the end user in his/her own language in the menu, or 
       the icon to display in a toolbar. This is explained in <a href="#Step6">
       Providing the Resources and Inserting the Workbench into the Start Menu</a></li>
     </ul>
     </li>
     <li><code>CAADegGeoCommands</code> is the name of the shared library or DLL 
     containing the Cuboid command's code, without the prefix lib, and without 
     the suffix depending on the operating system.</li>
     <li><code>CAADegCreateCuboidCmd</code> is the name of the Cuboid command 
     class</li>
     <li>the last argument is the possible pointer to the object to pass to the 
     command when executing it. It is often a character string that indicates 
     the action to carry out when the same command can perform several actions 
     depending on the active document and data, such as &quot;update&quot; or &quot;update 
     all&quot;, or &quot;cut&quot; or &quot;copy&quot;.</li>
   </ul>
   </li>
 </ol>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="Step5"></a>Creating the Workbench and Arranging the Commands</h4>
 <p>This is the job of the <code>CreateWorkbench</code> method. To understand 
 how to do, let's remind of what the workbench is made of.</p>
 <p><img border="0" src="images/CAAAfrGeomWbench1.gif" width="595" height="512"></p>
 <p>You should create: </p>
 <ul>
   <li>The <a href="#510000">workbench</a></li>
   <li>The command <a href="#520000">containers</a> for the toolbars and the 
   menu bar</li>
   <li>The content of the <a href="#530000">Solids</a> toolbar</li>
   <li>The content of the <a href="#540000">Surfaces</a> toolbar</li>
   <li>The content of the <a href="#550000">menu bar</a>.</li>
 </ul>
 <ol>
   <!---------------------------------comment------------------------------------->
   <li><a name="510000"></a>Creating the Workbench
   <p>The workbench contains its toolbars and its menu bar. Create the workbench 
   as an instance of the <i>CATCmdWorkbench</i> class using the <code>NewAccess</code> 
   macro.</p>
   <table class="code">
     <tr>
       <td>
       <pre>CATCmdWorkbench * <strong>CAAAfrGeoCreationWkb</strong>::CreateWorkbench()
{
  NewAccess(CATCmdWorkbench,pCAAAfrGeoCreationWkb,<strong>CAAAfrGeoCreationWkb</strong>);
  ... // See <a href="#520000">Creating the Containers for the Toolbars and the Menu Bar</a>
  return pCAAAfrGeoCreationWkb;
}</pre>
       </td>
     </tr>
   </table>
   <p><code>pCAAAfrGeoCreationWkb</code> is the variable used to handle the 
   workbench instance pointer, and <code><b>CAAAfrGeoCreationWkb</b></code> is 
   the workbench identifier. Note that the workbench class name and the 
   workbench identifier must be identical to take into account the workbench 
   resources in the Start menu. They appear both in bold typeface. This 
   identifier is also used to name the workbench resource files 
   CAAAfrGeoCreationWkb.CATNls and CAAAfrGeoCreationWkb.CATRsc. The workbench 
   resources, and how to provide them, are described in Creating Resources for 
   Workbenches. See also <a href="#Step6">Providing the Resources and Inserting 
   the Workbench into the Start Menu</a> for an overview of all the resources to 
   create.</p>
   </li>
   <!---------------------------------comment------------------------------------->
   </li>
   <li><a name="520000"></a>Creating the Containers for the Toolbars and the 
   Menu Bar
   <p>The toolbars and the menu bar are in turn containers for the commands and 
   submenus.</p>
   <p>
   <img border="0" src="images/CAAAfrGeomWbench2.gif" width="610" height="233"></p>
   <p>The code to create the toolbars and the menu bar is the following:</p>
   <table class="code">
     <tr>
       <td>
       <pre>...
    NewAccess(<strong>CATCmdContainer</strong>,pCAAAfrSolidEltTlb,CAAAfrSolidEltTlb);
    SetAccessChild(pCAAAfrGeoCreationWkb, pCAAAfrSolidEltTlb);
    ...  // See <a href="#530000">Creating the Solids Toolbar Content</a>
    AddToolbarView(pCAAAfrSolidEltTlb,1,Right);

    NewAccess(<strong>CATCmdContainer</strong>,pCAAAfrSurfacicEltTlb,CAAAfrSurfacicEltTlb);
    SetAccessNext(pCAAAfrSolidEltTlb,pCAAAfrSurfacicEltTlb);
    ...  // See <a href="#540000">Creating the Surfaces Toolbar Content</a>
    AddToolbarView(pCAAAfrSurfacicEltTlb,-1,Right);

    NewAccess(<strong>CATCmdContainer</strong>,pCAAAfrGeoCreationMbr,CAAAfrGeoCreationMbr);
    ...  // See <a href="#550000">Creating the Menu Bar Content</a>
    SetWorkbenchMenu(pCAAAfrGeoCreationWkb,pCAAAfrGeoCreationMbr);
...</pre>
       </td>
     </tr>
   </table>
   <p>Here is what's happen:
   <ul>
     <li>The Solids toolbar is created as an instance of the <i>CATCmdContainer</i> 
     class using the <code>NewAccess</code> macro. <code>pCAAAfrSolidEltTlb</code> 
     is the variable used to handle the Solids toolbar command container 
     instance pointer, and <code>CAAAfrSolidEltTlb</code> is the identifier used 
     to refer to it in the workbench resource files. This identifier must be 
     unique among all the toolbar identifiers that can be found within the 
     application. The Solids toolbar is set as the child of the workbench using 
     the <code>SetAccessChild</code> macro, and its default location is defined 
     using the <code>AddToolbarView</code> macro, where <code>1</code> means 
     that the Solids toolbar is visible by default (<code>-1</code> means 
     invisible), and <code>Right</code> means that the toolbar is docked at the 
     right side of the application window.</li>
     <li>The Surfaces toolbar is created in the same way, but it is set next to 
     the Solids toolbar using the <code>SetAccessNext</code> macro. It is 
     invisible (-1 means invisible) by default, and is also docked at the right 
     side of the application window.</li>
     <li>The menu bar is also created as an instance of the <i>CATCmdContainer</i> 
     class and is referred to using the <code>pCAAAfrGeoCreationMbr</code> 
     pointer. Its identifier is <code>CAAAfrGeoCreationMbr</code> and is used 
     for its resources. It is set as the workbench's menu bar using the <code>
     SetWorkbenchMenu</code> macro.</li>
   </ul>
   <p>The toolbar resources, and how to provide them, are described in Creating 
   Resources for Workbenches. See also <a href="#Step6">Providing the Resources 
   and Inserting the Workbench into the Start Menu</a> for an overview of all 
   the resources to create.</p>
   </li>
   <!---------------------------------comment------------------------------------->
   </li>
   <li><a name="530000"></a>Creating the Solids Toolbar Content
   <p>
   <img border="0" src="images/CAAAfrGeomWbench3.gif" width="289" height="136"></p>
   <p>This toolbar contains four commands: Cuboid, Sphere, Torus, and Cylinder. 
   You should, for each command:
   <ol>
     <li>Create a command starter using the <code>NewAccess</code> macro</li>
     <li>Associate the command starter, using the <code>SetAccessCommand</code> 
     macro, with the appropriate command header identifier defined in the <code>
     CreateCommands</code> method</li>
     <li>Arrange the command starters in the toolbar using the <code>
     SetAccessChild</code> and <code>SetAccessNext</code> macros</li>
   </ol>
   <table class="code">
     <tr>
       <td>
       <pre>...
      NewAccess(CATCmdStarter,pCAAAfrTSolidEltCuboidStr,CAAAfrTSolidEltCuboidStr);
      SetAccessCommand(pCAAAfrTSolidEltCuboidStr,&quot;CAAAfrCuboidHdr&quot;);
      SetAccessChild(pCAAAfrSolidEltTlb,pCAAAfrTSolidEltCuboidStr);

      NewAccess(CATCmdStarter,pCAAAfrTSolidEltSphereStr,CAAAfrTSolidEltSphereStr);
      SetAccessCommand(pCAAAfrTSolidEltSphereStr,&quot;CAAAfrSphereHdr&quot;);
      SetAccessNext(pCAAAfrTSolidEltCuboidStr,pCAAAfrTSolidEltSphereStr);

      NewAccess(CATCmdStarter,pCAAAfrTSolidEltTorusStr,CAAAfrTSolidEltTorusStr);
      SetAccessCommand(pCAAAfrTSolidEltTorusStr,&quot;CAAAfrTorusHdr&quot;);
      SetAccessNext(pCAAAfrTSolidEltSphereStr,pCAAAfrTSolidEltTorusStr);

      NewAccess(CATCmdStarter,pCAAAfrTSolidEltCylinder1Str,CAAAfrTSolidEltCylinder1Str);
      SetAccessCommand(pCAAAfrTSolidEltCylinder1Str,&quot;CAAAfrCylinder1Hdr&quot;);
      SetAccessNext(pCAAAfrTSolidEltTorusStr,pCAAAfrTSolidEltCylinder1Str);
         
      NewAccess(CATCmdStarter,pCAAAfrTSolidEltCylinder2Str,CAAAfrTSolidEltCylinder2Str);
      SetAccessCommand(pCAAAfrTSolidEltCylinder2Str,&quot;CAAAfrCylinder2Hdr&quot;);
      SetAccessNext(pCAAAfrTSolidEltCylinder1Str,pCAAAfrTSolidEltCylinder2Str);
...</pre>
       </td>
     </tr>
   </table>
   <p>Three macros are required for each command. For example, the Cuboid 
   command is processed as follows:
   <ol>
     <li>First create the command starter as a <i>CATCmdStarter</i> instance 
     using the <code>NewAccess</code> macro. <code>pCAAAfrTSolidEltCuboidStr</code> 
     is the variable used to handle a pointer to that instance, and <code>
     CAAAfrTSolidEltCuboidStr</code> is its identifier.</li>
     <li>Then associate the Cuboid command header with this command starter 
     using the <code>SetAccessCommand</code> macro. The second parameter is the 
     Cuboid command header identifier defined as the first parameter of the 
     command header consrtuctor. Refer to <a href="#Step4">Creating the Command 
     Headers</a></li>
     <li>Finally set the Cuboid command starter as the child of the Solids 
     toolbar.</li>
   </ol>
   <p>Proceed in the same way for the other commands, except that they are set 
   as next of one another using the <code>SetAccessNext</code> macro.</p>
   </li>
   <!---------------------------------comment------------------------------------->
   </li>
   <li><a name="540000"></a>Creating the Surfaces Toolbar Content
   <p>
   <img border="0" src="images/CAAAfrGeomWbench4.gif" width="253" height="132"></p>
   <p>This toolbar contains three commands: Revolution Surface, Nurbs Surface, 
   and Offset Surface. You should, for each command:
   <ol>
     <li>Create a command starter using the <code>NewAccess</code> macro</li>
     <li>Associate the command starter, using the <code>SetAccessCommand</code> 
     macro, with the appropriate command header identifier defined in the <code>
     CreateCommands</code> method</li>
     <li>Arrange the command starters in the toolbar using the <code>
     SetAccessChild</code> and <code>SetAccessNext</code> macros</li>
   </ol>
   <table class="code">
     <tr>
       <td>
       <pre>...
    NewAccess(CATCmdStarter,pCAAAfrTSurfRevolStr,CAAAfrTSurfRevolStr);
    SetAccessCommand(pCAAAfrTSurfRevolStr,&quot;CAAAfrRevolSurfHdr&quot;);
    SetAccessChild(pCAAAfrSurfacicEltTlb,pCAAAfrTSurfRevolStr);

    NewAccess(CATCmdStarter,pCAAAfrTSurfNurbsStr,CAAAfrTSurfNurbsStr);
    SetAccessCommand(pCAAAfrTSurfNurbsStr,&quot;CAAAfrNurbsSurfHdr&quot;);
    SetAccessNext(pCAAAfrTSurfRevolStr,pCAAAfrTSurfNurbsStr);

    NewAccess(CATCmdStarter,pCAAAfrTSurfOffsetStr,CAAAfrTSurfOffsetStr);
    SetAccessCommand(pCAAAfrTSurfOffsetStr,&quot;CAAAfrOffsetSurfHdr&quot;);
    SetAccessNext(pCAAAfrTSurfNurbsStr,pCAAAfrTSurfOffsetStr);
...</pre>
       </td>
     </tr>
   </table>
   <p>Three macros are required for each command. For example, the Revolution 
   Surface command is processed as follows:
   <ol>
     <li>First create the command starter as a <i>CATCmdStarter</i> instance 
     using the <code>NewAccess</code> macro. <code>pCAAAfrTSurfRevolStr</code> 
     is the variable used to handle a pointer to that instance, and <code>
     CAAAfrTSurfRevolStr</code> is its identifier.</li>
     <li>Then associate the Revolution Surface command header with this command 
     starter using the <code>SetAccessCommand</code> macro. The second parameter 
     is the Revolution Surface command header identifier defined as the first 
     parameter of the command header consrtuctor. Refer to <a href="#Step4">
     Creating the Command Headers</a></li>
     <li>Finally set the Revolution Surface command starter as the child of the 
     Surfaces toolbar.</li>
   </ol>
   <p>Proceed in the same way for the other commands, except that they are set 
   as next of one another using the <code>SetAccessNext</code> macro.</p>
   </li>
   <!---------------------------------comment------------------------------------->
   </li>
   <li><a name="550000"></a>Creating the Menu Bar Content
   <p>Menus and submenus are created as CATCmdContainer instances, and menu 
   items as CATCmdStarter instances. The menu bar you create will be merged when 
   the workbench is loaded or activated at run time with the workshop menu bar, 
   itself resulting in the merge of the default menu bar, that is, the one that 
   exists when no document is active, with the one defined for the workshop.
   <font FACE="Times New Roman">You can neither remove a menu from the default 
   menu bar or from the menu bar defined for the workshop, nor change the menu 
   order, nor modify an existing menu item , nor add a submenu to an existing 
   menu item.You can only add an item at first level of an existing menu with a 
   submenu or not.</p>
   </font>
   <p>&nbsp;</p>
   <p>
   <img border="0" src="images/CAAAfrGeomWbench5.gif" width="495" height="618"></p>
   <p>You should:
   <ol>
     <li>Create a command container for each menu and submenu using the <code>
     NewAccess</code> macro</li>
     <li>Create a command starter for each command using the <code>NewAccess</code>macro</li>
     <li>Associate each command starter, using the <code>SetAccessCommand</code> 
     macro, with the appropriate command header identifier defined in the <code>
     CreateCommands</code> method</li>
     <li>Arrange the command starters in the menu using the <code>SetAccessChild</code>, 
     and <code>SetAccessNext</code> macros</li>
   </ol>
   <p><strong>Insert Menu - Solids Submenu</strong></p>
   <table class="code">
     <tr>
       <td>
       <pre>...
    NewAccess(CATCmdContainer,pCATAfrInsertMnu,CATAfrInsertMnu);
    SetAccessChild(pCAAAfrGeoCreationMbr,pCATAfrInsertMnu);

      NewAccess(CATCmdSeparator,pCAAAfrGeoCreationInsertSep,CAAAfrGeoCreationInsertSep);
      SetAccessChild(pCATAfrInsertMnu,pCAAAfrGeoCreationInsertSep);

      NewAccess(CATCmdContainer,pCAAAfrSolidEltSnu,CAAAfrSolidEltSnu);
      SetAccessNext(pCAAAfrGeoCreationInsertSep,pCAAAfrSolidEltSnu);

        NewAccess(CATCmdStarter,pCAAAfrMSolidCuboidStr,CAAAfrMSolidCuboidStr);
        SetAccessChild(pCAAAfrSolidEltSnu,pCAAAfrMSolidCuboidStr);
        SetAccessCommand(pCAAAfrMSolidCuboidStr,&quot;CAAAfrCuboidHdr&quot;);

        NewAccess(CATCmdStarter,pCAAAfrMSolidSphereStr,CAAAfrMSolidSphereStr);
        SetAccessNext(pCAAAfrMSolidCuboidStr,pCAAAfrMSolidSphereStr);
        SetAccessCommand(pCAAAfrMSolidSphereStr,&quot;CAAAfrSphereHdr&quot;);
			    
        NewAccess(CATCmdStarter,pCAAAfrMSolidTorusStr,CAAAfrMSolidTorusStr);
        SetAccessNext(pCAAAfrMSolidSphereStr,pCAAAfrMSolidTorusStr);
        SetAccessCommand(pCAAAfrMSolidTorusStr,&quot;CAAAfrTorusHdr&quot;);

        NewAccess(CATCmdStarter,pCAAAfrMSolidCylinder1Str,CAAAfrMSolidCylinder1Str);
        SetAccessNext(pCAAAfrMSolidTorusStr,pCAAAfrMSolidCylinder1Str);
        SetAccessCommand(pCAAAfrMSolidCylinder1Str,&quot;CAAAfrCylinder1Hdr&quot;);
            
        NewAccess(CATCmdStarter,pCAAAfrMSolidCylinder2Str,CAAAfrMSolidCylinder2Str);
        SetAccessNext(pCAAAfrMSolidCylinder1Str,pCAAAfrMSolidCylinder2Str);
        SetAccessCommand(pCAAAfrMSolidCylinder2Str,&quot;CAAAfrCylinder2Hdr&quot;);
...</pre>
       </td>
     </tr>
   </table>
   <p>The Insert menu command container is created, even if it already exists. 
   Then the Solids submenu command container is created and set as the child of 
   the Insert menu command container. Since no other positioning information is 
   given, it should lay below the last submenu or command of the workshop menu 
   bar, that is the Plane command. Then the Cuboid command starter is created 
   and set as the child of the Solids submenu command container, and the others 
   are cretaed and set next of one another.</p>
   <p><strong>Insert Menu - Surfaces Submenu</strong></p>
   <table class="code">
     <tr>
       <td>
       <pre>...
      NewAccess(CATCmdContainer,pCAAAfrSurfacicEltSnu,CAAAfrSurfacicEltSnu) ;
      SetAccessNext(pCAAAfrSolidEltSnu,pCAAAfrSurfacicEltSnu);

        NewAccess(CATCmdStarter,pCAAAfrMSurfRevolStr,CAAAfrMSurfRevolStr);
        SetAccessChild(pCAAAfrSurfacicEltSnu,pCAAAfrMSurfRevolStr);
        SetAccessCommand(pCAAAfrMSurfRevolStr,&quot;CAAAfrRevolSurfHdr&quot;);

        NewAccess(CATCmdStarter,pCAAAfrMSurfNurbsStr,CAAAfrMSurfNurbsStr);
        SetAccessNext(pCAAAfrMSurfRevolStr,pCAAAfrMSurfNurbsStr);
        SetAccessCommand(pCAAAfrMSurfNurbsStr,&quot;CAAAfrNurbsSurfHdr&quot;);

        NewAccess(CATCmdStarter,pCAAAfrMSurfOffsetStr,CAAAfrMSurfOffsetStr);
        SetAccessNext(pCAAAfrMSurfNurbsStr,pCAAAfrMSurfOffsetStr);
        SetAccessCommand(pCAAAfrMSurfOffsetStr,&quot;CAAAfrOffsetSurfHdr&quot;);
...</pre>
       </td>
     </tr>
   </table>
   <p>The Surfaces submenu command container is created and set next to the 
   Solids submenu command container. Then the Revolution Surface command starter 
   is created and set as the child of the Surfaces submenu command container, 
   and the others are cretaed and set next of one another.</p>
   <p>The menu and submenu resources, and how to provide them, are described in 
   Creating Resources for Workbenches. See also <a href="#Step6">Providing the 
   Resources and Inserting the Workbench into the Start Menu</a> for an overview 
   of all the resources to create.</li>
 </ol>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="Step6"></a>Providing the Resources and Inserting the Workbench 
 into the Start Menu</h4>
 <p>You should provide the resources for the workbench and for all its contents. 
 These resources are classified as follows:</p>
 <ul>
   <li>The workbench and command container resources, located into the two 
   workbench resource files:
   <ol>
     <li>The resource file containing the title and help messages in the English 
     language, and that can be translated into other languages. It is suffixed 
     using CATNls</li>
     <li>The resource file containing the icons and other resources that should 
     not be translated. It suffixed by CATRsc</li>
   </ol>
   <p>The resource files must have the workbench identifier as file name, that 
   is CAAAfrGeoCreationWkb. This identifier is declared in the <code>
   CreateWorkbench</code> method of the workbench description class, as the 
   third parameter of the <code>NewAccess</code> macro that creates the 
   workbench.</p>
   <table class="code">
     <tr>
       <td>
       <pre>NewAccess(CATCmdWorkbench,pCAAAfrGeoCreationWkb,<strong>CAAAfrGeoCreationWkb</strong>);</pre>
       </td>
     </tr>
   </table>
   <p>The workbench resource files are then CAAAfrGeoCreationWkb.CATNls and 
   CAAAfrGeoCreationWkb.CATRsc. These files are located in the 
   CNext\resources\msgcatalog directory of the framework containing the 
   workbench module. This directory includes subdirectories, one for each 
   language into which the title and messages of the CAAAfrGeoCreationWkb.CATNls 
   file can be translated. The resource files contain:
   <ul>
     <li>Workbench: the title, messages, and icons to be displayed in the
     <strong>Start menu</strong></li>
     <li>Toolbars: their titles</li>
     <li>Menus and submenus: their titles, icons, and mnemonics</li>
     <li>Icon boxes: their titles.</li>
   </ul>
   <p>Each resource is provided using a key and a text, or a file name without 
   suffix, separated by the equal sign. The key is built as a concatenation of 
   the object identifier you defined as the third parameter of the <code>
   NewAccess</code> macro, a dot, and a keyword designating the appropriate 
   resource. The message is enclosed using double quotes and ended using a 
   semicolon. For example, the CAAAfrGeoCreationWkb workbench title is defined 
   as follows:</p>
   <table class="code">
     <tr>
       <td>
       <pre>CAAAfrGeoCreationWkb.Title     = &quot;CAA V5: Geometrical Creation&quot;;</pre>
       </td>
     </tr>
   </table>
   <ul>
     <li>The CAAAfrGeoCreationWkb.CATNls file
     <p>This file contains:
     <ul>
       <li>The resources for the workbench itself: the title used in the <strong>
       Start menu</strong>, its associated help message, the short help 
       displayed when the mouse is over the workbench icon, and the long help</li>
       <li>The titles of the toolbars and icon boxes</li>
       <li>The titles and mnemonics of the menus and submenus.</li>
     </ul>
     <p>The CAAAfrGeoCreationWkb.CATNls, is as follows:</p>
     <table class="code">
       <tr>
         <td>
         <pre>//----------------------------------------------------------------------------
// WORKBENCH
//----------------------------------------------------------------------------
CAAAfrGeoCreationWkb.Title      = &quot;CAA V5: Geometrical Creation&quot;;
CAAAfrGeoCreationWkb.ShortHelp  = &quot;Workbench to create Geometrical Elements&quot;;
CAAAfrGeoCreationWkb.Help       = &quot;Workbench to create Geometrical, Solid and Surfacic Elements&quot;;
CAAAfrGeoCreationWkb.LongHelp   = &quot;This is the CAA V5: Geometrical Creation Workbench. 
It is used to demonstrate workbenches.
It contains two toolsbars:
- One for some Solid Elements
- The other for some Surfacic Elements&quot;;

//----------------------------------------------------------------------------
// TOOLBAR 
//---------------------------------------------------------------------------- 
CAAAfrSolidEltTlb.Title        = &quot;Solids&quot; ;
CAAAfrSurfacicEltTlb.Title     = &quot;Surfaces&quot; ;

//----------------------------------------------------------------------------
// SUB - MENU
//----------------------------------------------------------------------------
CAAAfrSolidEltSnu.Title        = &quot;Solids&quot; ;
CAAAfrSolidEltSnu.Mnemonic     = &quot;S&quot;;

CAAAfrSurfacicEltSnu.Title     = &quot;Surfaces&quot; ;
CAAAfrSurfacicEltSnu.Mnemonic  = &quot;u&quot;;</pre>
         </td>
       </tr>
     </table>
     </li>
     <li>The CAAAfrGeoCreationWkb.CATRsc file
     <p>This file contains the category, that is the submenu of the <b>Start</b> 
     menu where the workbench should appear, and the names of the icons to be 
     associated with the workbench for the <b>Start</b> menu.</p>
     <table class="code">
       <tr>
         <td>
         <pre>CAAAfrGeoCreationWkb.Category    = &quot;Infrastructure&quot; ; 

// Icons for the Welcome window 64x64 
CAAAfrGeoCreationWkb.Icon.NormalPnl      = &quot;I_WkAsCAAAfrGeoCreationWkb&quot;;
CAAAfrGeoCreationWkb.Icon.PressedlPnl = &quot;IP_WkAsCAAAfrGeoCreationWkb&quot;;
CAAAfrGeoCreationWkb.Icon.FocusedlPnl = &quot;IF_WkAsCAAAfrGeoCreationWkb&quot;;

// Icons for the Start menu 32x32
CAAAfrGeoCreationWkb.Icon.NormalCtx      = &quot;I_WkNvCAAAfrGeoCreationWkb&quot;;
CAAAfrGeoCreationWkb.Icon.PressedlCtx = &quot;IP_WkNvCAAAfrGeoCreationWkb&quot;;
CAAAfrGeoCreationWkb.Icon.FocusedlCtx = &quot;IF_WkNvCAAAfrGeoCreationWkb&quot;;

// Icons for the workbench toolbar 24x24 
CAAAfrGeoCreationWkb.Icon.NormalRep     = &quot;I_WkCAAAfrGeoCreationWkb&quot;;
CAAAfrGeoCreationWkb.Icon.PressedlRep = &quot;IP_WkCAAAfrGeoCreationWkb&quot;;
CAAAfrGeoCreationWkb.Icon.FocusedlRep = &quot;IF_WkCAAAfrGeoCreationWkb&quot;;
</pre>
         </td>
       </tr>
     </table>
     <p>It is in this file that you declare if the workbench is warm start 
     compliant [<a href="#References">3</a>]. The CAAGeometry document is not 
     warm start compliant, so its workbenches are not compliant too.&nbsp;</li>
   </ul>
   </li>
   <li>The command header resources in the command header resource files: 
   titles, messages, icons, and the accelerators associated with the commands. 
   The resource files searched for at run time should have the same name than 
   you command header class, that is CAAAfrGeoCreationWkbHeader.
   <ul>
     <li>The CAAAfrGeoCreationWkbHeader.CATNls file contains the following for 
     the Cuboid commands
     <table class="code">
       <tr>
         <td>
         <pre>CAAAfrGeoCreationWkbHeader.CAAAfrCuboidHdr.Category  = &quot;Element&quot;;
CAAAfrGeoCreationWkbHeader.CAAAfrCuboidHdr.Title     = &quot;Cuboid&quot;;
CAAAfrGeoCreationWkbHeader.CAAAfrCuboidHdr.ShortHelp = &quot;Cuboid&quot;;
CAAAfrGeoCreationWkbHeader.CAAAfrCuboidHdr.Help      = &quot;Cuboid Command is not yet implemented&quot;;
CAAAfrGeoCreationWkbHeader.CAAAfrCuboidHdr.LongHelp  = &quot;Cuboid (Insert menu)
The Cuboid command allows you to create a cuboid, but is not yet implemented.&quot;;
...</pre>
         </td>
       </tr>
     </table>
     <p>For each command, the title, short help, help, and long help are 
     declared.</li>
     <li>The CAAAfrGeoCreationWkbHeader.CATRsc file includes the following for 
     the Cuboid command
     <table class="code">
       <tr>
         <td>
         <pre>CAAAfrGeoCreationWkbHeader.CAAAfrCuboidHdr.Icon.Normal    = &quot;I_CAACube&quot;;
...</pre>
         </td>
       </tr>
     </table>
     <p>This icon name is provided to display in the Solids toolbar where the 
     Cuboid command is included. The icon is also displayed in front of the menu 
     item in the menu.</li>
   </ul>
   </li>
   <li>The command starter resources are the mnemonics associated with the 
   commands. They are automatically set at run time.</li>
 </ul>
 <p>More about Internationalization and resources can be found in 
 Internationalizing Your Client Application.</p>
 <p>&nbsp;</p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="Step7"></a>Creating the Workbench Exposed Interface</h4>
 <p>To enable client applications of your workbench to customize it with 
 add-ins, you should provide the <em>CAAIAfrGeoCreationWkbAddin</em> interface 
 the client application will implement. This enables the client application to 
 add its own commands in one or several new toolbars.</p>
 <p>The header file of this interface should be inserted in the 
 ProtectedInterfaces or PublicInterfaces directory of your framework to make it 
 available to client applications. To create the <em>CAAIAfrGeoCreationWkbAddin</em> 
 interface: </p>
 <ul>
   <li>Create the CAAIAfrGeoCreationWkbAddin.h file as follows.
   <table class="code">
     <tr>
       <td>
       <pre>#include &lt;CATIWorkbenchAddin.h&gt;        // Needed to derive from CATIWorkbenchAddin
#include &quot;CAAAfrGeoCreationWbench.h&quot;   // Needed to export the IID

extern IID ExportedByCAAAfrGeoCreationWbench <strong>IID_CAAIAfrGeoCreationWkbAddin</strong>;

class ExportedByCAAAfrGeoCreationWbench CAAIAfrGeoCreationWkbAddin : public <strong>CATIWorkbenchAddin</strong>
{
  <strong>CATDeclareInterface</strong>;
  public :
};</pre>
       </td>
     </tr>
   </table>
   </li>
   <p>The CAAIAfrGeoCreationWkbAddin.h file contains the <code>
   ExportedByCAAAfrGeoCreationWbench</code> definition that manages the DLL 
   interface for Windows, and is set to blank for UNIX. Don't forget the public 
   keyword required by the TIE compiler.</li>
   <li>Create the CAAIAfrGeoCreationWkbAddin.cpp file with a GUID [<a href="#References">1</a>], 
   shown in bold typeface:
   <table class="code">
     <tr>
       <td>
       <pre>#include &lt;CAAIAfrGeoCreationWkbAddin.h&gt;

IID IID_CAAIAfrGeoCreationWkbAddin = <strong>{
    0xa4188b88,
    0xd4c1,
    0x11d3,
    {0xb7, 0xf5, 0x00, 0x08, 0xc7, 0x4f, 0xe8, 0xdd}
  };</strong>

<strong>CATImplementInterface</strong>(CAAIAfrGeoCreationWkbAddin, CATIWorkbenchAddin);</pre>
       </td>
     </tr>
   </table>
   </li>
 </ul>
 <p>The <code>CATDeclareInterface</code> and <code>CATImplementInterface</code> 
 macros make an interface from this C++ class.</p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <hr>
 <!---------------------------------comment------------------------------------->
 <h3><a name="Troubleshooting"></a>Troubleshooting</h3>
 <h4>A Command Doesn't Display in the Menu Bar or Toolbar</h4>
 <table>
   <tr>
     <td valign="top">
     <img src="../CAAIcons/images/symptom.gif" alt="symptom.gif (111 bytes)" width="10" height="29"></td>
     <td valign="top">I create a command starter for a command, and I arrange it 
     in the menu bar or in a toolbar, but the command doesn't display in the 
     menu bar or toolbar where I place it.</td>
   </tr>
   <tr>
     <td valign="top">
     <img src="../CAAIcons/images/diagnos.gif" alt="diagnos.gif (130 bytes)" width="17" height="27"></td>
     <td valign="top">The command starter is not associated with a command 
     header, and is thus not displayed, since the command cannot be launched 
     without command header.</td>
   </tr>
   <tr>
     <td valign="top">
     <img src="../CAAIcons/images/solution.gif" alt="solution.gif (218 bytes)" width="28" height="30"></td>
     <td valign="top">Check your <code>CreateWorkbench</code> method. The 
     command starter must be associated with a command header for the command 
     you want to display thanks to the <code>SetAccessCommand</code> macro.</td>
   </tr>
 </table>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <hr>
 <!---------------------------------comment------------------------------------->
 <h3><a name="InShort"></a>In Short</h3>
 <p>A workbench gathers tools, that is commands you develop or pick-up among 
 those existing to work on documents of a given type. A workbench is part of the 
 workshop for that document type and can be selected from the Start menu.</p>
 <p>Then you create the workbench files, declare the implemented interfaces <em>
 CATIxxxConfiguration</em> and <em>pppIxxxWorkbenchFactory</em>, where ppp is 
 the prefix of your application (such as CAT for CATIA), and xxx is the name of 
 your workbench, and the workbench factory, in the dictionary. You have to 
 declare the headers of the commands you want to propose, arrange them in menus 
 and toolbars, and create the necessary external resources. Your wokbench is 
 ready to use.</p>
 <p>You can create different workbenches in a workshop. Each workbench shares 
 with the other workbenches the ability to work on your document, and usually 
 shares with them a set of common commands. Each workbench gathers commands 
 dedicated for specific process and one workbench can be activated by the end 
 user at a time using the Start menu.</p>
 <p>You should also provide the IxxxAddin interface with your workbench, where 
 xxx is the name of your workbench, to enable client applications to customize 
 it by adding new toolbars.</p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <hr>
 <!---------------------------------comment------------------------------------->
 <h3><a name="References"></a>References</h3>
 <table width="100%">
   <tr>
     <td valign="top">[1]</td>
     <td>
     <a href="../CAASysQuickRefs/CAASysGUID.htm">
     About Globally Unique IDentifiers</a></td>
   </tr>
   <tr>
     <td valign="top">[2]</td>
     <td>
     <a href="../CAASysTechArticles/CAASysOMInheritance.htm">
     Object Modeler Component and Implementation Inheritances</a></td>
   </tr>
   <tr>
     <td valign="top">[3]</td>
     <td><a href="../CAAAfrTechArticles/CAAAfrWarmstart.htm">Warm 
     Start Incremental Backup</a></td>
   </tr>
   <tr>
     <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
   </tr>
 </table>
 <hr>
 <!---------------------------------comment------------------------------------->
 <h3><a name="History"></a>History</h3>
 <table width="100%">
   <tr>
     <td valign="top">Version: <strong>1</strong> [Jan 2000]</td>
     <td valign="top">Document created</td>
   </tr>
   <tr>
     <td valign="top">Version: <strong>2</strong> [Sep 2003]</td>
     <td valign="top">Warm start Integration</td>
   </tr>
   <tr>
     <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
   </tr>
 </table>
 <hr>
 <!---------------------------------comment------------------------------------->
 <p><i>Copyright  2000, Dassault Systmes. All rights reserved.</i></p>

 </body>

</html>
