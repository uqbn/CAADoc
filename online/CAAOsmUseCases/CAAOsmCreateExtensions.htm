<html>

  <head>
  <meta http-equiv="Content-Language" content="fr">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="GENERATOR" content="Microsoft FrontPage 5.0">
  <meta name="ProgId" content="FrontPage.Editor.Document">
  <link rel="Stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css">
  <title>Creating Feature Extensions</title>
  </head>

  <body>

   <table width="100%">
     <tr>
       <td valign="top">
       <h1>3D PLM PPR Hub Open Gateway</h1>
       </td>
       <td valign="top">
       <h2>Feature Modeler</h2>
       </td>
       <td rowspan="2" align="right" valign="top">
       <h3><a name="Top"></a>Creating Feature Extensions</h3>
       <p><em>Creating new feature extensions in catalogs</em></td>
     </tr>
     <tr>
       <td class="use" colspan="2">Use Case</td>
     </tr>
   </table>
   <hr>
   <!---------------------------------comment------------------------------------->
   <table class="abstract">
     <tr>
       <td>
       <h3>Abstract</h3>
       <p>This article discusses the CAAOsmCreateExtensions use case. This use 
       case explains how to create feature extensions in catalogs. </p>
       <ul>
         <li><strong><a href="#Learn">What You Will Learn With This Use Case</a></strong></li>
         <li><a href="#UseCase"><strong>The CAAOsmCreateExtensions Use Case</strong></a>
         <ul>
           <li><a href="#What">What Does CAAOsmCreateExtensions Do</a></li>
           <li><a href="#How">How to Launch CAAOsmCreateExtensions</a></li>
           <li><a href="#Where">Where to Find the CAAOsmCreateExtensions Code</a></li>
         </ul>
         </li>
         <li><strong><a href="#Step">Step-by-Step</a></strong></li>
         <li><strong><a href="#InShort">In Short</a></strong></li>
         <li><strong><a href="#References">References</a></strong></li>
       </ul>
       </td>
     </tr>
   </table>
   <hr>
   <!---------------------------------comment------------------------------------->
   <h3><a name="Learn"></a>What You Will Learn With This Use Case</h3>
   <p>This use case is intended to help you understand how to create feature 
   extensions in catalogs. </p>
   <p>Before getting to the use case itself, you should have on one hand a good 
   understanding of the feature modeler [<a href="#References">1</a>] , and the 
   extension feature concepts [<a href="#References">2</a>] on the other hand.</p>
   <p>Once you have created the feature extension, you can read the article 
   entitled &quot;Working with Feature Extensions&quot; [<a href="#References">3</a>] 
   which explains how to add ,query and remove extensions on a base feature.</p>
   <p align="right">[<a href="#Top">Top</a>]</p>
   <!---------------------------------comment------------------------------------->
   <h3><a name="UseCase"></a>The CAAOsmCreateExtensions Use Case</h3>
   <p>CAAOsmCreateExtensions is a use case of the CAAObjectSpecsModeler.edu 
   framework that illustrates ObjectSpecsModeler framework capabilities.</p>
   <p align="right">[<a href="#Top">Top</a>]</p>
   <!---------------------------------comment------------------------------------->
   <h4><a name="What"></a>What Does CAAOsmCreateExtensions Do</h4>
   <p>The goal of CAAOsmCreateExtensions is to illustrate creating feature 
   extensions. This use case calls a global function called <code>
   CAAOsmCreateExtInCatalog</code> which creates two new catalogs. Each catalog 
   contains a different set of feature extensions. Here is an image of the 
   contents of the first extensions catalog: </p>
   <table border="0" cellpadding="0" cellspacing="0" width="100%">
     <caption>Fig.1 CAAOsmExt1.CATfct Catalog</caption>
     <tr>
       <td><img border="0" src="images/CAAOsmExtensions1Cat.gif" width="283" height="130"></td>
     </tr>
   </table>
   <p>And here is an image of the contents of the second extensions catalog: </p>
   <table border="0" cellpadding="0" cellspacing="0" width="100%">
     <caption>Fig.2 CAAOsmExt2.CATfct Catalog</caption>
     <tr>
       <td><img border="0" src="images/CAAOsmExtensions2Cat.gif" width="255" height="59"></td>
     </tr>
   </table>
   <p align="right">[<a href="#Top">Top</a>]</p>
   <!---------------------------------comment------------------------------------->
   <h4><a name="How"></a>How to Launch CAAOsmCreateExtensions</h4>
   <p>To launch CAAOsmCreateExtensions, you will need to set up the build time 
   environment, then compile CAAOsmCreateExtensions along with its prerequisites, 
   set up the run time environment, and then execute the use case. This is fully 
   described in the referenced article [<a href="#References">4</a>]. To launch 
   the use case, execute the following command:</p>
   <pre>mkrun -c &quot;CAAOsmMainCreateExt ExtCatalog1 ExtCatalog2&quot;</pre>
   <ul>
     <li><b>ExtCatalog1</b> - the entire storage path, name and .CATfct suffix 
     of the first new extensions catalog that will be created.&nbsp;</li>
     <li><b>ExtCatalog2</b> - the entire storage path, name and .CATfct suffix 
     of the second new extensions catalog that will be created.</li>
   </ul>
   <p>Note: It is not necessary to locate the newly catalogs in the CNext/resources/graphic 
   directory of the CAAObjectSpecsModeler.edu framework, since there have been 
   already provided.&nbsp;</p>
   <p align="right">[<a href="#Top">Top</a>]</p>
   <!---------------------------------comment------------------------------------->
   <h4><a name="Where"></a>Where to Find the CAAOsmCreateExtensions Code</h4>
   <p>The main CAAOsmCreateExtensions code is located in the 
   CAAOsmMainCreateExt.m module of the CAAObjectSpecsModeler.edu framework. It 
   contains a unique source file named CAAOsmMainExtensions.cpp. This main calls 
   one global function: <code>CAAOsmCreateExtInCatalog,</code> contained in the 
   CAAOsmCreateExtInCatalog.cpp source file found in the 
   CAAOsmCreateExtensions.m module.&nbsp; Here is the installation path, 
   depending on the operating system:</p>
   <table>
     <tr>
       <td>Windows</td>
       <td><code>InstallRootDirectory\CAAObjectSpecsModeler.edu\CAAOsmMainCreateExt.m 
       and CAAOsmCreateExtensions.m</code></td>
     </tr>
     <tr>
       <td>Unix</td>
       <td><code>InstallRootDirectory/CAAObjectSpecsModeler.edu/CAAOsmMainCreateExt.m 
       and CAAOsmCreateExtensions.m</code></td>
     </tr>
   </table>
   <p>where <code>InstallRootDirectory</code> is the root directory of your CAA 
   V5 installation. </p>
   <p align="right">[<a href="#Top">Top</a>]</p>
   <!---------------------------------comment------------------------------------->
   <h3><a name="Step"></a>Step-by-Step</h3>
   <p>Two extensions catalogs are created in this use case. Since they are 
   created in the same way, only the creation of the first is shown below. There 
   are seven logical steps in CAAOsmCreateExtensions:</p>
   <ol>
     <li><a href="#CreateExtCatalog">Creating the Extensions Catalog</a></li>
     <li><a href="#ClientId">Assigning a Client Id to the Catalog</a></li>
     <li><a href="#CreateExtensions">Creating Extensions in the Catalog</a></li>
     <li><a href="#AddAttributes">Adding Attributes to the Extension</a></li>
     <li><a href="#ValuateAttributes">Valuating the Attributes of an Extension</a></li>
     <li><a href="#SaveCatalog">Saving the Extensions Catalog</a></li>
     <li><a href="#Creating the CATRsc file">Creating CATRsc files</a></li>
   </ol>
   <p>We will now comment each of these sections by looking at the code. The 
   code itself is found in the <code>CAAOsmCreateExtInCatalog</code> function 
   called by the main program. </p>
   <p align="right">[<a href="#Top">Top</a>]</p>
   <!---------------------------------comment------------------------------------->
   <h4><a name="CreateExtCatalog"></a>Creating the Extensions Catalog</h4>
   <table class="code">
     <tr>
       <td>
       <pre>...
CATICatalog *piCatalog = NULL;
CATUnicodeString extensionsCatalog = pExtensionsCatalog1Name;
	
rc = ::<b>CreateCatalog</b>(&amp;extensionsCatalog, 
	            &amp;piCatalog);</pre>
       <pre>...</pre>
       </td>
     </tr>
   </table>
   <p>The extensions catalog is a regular .<code>CATfct</code> feature catalog. 
   It is created using the <code>CreateCatalog</code> global function. The first 
   argument to this function, the catalog storage name, is passed to the 
   function by the first argument. The second argument is the <i>CATICatalog</i> 
   pointer on the new catalog created.</p>
   <p align="right">[<a href="#Top">Top</a>]</p>
   <p><b><a name="ClientId"></a>Assigning a Client Id to the Catalog</b></p>
   <table class="code">
     <tr>
       <td>
       <pre>...
CATUnicodeString clientId(&quot;CAAOsmClientId1&quot;);
rc = piCatalog -&gt; <b>SetClientId</b>(&amp;clientId);
...      </pre>
       </td>
     </tr>
   </table>
   <p>The catalog is uniquely identified using the <code>SetClientId</code> 
   method of <i>CATICatalog</i>. This identification is necessary in order to 
   open the catalog later on. This identifier should remain unique to this 
   particular catalog.</p>
   <p align="right">[<a href="#Top">Top</a>]</p>
   <p align="left"><b><a name="CreateExtensions"></a>Creating Extensions in the 
   Catalog</b></p>
   <table class="code">
     <tr>
       <td>
       <pre>...
CATIOsmExtensionFactory *piFactoryOnCatalog = NULL;
rc = piCatalog -&gt; <b>QueryInterface</b>(IID_CATIOsmExtensionFactory,
	                        (void**) &amp;piFactoryOnCatalog);

const char *pHistExt = &quot;CAAOsmHistoricalNovel&quot;;
<b>CATIOsmExtension</b>*piHistExt = NULL;
rc = piFactoryOnCatalog -&gt; <b>CreateExtension</b> (pHistExt,
                                            NULL,
                                            piHistExt);

... </pre>
       </td>
     </tr>
   </table>
   <p>A new extension is created using the <code>CreateExtension</code> method 
   of <i>CATIOsmExtensionFactory</i>. First, obviously, it is necessary to get a 
   pointer to <i>CATIOsmExtensionFactory</i> from the <i>CATICatalog</i> pointer 
   to the new catalog using <code>QueryInterface</code>. The <code>
   CreateExtension</code> method takes the following arguments:</p>
   <ul>
     <li><code>pHistExt</code> - the name of the new extension</li>
     <li><code>NULL</code> - the deriving extension name: an extension can only 
     derive from another extension. In this case, the extension does not derive.</li>
     <li><code>piHistExt</code> - the returned <i>CATIOsmExtension</i> pointer 
     to the new extension created.</li>
   </ul>
   <p align="right">[<a href="#Top">Top</a>] </p>
   <p align="left"><b><a name="AddAttributes"></a>Adding Attributes to the 
   Extension</b> </p>
   <table class="code">
     <tr>
       <td>
       <pre>CATISpecObject *piSpecOnHistExt = NULL;
rc = piHistExt -&gt; <b>QueryInterface</b>(IID_CATISpecObject,
	                        (void**) &amp;piSpecOnHistExt);
... 

CATUnicodeString epoch(&quot;Epoch&quot;);
CATISpecAttribute *piHistEpoch = piSpecOnHistExt -&gt; <b>AddAttribute</b>(epoch,
                                                                 tk_string);
... </pre>
       </td>
     </tr>
   </table>
   <p>Attributes are added to extensions exactly the same as to StartUps or 
   regular features using the <code>AddAttribute</code> method of <i>
   CATISpecObject</i>. A pointer to <i>CATISpecObject</i> is obtained from the
   <i>CATIOsmExension</i> pointer (<code>piHistExt</code>) returned by <code>
   CreateExtension</code>.</p>
   <p align="right">[<a href="#Top">Top</a>]</p>
   <p><b><a name="ValuateAttributes"></a>Valuating the Attributes of an 
   Extension</b> </p>
   <table class="code">
     <tr>
       <td>
       <pre>CATISpecAttrAccess *piSpecAttrAccessOnHistExt = NULL;
rc = piSpecOnHistExt -&gt; <b>QueryInterface</b>(IID_CATISpecAttrAccess,
	                              (void**) &amp;piSpecAttrAccessOnHistExt);
... 

CATISpecAttrKey *piKeyEpoch = piSpecAttrAccessOnHistExt -&gt; <b>GetAttrKey</b>(&quot;Epoch&quot;);

... 
	
piSpecAttrAccessOnHistExt -&gt; <b>SetString</b>(piKeyEpoch,
                                       &quot;Middle Ages&quot;);
...</pre>
       </td>
     </tr>
   </table>
   <p>In order to valuate an attribute, it is first necessary to access its 
   attribute key using the <code>GetAttrKey</code> of <i>CATISpecAttrAccess</i>. 
   Then, using the <code>Set...</code> methods, in this case <code>SetString</code>, 
   the attribute can be assigned a value.</p>
   <p>The second extension, &quot;CAAOsmBiographicalNovel&quot;, is created exactly the 
   same as the first, except that it derives from the first. This is done by 
   specifying the name of the first extension in the second argument of <code>
   CreateExtension</code>.</p>
   <p align="right">[<a href="#Top">Top</a>]</p>
   <p align="left"><b><a name="SaveCatalog"></a>Saving the Extensions Catalog</b></p>
   <table class="code">
     <tr>
       <td>
       <pre>rc = <b>::SaveCatalog</b>(&amp;piCatalog,
                   &amp;extensionsCatalog);
...    </pre>
       </td>
     </tr>
   </table>
   <p>To save a catalog document, use the <code>SaveCatalog</code> global 
   function which takes as arguments the <i>CATICatalog</i> pointer of the new 
   catalog and the entire storage path and name of the new catalog.</p>
   <h4><a name="Creating the CATRsc file"></a>Creating CATRsc files</h4>
   <p>The last step consists in to create a CATRsc file for each extension 
   StartUp. The resource files are located in the CNext/resources/msgcatalog 
   directory of the CAAObjectSpecsModeler.edu framework. The name of the CATRsc 
   file is the name of the extension (the first argument of the <code>
   CreateExtension </code>method). This file consists in to declare the 
   extention usage.</p>
   <ul>
     <li><b><span style="font-weight: 400">The </span>CAAOsmHistoricalNovel</b>.CATRsc 
     file</li>
     <table class="code">
       <tr>
         <td>ExtensionFeature.<b>IsLocal</b>=&quot;TRUE&quot;;<br>
         ExtensionFeature.<b>Extends</b>=&quot;<font color="#0000FF"><b>CAAOsmNovel</b></font>&quot;;<br>
         ExtensionFeature.<b>Container</b>=&quot;<font color="#FF00FF"><b>CAAOsmApplication1</b></font>&quot;;</td>
       </tr>
     </table>
     </li>
     <li><b><span style="font-weight: 400">The </span>CAAOsmBiographicalNovel</b> 
     .CATRsc file</li>
     <table class="code">
       <tr>
         <td>ExtensionFeature.IsLocal=&quot;TRUE&quot;;<br>
         ExtensionFeature.Extends=&quot;<font color="#0000FF"><b>CAAOsmNovel</b></font>&quot;;<br>
         ExtensionFeature.Container=&quot;<font color="#FF00FF"><b>CAAOsmApplication1</b></font>&quot;;</td>
       </tr>
     </table>
     <p>&nbsp;</li>
     <li><b><span style="font-weight: 400">The </span>CAAOsmChildrensNovel</b> .CATRsc 
     file</li>
     <table class="code">
       <tr>
         <td>ExtensionFeature.IsLocal=&quot;TRUE&quot;;<br>
         ExtensionFeature.Extends=&quot;<font color="#0000FF"><b>CAAOsmNovel</b></font>&quot;;<br>
         ExtensionFeature.Container=&quot;<font color="#FF0000"><b>CAAOsmApplication2</b></font>&quot;;</td>
       </tr>
     </table>
     </li>
   </ul>
   <p>The CATRsc file for an extension contains the followink keys:</p>
   <table border="2" style="border-collapse: collapse" bordercolor="#111111" 
   id="AutoNumber1">
     <tr>
       <td><b>Key Type</b></td>
       <td><b>Value Key</b></td>
       <td><b>Explanation</b></td>
     </tr>
     <tr>
       <td rowspan="2">ExtensionFeature.IsLocal</td>
       <td>TRUE&nbsp; </td>
       <td>It means that the extension it is not re-instanciated when the base 
       feature is re-instanciated.</td>
     </tr>
     <tr>
       <td>FALSE</td>
       <td>It means that the extension is re-instanciated when base feature is 
       re-instanciated.</td>
     </tr>
     <tr>
       <td>ExtensionFeature.Extends</td>
       <td>Base feature type</td>
       <td>A feature extension can only extend one and only one base feature
       </td>
     </tr>
     <tr>
       <td>ExtensionFeature.Container</td>
       <td>Applicative container name</td>
       <td>A feature extension can be added to a base feature only in one and 
       only one applicative container. </td>
     </tr>
   </table>
   <p align="right">[<a href="#Top">Top</a>]</p>
   <!---------------------------------comment------------------------------------->
   <!---------------------------------comment------------------------------------->
   <!---------------------------------comment------------------------------------->
   <!---------------------------------comment------------------------------------->
   <!---------------------------------comment------------------------------------->
   <!---------------------------------comment------------------------------------->
   <!---------------------------------comment------------------------------------->
   <!---------------------------------comment------------------------------------->
   <!---------------------------------comment------------------------------------->
   <!---------------------------------comment------------------------------------->
   <!---------------------------------comment------------------------------------->
   <!---------------------------------comment------------------------------------->
   <!---------------------------------comment------------------------------------->
   <hr>
   <!---------------------------------comment------------------------------------->
   <h3><a name="InShort"></a>In Short</h3>
   <p>An extension is created in a regular feature catalog (.CATfct) using the
   <code>CreateExtension</code> method of the <i>CATIOsmExtensionFactory</i> 
   interface. As for normal StartUps, the <code>AddAttribute</code> method of <i>
   CATISpecObject</i> is used on extensions to further define their data 
   structure. Likewise, the <code>GetAttrKey</code> and <code>Set...</code> 
   methods of <i>CATISpecAttrAccess</i> are used to valuate attributes. The 
   general <code>SaveCatalog</code> global function is used to save the 
   extensions catalog.&nbsp;</p>
   <p>Do not forget to provide a CATRsc file to declare the usage of the feature 
   extension: </p>
   <ul>
     <li>Its base feature type to extend, </li>
     <li>if it is a local or not feature extension,</li>
     <li>The target applicative container name.</li>
   </ul>
   <p align="right">[<a href="#Top">Top</a>]</p>
   <hr>
   <!---------------------------------comment------------------------------------->
   <h3><a name="References"></a>References</h3>
   <table width="100%">
     <tr>
       <td valign="top">[1]</td>
       <td><a href="../CAAOsmTechArticles/CAAOsmOverview.htm">Feature 
       Modeler Conceptual Overview</a></td>
     </tr>
     <tr>
       <td valign="top">[2]</td>
       <td>
       <a href="../CAAOsmTechArticles/CAAOsmHowToAddDataToAFeature.htm">
       How to Add Data to a Feature</a></td>
     </tr>
     <tr>
       <td valign="top">[3]</td>
       <td><a href="CAAOsmManageExtensions.htm">Working with Feature Extensions</a></td>
     </tr>
     <tr>
       <td valign="top">[4]</td>
       <td>
       <a href="../CAADocUseCases/CAADocRunSample.htm">
       Building and Launching a CAA V5 Use Case</a></td>
     </tr>
     <tr>
       <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
     </tr>
   </table>
   <hr>
   <!---------------------------------comment------------------------------------->
   <h3><a name="History"></a>History</h3>
   <table width="100%">
     <tr>
       <td valign="top">Version: <strong>1</strong> [Feb 2000]</td>
       <td valign="top">Document created</td>
     </tr>
     <tr>
       <td valign="top">Version: <strong>2</strong> [Feb 2005]</td>
       <td valign="top">Document updated for new interface</td>
     </tr>
     <tr>
       <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
     </tr>
     <tr>
       <td valign="top" align="right" colspan="2"></td>
     </tr>
   </table>
   <hr>
   <!---------------------------------comment------------------------------------->
   <p><i>Copyright © 2001, Dassault Systèmes. All rights reserved.</i></p>

  </body>

</html>

