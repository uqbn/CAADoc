<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 6.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>Product Document Automation Objects</title>
<link rel="stylesheet" type="text/css" href="../CAAScrBase/caav5.css">
<script language="JavaScript" src="../CAAScrJavaScript/submit.js"></script>
</head>

<body>

<h1>Product Document Automation Objects</h1>
<table cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="100%"><a href="#" onclick="javascript:CAAlink('IDL', 'ProductStructureInterfaces', 'ProductDocument');return false;"><img border="0" src="../CAAScrAutomationImages/images/proddoc.gif" width="183" height="18"></a><a href="../CAAScdInfTechArticles/CAAInfTocApplication.htm"><img border="0" src="../CAAScrAutomationImages/images/uparrow.gif" alt="Application Object Diagram" width="18" height="7"></a><br>
      <img border="0" src="../CAAScrAutomationImages/images/parchild.gif" width="17" height="25"><a href="#" onclick="javascript:CAAlink('IDL', 'ProductStructureInterfaces', 'Product');return false;"><img border="0" src="../CAAScrAutomationImages/images/product.gif" width="183" height="18"></a><br>
      <img border="0" src="../CAAScrAutomationImages/images/space.gif" width="17" height="25"><img border="0" src="../CAAScrAutomationImages/images/parmult.gif" width="17" height="25"><a href="#" onclick="javascript:CAAlink('IDL', 'ProductStructureInterfaces', 'Products');return false;"><img border="0" src="../CAAScrAutomationImages/images/products.gif" width="183" height="18"></a><br>
      <img border="0" src="../CAAScrAutomationImages/images/space.gif" width="17" height="25"><img border="0" src="../CAAScrAutomationImages/images/parmult.gif" width="17" height="25"><a href="#" onclick="javascript:CAAlink('IDL', 'ProductStructureInterfaces', 'Publications');return false;"><img border="0" src="../CAAScrAutomationImages/images/publics.gif" width="183" height="18"></a><br>
      <img border="0" src="../CAAScrAutomationImages/images/space.gif" width="17" height="25"><img border="0" src="../CAAScrAutomationImages/images/parlower.gif" width="17" height="25"><img border="0" src="../CAAScrAutomationImages/images/parchild.gif" width="17" height="25"><a href="#" onclick="javascript:CAAlink('IDL', 'ProductStructureInterfaces', 'Publication');return false;"><img border="0" src="../CAAScrAutomationImages/images/public.gif" width="183" height="18"></a><br>
      <img border="0" src="../CAAScrAutomationImages/images/space.gif" width="17" height="25"><img border="0" src="../CAAScrAutomationImages/images/parmult.gif" width="17" height="25"><a href="../CAAScdMmrTechArticles/CAAMmrObjConstraints.htm"><img border="0" src="../CAAScrAutomationImages/images/constrs.gif" width="183" height="18"></a><br>
      <img border="0" src="../CAAScrAutomationImages/images/space.gif" width="17" height="25"><img border="0" src="../CAAScrAutomationImages/images/parlower.gif" width="17" height="25"><img border="0" src="../CAAScrAutomationImages/images/parchild.gif" width="17" height="25"><a href="#" onclick="javascript:CAAlink('IDL', 'MecModInterfaces', 'Constraint');return false;"><img border="0" src="../CAAScrAutomationImages/images/constrnt.gif" width="183" height="18"></a><br>
      <img border="0" src="../CAAScrAutomationImages/images/space.gif" width="17" height="25"><img border="0" src="../CAAScrAutomationImages/images/parmult.gif" width="17" height="25"><a href="#" onclick="javascript:CAAlink('IDL', 'MecModInterfaces', 'FixTogethers');return false;"><img border="0" src="../CAAScrAutomationImages/images/fixtgrs.gif" width="183" height="18"></a><br>
      <img border="0" src="../CAAScrAutomationImages/images/space.gif" width="17" height="25"><img border="0" src="../CAAScrAutomationImages/images/parlower.gif" width="17" height="25"><img border="0" src="../CAAScrAutomationImages/images/parchild.gif" width="17" height="25"><a href="#" onclick="javascript:CAAlink('IDL', 'MecModInterfaces', 'FixTogether');return false;"><img border="0" src="../CAAScrAutomationImages/images/fixtgr.gif" width="183" height="18"></a><br>
      <img border="0" src="../CAAScrAutomationImages/images/space.gif" width="17" height="25"><img border="0" src="../CAAScrAutomationImages/images/parmult.gif" width="17" height="25"><a href="#" onclick="javascript:CAAlink('IDL', 'InfInterfaces', 'Move');return false;"><img border="0" src="../CAAScrAutomationImages/images/move.gif" width="183" height="18"></a><br>
      <img border="0" src="../CAAScrAutomationImages/images/space.gif" width="17" height="25"><img border="0" src="../CAAScrAutomationImages/images/parmult.gif" width="17" height="25"><a href="#" onclick="javascript:CAAlink('IDL', 'InfInterfaces', 'Position');return false;"><img border="0" src="../CAAScrAutomationImages/images/position.gif" width="183" height="18"></a><br>
      <img border="0" src="../CAAScrAutomationImages/images/space.gif" width="17" height="25"><img border="0" src="../CAAScrAutomationImages/images/parmult.gif" width="17" height="25"><a href="#" onclick="javascript:CAAlink('IDL', 'ProductStructureInterfaces', 'Analyze');return false;"><img border="0" src="../CAAScrAutomationImages/images/analyze.gif" width="183" height="18"></a><br>
      <img border="0" src="../CAAScrAutomationImages/images/space.gif" width="17" height="25"><img border="0" src="../CAAScrAutomationImages/images/parmult.gif" width="17" height="25"><a href="#" onclick="javascript:CAAlink('IDL', 'KnowledgeInterfaces', 'Relations');return false;"><img border="0" src="../CAAScrAutomationImages/images/relatns.gif" width="183" height="18"></a><br>
      <img border="0" src="../CAAScrAutomationImages/images/space.gif" width="17" height="25"><img border="0" src="../CAAScrAutomationImages/images/parlower.gif" width="17" height="25"><img border="0" src="../CAAScrAutomationImages/images/parchild.gif" width="17" height="25"><a href="#" onclick="javascript:CAAlink('IDL', 'KnowledgeInterfaces', 'Relation');return false;"><img border="0" src="../CAAScrAutomationImages/images/relation.gif" width="183" height="18"></a><a href="../CAAScdKniTechArticles/CAAKniTocRelation.htm"><img border="0" src="../CAAScrAutomationImages/images/rtarrow.gif" alt="Relation Object Diagram" width="11" height="14"></a><br>
      <img border="0" src="../CAAScrAutomationImages/images/space.gif" width="17" height="25"><img border="0" src="../CAAScrAutomationImages/images/parmult.gif" width="17" height="25"><a href="#" onclick="javascript:CAAlink('IDL', 'KnowledgeInterfaces', 'Parameters');return false;"><img border="0" src="../CAAScrAutomationImages/images/params.gif" width="183" height="18"></a><br>
      <img border="0" src="../CAAScrAutomationImages/images/space.gif" width="17" height="25"><img border="0" src="../CAAScrAutomationImages/images/parlower.gif" width="17" height="25"><img border="0" src="../CAAScrAutomationImages/images/parchild.gif" width="17" height="25"><a href="#" onclick="javascript:CAAlink('IDL', 'KnowledgeInterfaces', 'Parameter');return false;"><img border="0" src="../CAAScrAutomationImages/images/param.gif" width="183" height="18"></a><a href="../CAAScdKniTechArticles/CAAKniTocParameter.htm"><img border="0" src="../CAAScrAutomationImages/images/rtarrow.gif" alt="Parameter Object Diagram" width="11" height="14"></a><br>
      <img border="0" src="../CAAScrAutomationImages/images/space.gif" width="17" height="25"><img border="0" src="../CAAScrAutomationImages/images/parmult.gif" width="17" height="25"><img border="0" src="../CAAScrAutomationImages/images/psttechobj.gif" width="130" height="25"><a href="#" onclick="javascript:CAAlink('IDL', 'System', 'AnyObject');return false;"><img border="0" src="../CAAScrAutomationImages/images/anyobj.gif" width="183" height="18"></a><br>
      <img border="0" src="../CAAScrAutomationImages/images/space.gif" width="17" height="25"><img border="0" src="../CAAScrAutomationImages/images/parchild.gif" width="17" height="25"><img border="0" src="../CAAScrAutomationImages/images/getitem.gif" width="130" height="25"><a href="#" onclick="javascript:CAAlink('IDL', 'System', 'AnyObject');return false;"><img border="0" src="../CAAScrAutomationImages/images/anyobj.gif" width="183" height="18"></a><br>
      <img border="0" src="../CAAScrAutomationImages/images/space2.gif" width="34" height="25"><img border="0" src="../CAAScrAutomationImages/images/space2.gif" width="34" height="25"><img border="0" src="../CAAScrAutomationImages/images/space2.gif" width="34" height="25"><img border="0" src="../CAAScrAutomationImages/images/space2.gif" width="34" height="25"><img border="0" src="../CAAScrAutomationImages/images/space2.gif" width="34" height="25"><img border="0" src="../CAAScrAutomationImages/images/parderim.gif" width="17" height="25"><a href="#" onclick="javascript:CAAlink('IDL', 'ProductStructureInterfaces', 'AssemblyConvertor');return false;"><img border="0" src="../CAAScrAutomationImages/images/asmconv.gif" width="183" height="18"></a><br>
      <img border="0" src="../CAAScrAutomationImages/images/space2.gif" width="34" height="25"><img border="0" src="../CAAScrAutomationImages/images/space2.gif" width="34" height="25"><img border="0" src="../CAAScrAutomationImages/images/space2.gif" width="34" height="25"><img border="0" src="../CAAScrAutomationImages/images/space2.gif" width="34" height="25"><img border="0" src="../CAAScrAutomationImages/images/space2.gif" width="34" height="25"><img border="0" src="../CAAScrAutomationImages/images/parmult.gif" width="17" height="25"><a href="#" onclick="javascript:CAAlink('IDL', 'CATMatInterfaces', 'MaterialManager');return false;"><img border="0" src="../CAAScrAutomationImages/images/matmanager.gif" width="183" height="18"></a><br>
	    <img border="0" src="../CAAScrAutomationImages/images/space2.gif" width="34" height="25"><img border="0" src="../CAAScrAutomationImages/images/space2.gif" width="34" height="25"><img border="0" src="../CAAScrAutomationImages/images/space2.gif" width="34" height="25"><img border="0" src="../CAAScrAutomationImages/images/space2.gif" width="34" height="25"><img border="0" src="../CAAScrAutomationImages/images/space2.gif" width="34" height="25"><img border="0" src="../CAAScrAutomationImages/images/parchild.gif" width="17" height="25"><a href="#" onclick="javascript:CAAlink('IDL', 'CATMatInterfaces', 'PositionedMaterial');return false;"><img border="0" src="../CAAScrAutomationImages/images/posmat.gif" width="183" height="18"></a><br>
      <p><b>Legend</b>
      <p><img border="0" src="../CAAScrAutomationImages/images/yellbox.gif" width="18" height="14">
      Collection<br>
      <img border="0" src="../CAAScrAutomationImages/images/purpbox.gif" width="18" height="14">
      Abstract object<br>
      <img border="0" src="../CAAScrAutomationImages/images/bluebox.gif" width="18" height="14">
      Object</p>
      <p><img src="../CAAScrAutomationImages/images/rtarrow.gif" alt="right arrow" border="0" width="11" height="14">
      Click arrow to expand chart<br>
      <img border="0" src="../CAAScrAutomationImages/images/uparrow.gif" width="18" height="7">
      Click arrow to return to previous chart</p>
    </td>
  </tr>
</table>
<br>
<p>The <b>ProductDocument</b> object aggregates, or includes, a product tree
structure starting with a single product, named the root product, which includes
a collection of products. Each of the products of this collection can itself
include a collection of products, and so forth.</p>
<p>Each product is positioned in the 3D space thanks to the <b>Position</b>
object which represents the product's 3D-axis system expressed with respect to
the assembly's 3D-axis system. The <b>Move</b> object allows the object moving.
Constraints can be set to constrain the product's position and move.</p>
<p>The following diagram shows such a tree structure for a (simple) car.</p>
<img src="images/baspp3-2.gif" width="461" height="500">
<p>A given product, such as the cylinder head or the gear box, is in fact a
product component of a product reference. This product reference is neither
accessible using macros nor from interactive commands. It is nevertheless
created when you create a product component. Products that appear duplicated,
such as the wheels, can be product components pointing to the same product
reference. In this example, the LeftRearWheel and RightRearWheel objects can be
two product components of a single wheel product reference. Creating references
enables consistency management. When a modification is brought to a product,
such as its part number, or its master shape representation which we'll see
below, the modification is brought through a component to the reference, and is
propagated to all the components which point to this reference.</p>
<p>The root product is retrieved by the <b>ProductDocument</b> object using its <b>Product</b>
property. Each product, starting with the root product, may include a <b>Products</b>
collection which gathers all the products just below this product in the product
tree structure. This collection is built using the <b>AddNewProduct</b>, <b>AddComponent</b>
and <b>AddExternalComponent</b> methods:</p>
<ul>
  <li><b>AddNewProduct</b> creates both a reference to the product and a
    component in the <b>ProductDocument</b></li>
  <li><b>AddComponent</b> creates a product component from a product reference
    already existing in the <b>ProductDocument</b> , that is a product component
    of a product already created in any of the <b>Products</b> collection of the
    <b>ProductDocument</b> using the <b>AddNewProduct</b> method</li>
  <li><b>AddExternalComponent</b> creates a product component using the root
    product of another <b>ProductDocument</b>.</li>
</ul>
<p>Each product reference can have a master shape representation which defines
its geometry, material properties, and so forth, and used to display or print
it, and maybe more, for example to analyze or manufacture it. This is optional,
but is often required to represent actual products. This master shape
representation is shared by all the components pointing to this product
reference, and can be a CATIA Version 4 model, a CATIA Version 5 part, a VRML
file, or whatever format supported by CATIA Version 5. The methods <b>AddMasterShapeRepresentation</b>,
<b>RemoveMasterShapeRepresentation</b>, and <b>GetMasterShapeRepresentation</b>
manage the master shape representation.</p>
<p>Each product component in the tree structure is positioned in the space
according to the position of its own 3D-axis system with respect to the product
document's 3D axis-system, this position being possibly determined according to
positioning constraints relative to the product above it in the tree structure.
This means that each product component is positioned with respect to the root
product according to a cascading position combination from the root product to
the current product across the product tree structure. Its position can be set
or retrieved using the <b>Position</b> property, whatever the constraints
applied. The <b>Move</b> property allows a movable object retrieval to move the
product as required by a move operation while ensuring that the positioning
constraints are matched. The movable object returned is the product object
itself, meaning that a product is movable, but with some other applications,
this could be different. For example, the movable object returned from an edge
in a pad is the whole pad, since the edge cannot be moved alone and is linked to
the other edges and faces in the pad. The actual move is performed using the <b>Apply</b>
method. This method takes a table with twelve items as input which define the
move. This table contains the move matrix elements and has the following
structure, assuming that <code>M</code> is the table identifier:</p>
<pre>M(0)=Ux M(3)=Vx M(6)=Wx M(9)=Tx
M(1)=Uy M(4)=Vy M(7)=Wy M(10)=Ty
M(2)=Uz M(5)=Vz M(8)=Wz M(11)=Tz</pre>
<p>The first nine items represent an axis rotation, and the last three a
translation. It expresses the product 3D-axis system (T,U,V,W) with respect to
the root product 3D-axis system(O,xy,z), where:</p>
<ul>
  <li><code>Ux</code>, <code>Uy</code> and <code>Uz</code> are the components of
    the U vector with respect to (O,x,y,z)</li>
  <li><code>Vx</code>, <code>Vy</code> and <code>Vz</code> are the components of
    the V vector with respect to (O,x,y,z)</li>
  <li><code>Wx</code>, <code>Wy</code> and <code>Wz</code> are the components of
    the W vector with respect to (O,x,y,z)</li>
  <li><code>Tx</code>, <code>Ty</code> and <code>Tz</code> are the coordinates
    of the new origin T with respect to (O,x,y,z)</li>
</ul>
<p><img src="images/baspp3-4.gif" width="398" height="127"></p>
<p>The two collections of <b>Constraint</b> and <b>FixTogether</b> objects can 
be retrieved from the root product object using its <code>Connections</code> method. For 
example, assuming <code>product1</code> is the root product, the <b>FixTogethers</b> 
collection can be retrieved as follows.</p>
<pre>Dim fixTogethers1 As FixTogethers
Set fixTogethers1 = product1.Connections(&quot;CATIAFixTogethers&quot;)</pre>
The <b>AssemblyConvertor</b>, <b>MaterialManager</b>, and <b>PositionedMaterial</b> objects can be retrieved from the root product using its
<code>GetItem</code> method, with&nbsp; the &quot;BillOfMaterial&quot;, &quot;CATMatManagerVBExt&quot;, 
and &quot;CATMaterialVBExt&quot; 
strings as argument respectively. Here is an example to retrieve the <b>MaterialManager</b> 
object from the <b>Product</b> object.
<pre>Dim oRootProduct As Product
...
Dim oMatManager As MaterialManager
Set oMatManager = oRootProduct.GetItem(&quot;CATMatManagerVBExt&quot;)</pre>
<p>Note that the <b>MaterialManager</b> 
and the <b>PositionedMaterial</b> objects can be retrieved the same way from the
<b>Part</b> object.</p>
<hr>
<p><i>Copyright © 1994-2005, Dassault Systèmes. All rights reserved.</i></p>

</body>

</html>
