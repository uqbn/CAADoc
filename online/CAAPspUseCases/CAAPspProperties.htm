<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<link rel="Stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css">
<title>Accessing Part properties and ID data</title>
</head>

<body>

<table width="100%">
  <tr>
    <td valign="top">
      <h1>Equipment &amp; Systems</h1>
    </td>
    <td valign="top">
      <h2>Distributive Systems</h2>
    </td>
    <td rowspan="2" align="right" valign="top">
      <h3><a name="Top"></a>Accessing Part Properties and ID Data</h3>
      <em>How to access properties and ID&nbsp; data</em></td>
  </tr>
  <tr>
    <td class="use" colspan="2">Use Case</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->

<table class="abstract">
  <tr>
    <td>
      <h3>Abstract</h3>
      <p>This article discusses the CAAPspProperties use case.</p>
      <ul>
        <li><strong><a href="#Learn">What You Will Learn With This Use Case</a></strong></li>
        <li><a href="#UseCase"><strong>The CAAPspProperties Use Case</strong></a>
          <ul>
            <li><a href="#What">What Does CAAPspProperties Do</a></li>
            <li><a href="#How">How to Launch CAAPspProperties</a></li>
            <li><a href="#Where">Where to Find the CAAPspProperties Code</a></li>
          </ul>
        </li>
        <li><strong><a href="#Step">Step-by-Step</a></strong></li>
        <li><strong><a href="#InShort">In Short</a></strong></li>
        <li><strong><a href="#References">References</a></strong></li>
      </ul>
    </td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="Learn"></a>What You Will Learn With This Use Case</h3>
<p>This use case is intended to show you how to obtain&nbsp; properties and ID
data information for a physical part.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h3><a name="UseCase"></a>The CAAPspProperties Use Case</h3>
<p>CAAPspProperties is a use case of the CAAPlantShipInterfaces.edu framework
that illustrates CATPlantShipInterfaces framework capabilities.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="What"></a>What Does CAAPspProperties Do</h4>
<p>The goal of&nbsp; CAAPspProperties is to show you how to use the
CATPlantShipInterfaces methods to query and obtain part properties and ID information.&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="How"></a>How to Launch CAAPspProperties&nbsp;</h4>
<p>To launch CAAPspProperties , you will need to set up the build time
environment, then compile CAAPspProperties along with its prerequisites, set up
the run time environment, and then execute the sample. This is fully described
in the referenced article [<a href="#References">1</a>]. When launching the use
case, you must pass the following arguments:</p>
<ul>
  <li><b>CAAPspEduIn.CATProduct</b> - the entire pathname, name and extension
    (.CATProduct) of the input drawing. Normally, it should be stored in the
    CNext/resources/graphic directory of the CAAPlantShipInterfaces.edu
    framework.</li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Where"></a>Where to Find the CAAPspProperties Code</h4>
<p>CAAPspProperties code is located in the CAAPspProperties .m use case module of
the CAAPlantShipInterfaces.edu framework:</p>
<table>
  <tr>
    <td>Windows</td>
    <td><code>InstallRootDirectory\CAAPlantShipInterfaces.edu\</code>CAAPspProperties
      <code>.m</code></td>
  </tr>
  <tr>
    <td>Unix</td>
    <td><code>InstallRootDirectory/CAAPlantShipInterfaces.edu/</code>CAAPspProperties
      <code>.m</code></td>
  </tr>
</table>
<p>where <code>InstallRootDirectory</code> is the root directory of your CAA V5
installation. It is made of&nbsp; two unique source files named
CAAPspPropertiesMain.cpp and CAAPspProperties .cpp.</p>
<p>Additional prerequisite code is located in the CAAPspUtilities.m directory of the same framework.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h3><a name="Step"></a>Step-by-Step</h3>
<p>There are five logical steps in CAAPspProperties :</p>
<ol>
  <li><a href="#Prolog">Prolog</a></li>
  <li><a href="#Initializing">Initializing the Environment</a></li>
  <li><a href="#Get List of domains and properties">Retrieving a List of Domains
    and a List of&nbsp; Properties</a></li>
  <li><a href="#Retrieving property data">Retrieving Property Data</a></li>
  <li><a href="#Get ID data">Retrieving ID Data</a></li>
</ol>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Prolog"></a>Prolog</h4>
<p>In this use case, we open an input document containing some Equipment and
Piping Design objects.&nbsp;</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Initializing"></a>Initializing the Environment</h4>
<p>The CAAPspProperties code is derived from the CAAPspBaseEnv base class.
The base class contains functionality common to the other CAAPsp samples.&nbsp;&nbsp;
Initializing the environment involves the following methods:</p>
<table class="code">
  <tr>
    <td>
      <pre>CAAPspBaseEnv::CreateCATProductEnv
CAAPspBaseEnv::ApplicationInit</pre>
    </td>
  </tr>
</table>
<p>This method performs the following functions:</p>
<ul>
  <li>Creating a session, namely &quot;Session DSA CAAPspBaseEnv
    CATProduct&quot;.</li>
  <li>Loading the input document.</li>
  <li>Initializing the document using the <i>CATInit</i> interface Init.</li>
  <li>Retrieving the pointer to the root container object.</li>
  <li>Initializing the application using the <i>CATIPspApplication</i>
    interface.</li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Get List of domains and properties"></a>Retrieving a List of
Domains and List of Properties</h4>
<p>The <i>CATIPspAttribute </i>interface is used to get a list of domains for a
part and a list of properties for a part in a given domain.&nbsp;&nbsp; In this sample, the <i>CATIPspAttribute
</i>interface
pointer is obtained from a physical part in the document.&nbsp;</p>
<table class="code">
  <tr>
    <td>
      <pre>      int NumOfDomains = 0;

      //----------------------------------------------------------------------
      //  List Domain Names
      //----------------------------------------------------------------------               
      if( SUCCEEDED( piAttribute-&gt;ListDomainNames ( &amp;pDomainNameList)) &amp;&amp; 
        ( NULL != pDomainNameList ))      
      {
        cout &lt;&lt; &quot;Succeeded in getting a list of domains for a part&quot; &lt;&lt; endl;
              
        delete pDomainNameList;  
        pDomainNameList = NULL;          
      }

      //----------------------------------------------------------------------
      // List Attributes for CATPIP domain
      //----------------------------------------------------------------------

      if( SUCCEEDED( piAttribute-&gt;ListAttributes ( &quot;CATPIP&quot;, &amp;pAttrNameList ))
         &amp;&amp; ( NULL !=  pAttrNameList) )      
      {
        cout &lt;&lt; &quot;Succeeded in getting a list of attributes&quot; &lt;&lt; endl;

        //
        // Querying attribute values and discrete values
        //
        QueryAttributeValues( piAttribute, pAttrNameList );                                                 
      }</pre>
    </td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<h4><a name="Retrieving property data"></a>Retrieving Property Data</h4>
<p>The&nbsp; <i>CATIPspAttribute </i>interface pointer is also used to get the
following additional information for each property:</p>
<ul>
  <li>Attribute type</li>
  <li>Literal value</li>
  <li>Discrete type and data</li>
  <li>If attribute is derived from a logical line. If so, reset the derived
    status of the attribute.</li>
</ul>
<p>&nbsp;</p>
<table class="code">
  <tr>
    <td>
      <pre>    for( int iAttr =1; iAttr &lt;= numAttr; iAttr++ )
    {
      CATUnicodeString uPropertyName = (*pAttrNameList)[iAttr];
      //
      // Getting type of the attribute
      //
      CATAttrKind eAttrKind;

      if( SUCCEEDED(piAttribute-&gt;GetType ( uPropertyName , eAttrKind )) )
        cout &lt;&lt; &quot;Succeeded in getting attribute type&quot; &lt;&lt; endl;

      //
      // Get Literal interface 
      //
      if( SUCCEEDED(piAttribute-&gt;GetLiteral ( uPropertyName, &amp;pCkeParm )) )
        cout &lt;&lt; &quot;Succeeded in getting literal&quot; &lt;&lt; endl;

      if( NULL != pCkeParm )
      {
        pCkeParm-&gt;Release();
        pCkeParm = NULL;
      }
      //
      // Checking if attribute is discrete or not
      // 
      CATBoolean  bDiscrete = FALSE;
      int         iDiscreteType = 0;
      if( FAILED(piAttribute-&gt;IsDiscrete ( uPropertyName, bDiscrete, iDiscreteType )) )
        cout &lt;&lt; &quot;Failed to get a discrete type status. Attribute is not discrete&quot; &lt;&lt; endl;
      else
      {
        //
        // Getting Discrete Values  ( Normal discrete attribute)
        //
        if (  bDiscrete &amp;&amp;  (iDiscreteType == 1) )              
        {                              
          if( eAttrKind == tk_string )
          {                               
            
            CATListOfCATUnicodeString DiscreteValuesList;
            if ( SUCCEEDED(piAttribute-&gt;ListStringDiscreteValues( uPropertyName, DiscreteValuesList)) )
            {
              cout &lt;&lt; &quot;Succeeded in getting string discrete values.&quot; &lt;&lt; endl;
            }            
          }
          else if ( eAttrKind == tk_integer)
          {            
            CATListOfInt iListofInt;
            
            if( SUCCEEDED(piAttribute-&gt;ListIntegerDiscreteValues( uPropertyName, iListofInt)) )
            {                
              cout &lt;&lt; &quot;Succeeded in getting integer discrete values.&quot; &lt;&lt; endl;
            }
            
          }
          else if (eAttrKind == tk_double )
          {
            CATListOfDouble dListofDouble;
            if( SUCCEEDED(piAttribute-&gt;ListDoubleDiscreteValues( uPropertyName, dListofDouble)) )
            {
              cout &lt;&lt; &quot;Succeeded in getting double discrete values.&quot; &lt;&lt; endl;
            }            
          }        
        }

        if (  bDiscrete &amp;&amp;  (iDiscreteType == 2) )
        {
          cout &lt;&lt; &quot;Discrete type is &quot; &lt;&lt;  iDiscreteType &lt;&lt; endl;
          
          CATListOfCATUnicodeString ShortDiscreteValuesList;
          CATListOfCATUnicodeString DiscreteValuesList;

          if ( FAILED(piAttribute-&gt;ListDiscreteValues( uPropertyName, ShortDiscreteValuesList, DiscreteValuesList)) )
          {
              cout &lt;&lt; &quot;FAILED to get encoded discrete values&quot; &lt;&lt;endl;
          }
          
        }        </pre>
      <pre>        //
        // Check if attribute is derived from logical line
        //
        CATBoolean Derived = FALSE;
        if( SUCCEEDED(piAttribute-&gt;IsDerived ( uPropertyName, &amp;Derived )) &amp;&amp;
            Derived )
        {
          cout &lt;&lt; uPropertyName.ConvertToChar() &lt;&lt; &quot; is derived&quot; &lt;&lt; endl;
          // Reset derived attribute
          if( SUCCEEDED(piAttribute-&gt;ResetDerivedAttr ( uPropertyName)) )
            cout &lt;&lt; &quot;Succeeded in resetting derived attribute&quot; &lt;&lt; endl;
        }
      }
    }</pre>
    </td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<h4><a name="Get ID data"></a>Retrieving ID Data</h4>
<p>The <i>CATIPspID </i>interface is used to get ID data .&nbsp;&nbsp; In this sample, the <i>CATIPspID
</i>interface
pointer is obtained from a physical part in the document.&nbsp; The <i>CATIPspID
</i>interface is used to obtain the following information from an object:&nbsp;</p>
<ul>
  <li>Generate ID without regenerating a new sequence number but retaining the
    current sequence number, if it exists.</li>
  <li>Generate and store ID without regenerating a sequence number</li>
  <li>Generate ID with a new sequence numbe and store ID&nbsp;</li>
  <li>Get current ID&nbsp;</li>
  <li>Check if current ID of the object is generated as per the ID schema</li>
  <li>Get Local ID of the object</li>
</ul>
<table class="code">
  <tr>
    <td>
      <pre>      //----------------------------------------------------------------------
      //  Generate ID without generating a new sequence number
      //---------------------------------------------------------------------- 
      CATUnicodeString oGeneratedID;
      if( SUCCEEDED( piID-&gt;GenIDNoGenSeqNum ( oGeneratedID ) ))
        cout &lt;&lt; &quot;ID generated without a sequence number: &quot; 
             &lt;&lt; oGeneratedID.ConvertToChar() &lt;&lt; endl;

      //----------------------------------------------------------------------
      //  Generate and store ID without a sequence number
      //---------------------------------------------------------------------- 
      if( SUCCEEDED( piID-&gt;GenAndPutIDNoGenSeqNum ( oGeneratedID ) ))
        cout &lt;&lt; &quot;Succeeded in generating and storing ID without a sequence number&quot; &lt;&lt; endl;

      //----------------------------------------------------------------------
      //  Generate and store ID with a sequence number
      //---------------------------------------------------------------------- 
      if( SUCCEEDED( piID-&gt;GenAndPutID ( oGeneratedID ) ))
        cout &lt;&lt; &quot;Succeeded in generating and storing ID with a sequence number&quot; &lt;&lt; endl;

      //----------------------------------------------------------------------
      // GetID
      //---------------------------------------------------------------------- 
      if( SUCCEEDED( piID-&gt;GetID ( oGeneratedID ) ))
        cout &lt;&lt; &quot;Succeeded in getting ID: &quot; 
             &lt;&lt; oGeneratedID.ConvertToChar() &lt;&lt; endl;

      //----------------------------------------------------------------------
      // Check if the ID is generated as per the schema
      //----------------------------------------------------------------------
      CATBoolean bIsGeneratedID = FALSE;
      if( SUCCEEDED( piID-&gt;IsIDGenerated ( bIsGeneratedID ) ))
        cout &lt;&lt; &quot;Succeeded in checking: IsIDGenerated&quot; &lt;&lt; endl;

      //----------------------------------------------------------------------
      // GetLocalID
      //---------------------------------------------------------------------- 
      CATUnicodeString oLocalID;
      if( SUCCEEDED( piID-&gt;GetLocalID ( oLocalID ) ))
        cout &lt;&lt; &quot;Succeeded in getting Local ID&quot; &lt;&lt; endl;</pre>
    </td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="InShort"></a>In Short</h3>
<p>This use case has demonstrated how to use the Psp interfaces to obtain part
ID and properties information.&nbsp; Specifically, it has illustrated:</p>
<ul>
  <li>Obtaining the necessary Psp Interfaces</li>
  <li>Listing the technological properties on a physical part</li>
  <li>Retrieving ID Data</li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="References"></a>References</h3>
<table width="100%">
  <tr>
    <td valign="top">[1]</td>
    <td><a href="../CAADocUseCases/CAADocRunSample.htm">Building
      and Launching a CAA V5 Use Case</a></td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="History"></a>History</h3>
<table width="100%">
  <tr>
    <td valign="top">Version: <strong>1</strong>  [March 2003]</td>
    <td valign="top">Document created</td>
  </tr>
  <tr>
    <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<p><i>Copyright © 2003, Dassault Systèmes. All rights reserved.</i></p>

</body>

</html>
