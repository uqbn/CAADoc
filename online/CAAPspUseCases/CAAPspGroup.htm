<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<link rel="Stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css">
<title>Accessing Group and Groupable Data</title>
</head>

<body>

<table width="100%">
  <tr>
    <td valign="top">
      <h1>Equipment &amp; Systems</h1>
    </td>
    <td valign="top">
      <h2>Distributive Systems</h2>
    </td>
    <td rowspan="2" align="right" valign="top">
      <h3><a name="Top"></a>Accessing Group and Groupable Data</h3>
      <em>How to create, delete and access Group and Groupable data</em></td>
  </tr>
  <tr>
    <td class="use" colspan="2">Use Case</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->

<table class="abstract">
  <tr>
    <td>
      <h3>Abstract</h3>
      <p>This article discusses the CAAPspGroup use case.</p>
      <ul>
        <li><strong><a href="#Learn">What You Will Learn With This Use Case</a></strong></li>
        <li><a href="#UseCase"><strong>The CAAPspGroup Use Case</strong></a>
          <ul>
            <li><a href="#What">What Does CAAPspGroup Do</a></li>
            <li><a href="#How">How to Launch CAAPspGroup</a></li>
            <li><a href="#Where">Where to Find the CAAPspGroup Code</a></li>
          </ul>
        </li>
        <li><strong><a href="#Step">Step-by-Step</a></strong></li>
        <li><strong><a href="#InShort">In Short</a></strong></li>
        <li><strong><a href="#References">References</a></strong></li>
      </ul>
    </td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="Learn"></a>What You Will Learn With This Use Case</h3>
<p>This use case is intended to show you how to create or instanciate a group,
such as logical line or spools, delete a group, query a group,&nbsp; and query groupable data of a part.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h3><a name="UseCase"></a>The CAAPspGroup Use Case</h3>
<p>CAAPspGroup is a use case of the CAAPlantShipInterfaces.edu framework
that illustrates CATPlantShipInterfaces framework capabilities.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="What"></a>What Does CAAPspGroup Do</h4>
<p>The goal of&nbsp; CAAPspGroup is to show you how to use the
CATPlantShipInterfaces methods to create, delete and query and obtain&nbsp; group and part
groupable&nbsp; information.&nbsp;</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="How"></a>How to Launch CAAPspGroup&nbsp;</h4>
<p>To launch CAAPspGroup , you will need to set up the build time
environment, then compile CAAPspGroup along with its prerequisites, set up
the run time environment, and then execute the sample. This is fully described
in the referenced article [<a href="#References">1</a>]. When launching the use
case, you must pass the following arguments:</p>
<ul>
  <li><b>CAAPspEduIn.CATProduct</b> - the entire pathname, name and extension
    (.CATProduct) of the input drawing. Normally, it should be stored in the
    CNext/resources/graphic directory of the CAAPlantShipInterfaces.edu
    framework.</li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Where"></a>Where to Find the CAAPspGroup Code</h4>
<p>CAAPspGroup code is located in the CAAPspGroup .m use case module of
the CAAPlantShipInterfaces.edu framework:</p>
<table>
  <tr>
    <td>Windows</td>
    <td><code>InstallRootDirectory\CAAPlantShipInterfaces.edu\</code>CAAPspGroup
      <code>.m</code></td>
  </tr>
  <tr>
    <td>Unix</td>
    <td><code>InstallRootDirectory/CAAPlantShipInterfaces.edu/</code>CAAPspGroup
      <code>.m</code></td>
  </tr>
</table>
<p>where <code>InstallRootDirectory</code> is the root directory of your CAA V5
installation. It is made of&nbsp; two unique source files named CAAPspGroupMain.cpp and
CAAPspGroup .cpp.</p>
<p>Additional prerequisite code is located in the CAAPspUtilities.m directory of the same framework.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h3><a name="Step"></a>Step-by-Step</h3>
<p>There are four logical steps in CAAPspGroup :</p>
<ol>
  <li><a href="#Prolog">Prolog</a></li>
  <li><a href="#Initializing">Initializing the Environment</a></li>
  <li><font color="#0000FF"><a href="#CATIPspGroup">Managing and Querying Group
    Membership</a></font></li>
  <li><font color="#0000FF"><a href="#CATIPspGroupable"> Querying a
    Groupable's Membership in a Group</a></font></li>
  <li><font color="#0000FF"><a href="#CATIPspAppFactory">Instanciating, Deleting
    and Querying Groups in a Document</a></font></li>
</ol>
<p align="right"><a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Prolog"></a>Prolog</h4>
<p>In this use case, we open an input document containing some Equipment and
Piping Design objects.&nbsp;</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Initializing"></a>Initializing the Environment</h4>
<p>The CAAPspGroup code is derived from the CAAPspBaseEnv base class.
The base class contains functionality common to the other CAAPsp samples.&nbsp;&nbsp;
Initializing the environment involves the following methods:</p>
<table class="code">
  <tr>
    <td>
      <pre>CAAPspBaseEnv::CreateCATProductEnv
CAAPspBaseEnv::ApplicationInit</pre>
    </td>
  </tr>
</table>
<p>This method performs the following functions:</p>
<ul>
  <li>Creating a session, namely &quot;Session DSA CAAPspBaseEnv
    CATProduct&quot;.</li>
  <li>Loading the input document.</li>
  <li>Initializing the document using the <i>CATInit</i> interface Init.</li>
  <li>Retrieving the pointer to the root container object.</li>
  <li>Initializing the application using the <i>CATIPspApplication</i>
    interface.</li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="CATIPspGroup"></a>Managing and Querying Group Membership</h4>
<p>The <i>CATIPspGroup </i>interface is used to get a list of&nbsp; group
members, to remove members from and add members to a group.&nbsp;&nbsp; In this sample, the <i>CATIPspGroup </i>interface
pointer is obtained from a Logical Line in the document.&nbsp;</p>
<table class="code" width="906">
  <tr>
    <td width="898">
      <pre>      //----------------------------------------------------------------------
      //  List Members
      //---------------------------------------------------------------------- 
      if ( SUCCEEDED(piGroup-&gt;ListMembers ( NULL, &amp;pListMembers )) &amp;&amp;
        ( NULL != pListMembers))
      {  
        cout &lt;&lt; &quot;Succeeded in getting group's members&quot; &lt;&lt; endl;

        unsigned int LUnknownSize = 0;
        int NumOfUnknowns = 0;
        if (pListMembers &gt; 0)
            pListMembers-&gt;Count (&amp;LUnknownSize);
        NumOfUnknowns = LUnknownSize;
         
        cout &lt;&lt; &quot;Number of members is &quot; &lt;&lt;  NumOfUnknowns &lt;&lt; endl;

        if (NumOfUnknowns &gt; 0)
        {
          for (int iUK=1; iUK &lt;= NumOfUnknowns; iUK++)
          {
            if (SUCCEEDED(pListMembers-&gt;Item (iUK-1,&amp;piUKMember)) &amp;&amp; piUKMember )
            {     
              //
              // Getting CATIPspGroupable interface pointer
              //
              rc = piUKMember-&gt;QueryInterface (IID_CATIPspGroupable, (void **)&amp;piGroupable);            
              piUKMember-&gt;Release();
              piUKMember = NULL; 
              if ( NULL != piGroupable ) break;            
            }
          }
        }               
        pListMembers-&gt;Release();
        pListMembers = NULL;            
      }

      if ( NULL != piGroupable )
      {
        //--------------------------------------------------------------------
        //  Remove a member
        //-------------------------------------------------------------------- 
        if ( SUCCEEDED(piGroup-&gt;RemoveMember(piGroupable)) )
           cout &lt;&lt; &quot;Succeeded in removing a member from the group&quot; &lt;&lt; endl;  

        //--------------------------------------------------------------------
        //  Add a member
        //-------------------------------------------------------------------- 
        if ( SUCCEEDED(piGroup-&gt;AddMember(piGroupable)) )
           cout &lt;&lt; &quot;Succeeded in adding a member to the group&quot; &lt;&lt; endl;  
      }</pre>
    </td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<h4><a name="CATIPspGroupable"></a> Querying a Groupable's
Membership in a Group</h4>
<p>The&nbsp; CATIPspGroupable&nbsp; interface pointer is obtained from one of
the group members and is used to get the following information:</p>
<ul>
  <li>List of parent groups associated with this group member
</ul>
<table class="code">
  <tr>
    <td>
      <pre>      //----------------------------------------------------------------------
      //  List groups that the groupable belongs to
      //---------------------------------------------------------------------- 
      if ( SUCCEEDED( piGroupable-&gt;ListGroups( NULL, &amp;pListGroups)) 
           &amp;&amp; (NULL != pListGroups) )
      {
        cout &lt;&lt; &quot;Succeeded in getting list of groups&quot; &lt;&lt; endl;
      }</pre>
    </td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<h4><a name="CATIPspAppFactory"></a> Instanciating, Deleting and Querying Groups
in a Document</h4>
<p>The <i>CATIPspAppFactory </i>interface is used to get a list of&nbsp; groups
in the current document; to instanciate or create a logical line, compartment or
group; to delete a logical line, compartment or group.&nbsp; The <i>CATIPspAppFactory </i>interface
pointer is obtained from the root product of the document.&nbsp;</p>
<ul>
  <li>Instanciate a logical line from a catalog
</ul>
<table class="code">
  <tr>
    <td>
      <pre>      //----------------------------------------------------------------------
      //  Instanciate a PipingLine from the PipingLine catalog
      //---------------------------------------------------------------------- 
      CATUnicodeString PipingLineID = &quot;U1-P103-6in-CS150R-FG&quot;;
      if ( SUCCEEDED(piAppFactory-&gt;GetLogicalLine(piCurrentProduct,
            PipingLineID, &amp;piLogicalLine)) &amp;&amp; (NULL != piLogicalLine) )
      {
        cout &lt;&lt; &quot;Succeeded in instanciating a Piping Line&quot; &lt;&lt; endl;</pre>
    </td>
  </tr>
</table>
<ul>
  <li>List the logical line instances in the document
</ul>
<table class="code">
  <tr>
    <td>
      <pre>        if ( SUCCEEDED(piAppFactory-&gt;ListLogicalLines(piCurrentProduct,&amp;pListLogicalLines))
             &amp;&amp; (NULL != pListLogicalLines) ) 
        {
          unsigned int LUnknownSize = 0;
          int NumOfUnknowns = 0;
          pListLogicalLines-&gt;Count (&amp;LUnknownSize);
          NumOfUnknowns = LUnknownSize;
          cout &lt;&lt; &quot;Number of PipingLines in document = &quot; &lt;&lt; NumOfUnknowns &lt;&lt; endl;
          pListLogicalLines-&gt;Release();
          pListLogicalLines = NULL;
        }</pre>
    </td>
  </tr>
</table>
<ul>
  <li>Delete a logical line instance
</ul>
<table class="code">
  <tr>
    <td>
      <pre>      if ( SUCCEEDED(piAppFactory-&gt;DeleteLogicalLine(piLogicalLine)) )
          cout &lt;&lt; &quot;Succeeded in deleting a PipingLine instance&quot; &lt;&lt; endl;</pre>
    </td>
  </tr>
</table>
<ul>
  <li>Create a Piping Spool group
</ul>
<table class="code">
  <tr>
    <td>
      <pre>      CATUnicodeString GroupType = &quot;CATPipSpool&quot;;
      CATUnicodeString GroupID = &quot;PipingSpool&quot;;
      if ( SUCCEEDED(piAppFactory-&gt;CreateGroup(piCurrentProduct,
            GroupType, GroupID, &amp;piGroup)) &amp;&amp; (NULL != piGroup) )
      {
        cout &lt;&lt; &quot;Succeeded in creating a Piping Spool&quot; &lt;&lt; endl;</pre>
    </td>
  </tr>
</table>
<ul>
  <li>List the group instances, other than logical lines and compartments
</ul>
<table class="code">
  <tr>
    <td>
      <pre>        if ( SUCCEEDED(piAppFactory-&gt;ListGroups(piCurrentProduct,&amp;pListGroups))
             &amp;&amp; (NULL != pListGroups) ) 
        {
          unsigned int LUnknownSize = 0;
          int NumOfUnknowns = 0;
          pListGroups-&gt;Count (&amp;LUnknownSize);
          NumOfUnknowns = LUnknownSize;
          ...
          ...
        }</pre>
    </td>
  </tr>
</table>
<ul>
  <li>Delete a Piping Spool group
</ul>
<table class="code">
  <tr>
    <td>
      <pre>      if ( SUCCEEDED(piAppFactory-&gt;DeleteGroup(piGroup)) )
          cout &lt;&lt; &quot;Succeeded in deleting a Piping spool object&quot; &lt;&lt; endl;</pre>
    </td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<h3><a name="InShort"></a>In Short</h3>
<p>This use case has demonstrated how to use the Psp interfaces to obtain Group and part Groupable information.&nbsp; Specifically, it has illustrated:</p>
<ul>
  <li>Obtaining the necessary Psp Interfaces</li>
  <li>Listing group members, adding and removing members</li>
  <li>Listing parent groups containing a specific group member</li>
  <li>Creating, deleting and listing logical lines and groups</li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="References"></a>References</h3>
<table width="100%">
  <tr>
    <td valign="top">[1]</td>
    <td><a href="../CAADocUseCases/CAADocRunSample.htm">Building
      and Launching a CAA V5 Use Case</a></td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="History"></a>History</h3>
<table width="100%">
  <tr>
    <td valign="top">Version: <strong>1</strong>  [March 2003]</td>
    <td valign="top">Document created</td>
  </tr>
  <tr>
    <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<p><i>Copyright © 2003, Dassault Systèmes. All rights reserved.</i></p>

</body>

</html>
