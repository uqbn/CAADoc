<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 6.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<link rel="Stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css">
<title>Creating Center Lines in a CATDrawing Document</title>
</head>

<body>

<table width="100%">
  <tr>
    <td valign="top">
      <h1>Mechanical Design</h1>
    </td>
    <td valign="top">
      <h2>Drafting</h2>
    </td>
    <td rowspan="2" align="right" valign="top">
      <h3><a name="Top"></a>Creating Center Lines in a CATDrawing Document</h3>
      <em>How to create annotations on interactive or generative geometry</em></td>
  </tr>
  <tr>
    <td class="use" colspan="2">Use Case</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->

<table class="abstract">
  <tr>
    <td>
      <h3>Abstract</h3>
      <p>This article discusses the CAADrwCenterLine use case. This use case
      explains how to create center lines on interactive or generative geometry
      in a CATDrawing document.</p>
      <ul>
        <li><a href="#Learn"><strong>What You Will Learn With This Use Case</strong></a>
        <li><a href="#Interfaces"><strong>About the Use of IDMxxx2D and
          CATI2Dxxx Interfaces</strong></a>
        <li><a href="#UseCase"><strong>The CAADrwCenterLine Use Case</strong></a>
          <ul>
            <li><a href="#What">What Does CAADrwCenterLine Do</a>
            <li><a href="#How">How to Launch CAADrwCenterLine</a></li>
            <li><a href="#Where">Where to Find the CAADrwCenterLine Code</a></li>
          </ul>
        </li>
        <li><a href="#Step"><strong>Step-by-Step</strong></a>
        <li><a href="#InShort"><strong>In Short</strong></a></li>
        <li><a href="#References"><strong>References</strong></a></li>
      </ul>
    </td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->

<h3><a name="Learn"></a>What You Will Learn With This Use Case</h3>
<p>In this use case you will learn how to create annotations (center lines) on
interactive and generative geometry.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h3><a name="Interfaces"></a>About the Use of IDMxxx2D and CATI2Dxx Interfaces</h3>
<p>There are two levels of interfaces:</p>
<ol>
  <li>IDMxxx2D for consulting
  <li>CATI2Dxxx for editing.</li>
</ol>
<table>
  <caption>Fig. 1: The 2D Interfaces UML Diagram</caption>
  <tr>
    <td><img border="0" src="images/CAADrwCenterLine2.jpg" width="424" height="287"></td>
  </tr>
</table>
<p>The IDM interfaces are standard interfaces (Interfaces for Design and
Modeling). IDMs may be re-implemented for user-defined objects. This is the way
to integrate those elements in:</p>
<ul>
  <li>Sketcher picking assistant</li>
  <li>Drafting annotations.</li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h3><a name="UseCase"></a>The CAADrwCenterLine Use Case</h3>
<p>CAADrwCenterLine is a use case of the CAADraftingInterfaces.edu framework
that illustrates DraftingInterfaces framework capabilities.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="What"></a>What Does CAADrwCenterLine Do</h4>
<p>This use case is made of a state command that waits for a selection and
creates center lines on selected circles.</p>
<table>
  <caption>Fig. 2: Running the Command on Generative and Interactive Geometry</caption>
  <tr>
    <td><img border="0" src="images/CAADrwCenterLine1.jpg" width="470" height="433" style="position: relative"></td>
  </tr>
</table>
<p>This picture represents two views :</p>
<ol>
  <li>The generative view of a CATPart with additional geometry (the two green
    circles)</li>
  <li>The same view after applying the command on it. Center lines were created
    on the selected circles.</li>
</ol>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="How"></a>How to Launch CAADrwCenterLine</h4>
<p>To launch CAADrwCenterLine, you will need to set up the build time
environment, then compile CAADrwCenterLine and CAADrwAddin along with its prerequisites, set up
the run time environment.[<a href="#References">1</a>].</p>
<ol>
  <li>Launch CATIA session.</li>
  <li>Right-click on Drafting workshop to activate CAAUseCaseCommands toolbar.</li>
  <li>Launch the Center line use case command, and select geometry.</li>
</ol>
<p align="right"><a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Where"></a>Where to Find the CAADrwCenterLine Code</h4>
<p>The CAADrwCenterLine use case is made of two source files named
CAADrwCenterLine.h and CAADrwCenterLine.cpp located in the CAADrwCenterLine.m
module of the CAADraftingInterfaces.edu framework:</p>
<table>
  <tr>
    <td>Windows</td>
    <td><code>InstallRootDirectory\CAADraftingInterfaces.edu\CAADrwCenterLine.m\</code></td>
  </tr>
  <tr>
    <td>Unix</td>
    <td><code>InstallRootDirectory/CAADraftingInterfaces.edu/CAADrwCenterLine.m/</code></td>
  </tr>
</table>
<p>where <code>InstallRootDirectory</code> is the directory where the CAA CD-ROM
is installed.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h3><a name="Step"></a>Step-by-Step</h3>
<p>There are two steps in CAADrwCenterLine:</p>
<ol>
  <li><a href="#Creating">Building the State Chart and Creating the Appropriate
    Selection Agent.</a>
  <li><a href="#retriev">Retrieving the Selection and Creating the Center Line</a></li>
</ol>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="Creating"></a>Building the State Chart and Creating the Appropriate
Selection Agent</h4>
<table class="code">
  <tr>
    <td>
      <pre>void CAADrwCenterLineCmd::BuildGraph()
{  
   // Creation of the acquisition agent
   _ObjectAgent = new CATPathElementAgent(&quot;_ObjectAgent A&quot;);
   _ObjectAgent -&gt;SetBehavior( CATDlgEngWithPrevaluation | 
                               CATDlgEngMultiAcquisition | 
                               CATDlgEngWithCSO); 

   // We only want to get circles
   _ObjectAgent -&gt;AddElementType(&quot;<b>IDMCircle2D</b>&quot;);
   AddCSOClient(_ObjectAgent);
   
   //  States definition
   CATDialogState* pState1 = GetInitialState(&quot;Sel circle&quot;);
   pState1-&gt;AddDialogAgent(_ObjectAgent);
   
   // Transition definition
   AddTransition(pState1, NULL, IsOutputSetCondition(_ObjectAgent),
                 Action((ActionMethod)&amp;CAADrwCenterLineCmd::CreateCtrLine, NULL, NULL));
}</pre>
    </td>
  </tr>
</table>
<p>In this section we create a CATPathElementAgent and set the corresponding
element type to IDMCircle. So only circles could be selected [<a href="#References">2</a>].</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="retriev"></a>Retrieving the Selection and Creating the Center Line</h4>
<table class="code">
  <tr>
    <td>
      <pre>boolean CAADrwCenterLineCmd::CreateCtrLine(void *iData)
{ 
   CATSO* pObjSO = _ObjectAgent-&gt;GetListOfValues(); 
   CATPathElement *pElemPath = NULL;
   
   if (NULL != pObjSO)  
   {
      // We will scan the CSO from the begining
      pObjSO-&gt;InitElementList();
      while (NULL != (pElemPath = (CATPathElement*)pObjSO-&gt;NextElement())  )
      {
         
         // Make sure the element is a circle type
         // This circle can be interactive or a generative result (from part, model, ...)
         IDMCircle2D *piElementRef = (IDMCircle2D *)pElemPath-&gt;<b>FindElement(IID_IDMCircle2D)</b>;
         
         if (NULL != piElementRef)
         {
            // Find the annotation factory (on the view)
            <b>CATIDrwAnnotationFactory</b> *piDrwFact = (CATIDrwAnnotationFactory *)pElemPath-&gt;FindElement(IID_CATIDrwAnnotationFactory);
            if (NULL != piDrwFact)
            {
               // Let's create the center line
               piDrwFact-&gt;<b>CreateDrwCenterLine</b>((CATBaseUnknown *)piElementRef);
               piDrwFact-&gt;Release();
            }
            piElementRef-&gt;Release();
         }
      }
      
      _ObjectAgent -&gt; InitializeAcquisition();
      return TRUE;
   }
   return FALSE;
}</pre>
    </td>
  </tr>
</table>
<p>The acquisition agent did put the selected circles into the CSO. So we get
the SO and loop on it. The selected circles can be generative ones or
interactive ones. We get the annotation factory on the view and call the center
line factory method giving the circle as argument.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="InShort"></a>In Short</h3>
<p>This use case shows how to create a state command dealing with geometry
selections. The <i>IDMxx2D</i> interfaces identificators are used as filters and
allows the selection of interactive and generative geometry. Using the <i>CATIDrwAnnotationFactory,</i>
interface, implemented by the view, it is possible to create annotations on
these geometries.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="References"></a>References</h3>
<table width="100%">
  <tr>
    <td valign="top">[1]</td>
    <td><a href="../CAADocUseCases/CAADocRunSample.htm">Building
      and Lauching a CAA V5 Use Case</a></td>
  </tr>
  <tr>
    <td valign="top">[2]</td>
    <td><a href="../CAADegUseCases/CAADegSampleGraph.htm">Implementing
      the Statechart Diagram</a></td>
  </tr>
  <tr>
    <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="History"></a>History</h3>
<table width="100%">
  <tr>
    <td valign="top">Version: <strong>1</strong> [Jan 2000]</td>
    <td valign="top">Document created</td>
  </tr>
  <tr>
    <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<p><i>Copyright © 2000, Dassault Systèmes. All rights reserved.</i></p>

</body>

</html>
