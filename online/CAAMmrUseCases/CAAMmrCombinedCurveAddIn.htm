<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<link rel="Stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css">
<title>Creating an Add-in in the Shape Design Workbench</title>
</head>

<body>

<table width="100%">
  <tr>
    <td valign="top">
      <h1>Mechanical Modeler</h1>
    </td>
    <td valign="top">
      <h2></h2>
    </td>
    <td rowspan="2" align="right" valign="top">
      <h3><a name="Top"></a>Creating an Add-in in the Shape Design Workbench</h3>
      <em>Customize your application to fully take advantage of this new feature</em></td>
  </tr>
  <tr>
    <td class="use" colspan="2">Use Case</td>
  </tr>
  <tr>
    <td colspan="3">
      <p><a href="CAAMmrCombinedCurveSamplesOverview.htm">Creating a New
      Geometrical Feature: the Combined Curve</a> &gt;<a name="Top"></a><b>Creating
      an Add-in in the Shape Design Workbench</b></p>
    </td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->

<table class="abstract">
  <tr>
    <td>
      <h3>Abstract</h3>
      <p>This use case completes the Shape Design Workbench by adding a new
      toolbar containing a new command corresponding to Combined Curve Creation.
      <ul>
        <li><strong><a href="#Learn">What You Will Learn With This Use Case</a></strong></li>
        <li><a href="#UseCase"><strong>The CAAMmrCombinedCurveAddIn Use Case</strong></a>
          <ul>
            <li><a href="#What">What Does CAAMmrCombinedCurveAddIn Do</a></li>
            <li><a href="#How">How to Launch CAAMmrCombinedCurveAddIn</a></li>
            <li><a href="#Where">Where to Find the CAAMmrCombinedCurveAddIn Code</a></li>
          </ul>
        </li>
        <li><a href="#Step"><strong>Step-by-Step</strong></a></li>
        <li><a href="#InShort"><strong>In Short</strong></a></li>
        <li><a href="#References"><strong>References</strong></a></li>
      </ul>
    </td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="Learn"></a>What You Will Learn With This Use Case</h3>
<p>This use case creates a new toolbar in the Shape Design workbench to present
a Combined Curve creation icon.</p>
<table>
  <tr>
    <td><img border="0" src="images/CombinedCurveAddIn.gif" width="597" height="544"></td>
    <td>Thanks to this Use Case, the newborn Combined Curve Mechanical Feature
      is now fully integrated with other Shape Design Features.</td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h3><a name="UseCase"></a>The CAAMmrCombinedCurveAddIn Use Case</h3>
<p>CAAMmrCombinedCurveAddIn is a use case of the CAAMechanicalModeler.edu
framework that illustrates MechanicalModeler framework capabilities.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="What"></a>What Does the CAAMmrCombinedCurveAddIn Use Case Do</h4>
<p>This use case creates an add-in implementing the <i>CATIShapeDesignWorkshopAddin</i>
interface. This interface is precisely defined to add toolbars or commands to
the Shape Design workbench.</p>
<p>Another use case describes in detail how to create an add-in [<a href="#References">1</a>].</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="How"></a>How to Launch CAAMmrCombinedCurveAddIn</h4>
<p>See the section entitled &quot;How to Launch the Combined Curve Use
Case&quot; in the &quot;<a href="CAAMmrCombinedCurveSamplesOverview.htm">Creating
a New Geometrical Feature: The Combined Curve</a>&quot; use case for a detailed
description of how this use case should be launched.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="Where"></a>Where to Find the CAAMmrCombinedCurveAddIn Code</h4>
<p>The CAAMmrCombinedCurveAddIn use case is made of a several classes located in
the CAAMmrCombinedCurveAddIn.m module of the CAAMechanicalModeler.edu framework:</p>
<table>
  <tr>
    <td>Windows</td>
    <td><code>InstallRootDirectory\CAAMechanicalModeler.edu\CAAMmrCombinedCurveAddIn.m\</code></td>
  </tr>
  <tr>
    <td>Unix</td>
    <td><code>InstallRootDirectory/CAAMechanicalModeler.edu/CAAMmrCombinedCurveAddIn.m/</code></td>
  </tr>
</table>
<p>where <code>InstallRootDirectory</code> is the directory where the CAA CD-ROM
is installed.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h3><a name="Step"></a>Step-by-Step</h3>
<p>To create the add-in, you should first create a separate module directory to
store the add-in code. This is CAAMmrCombinedCurveAddIn.m for this use case.
<p>In this module, you have to:
<ul>
  <li><a href="#Step1">Creating the Add-in Description Class</a></li>
  <li><a href="#Step2">Creating the Command Headers</a></li>
  <li><a href="#Step3">Creating the Toolbar and Arranging the Command</a></li>
  <li><a href="#Step4">Providing the Resources</a></li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="Step1"></a>Creating the Add-in Description Class</h4>
<p>The add-in extends the <i>CAAMmrCombinedCurveAddin</i> late type to implement
the interface <i>CATIShapeDesignWorkshopAddin</i>.</p>
<table class="code">
  <tr>
    <td>
      <pre>CATImplementClass(CAAEMmrCombinedCurveAdn,
                  DataExtension,
                  CATBaseUnknown,
                  <b>CAAMmrCombinedCurveAddin</b>);

#include &lt;TIE_CATIShapeDesignWorkshopAddin.h&gt; // needed to tie the implementation to its interface
TIE_CATIShapeDesignWorkshopAddin(CAAEMmrCombinedCurveAdn);</pre>
    </td>
  </tr>
</table>
<p>Do not forget to update your dictionary. <i>CAAMmrCombinedCurveAddin</i> is
extended to implement <i>CATIShapeDesignWorkshopAddin</i>.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="Step2"></a>Creating the Command Header</h4>
<p>The <code>MacDeclareHeader</code> macro creates the header file and the
source file for the <i>CAAEMmrCombinedCurveAdnHeader</i> class, and associates
with this class the resource files CAAEMmrCombinedCurveAdnHeader.CATNls and
CAAEMmrCombinedCurveAdnHeader.CATRsc.</p>
<table class="code">
  <tr>
    <td>
      <pre>// Creates the CAAEMmrCombinedCurveAdnHeader command header class
MacDeclareHeader(CAAEMmrCombinedCurveAdnHeader);</pre>
    </td>
  </tr>
</table>
<p>To create the Command Header, use the <code>CreateCommands</code> method:</p>
<table class="code">
  <tr>
    <td>
      <pre>void CAAEMmrCombinedCurveAdn::<b>CreateCommands</b>()
{
  new CAAEMmrCombinedCurveAdnHeader(&quot;<b>CAAMmrCombinedCurveHdr</b>&quot;,
                                    &quot;CAAMmrCombinedCurveUI&quot;,
                                    &quot;CAAMmrCombCrvPanelStCmd&quot;,
                                    (void *)NULL );
}</pre>
    </td>
  </tr>
</table>
<ul>
  <li>&quot;<b>CAAMmrCombinedCurveHdr</b>&quot; is the identifier you assign to
    the Command Header.</li>
  <li>&quot;<b>CAAMmrCombinedCurveUI</b>&quot; is the shared library or DLL
    containing the Combined Curve Command's code.</li>
  <li>&quot;<b>CAAMmrCombCrvPanelStCmd</b>&quot; is the name of the Combine
    Curve Edition Command.</li>
  <li>The last argument is the possible pointer to the object to pass to the
    command when executing it.</li>
</ul>
<p>The <i>CAAMmrCombCrvPanelStCmd</i> class enables to create or edit an
Combined Curve feature. You can refer to the &quot;Editing Combined Curves&quot;
use case [<a href="#References">2</a>] for details about this command class.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<h4><a name="Step3"></a>Creating the Toolbar and Arranging the Command</h4>
<p>Finally, we'll create the toolbar and arrange the command. This is the job of
the <code><b>CreateToolbars</b></code> method.</p>
<table class="code">
  <tr>
    <td>
      <pre>CATCmdContainer* CAAEMmrCombinedCurveAdn::<b>CreateToolbars</b>()
{
    NewAccess        ( CATCmdContainer  , <b>pCombinedCurveWkb</b> , CAAMmrCombinedCurveTlb );
    
    NewAccess        ( CATCmdStarter    , pCombinedCurve    , CAAMmrCombinedCurveStr );
    SetAccessCommand ( pCombinedCurve    , &quot;<b>CAAMmrCombinedCurveHdr</b>&quot; );
    SetAccessChild   ( pCombinedCurveWkb , pCombinedCurve  );
    
    <b>AddToolbarView</b>   ( pCombinedCurveWkb , -1 , Right ); 
    
    return <b>pCombinedCurveWkb</b>;
}</pre>
    </td>
  </tr>
</table>
<ul>
  <li>The Combined Curve toolbar is created as an instance of the <i>CATCmdContainer</i>
    class using the <code>NewAccess</code> macro. <code>pCombinedCurveWkb</code>
    is the variable used to handle the CombinedCurve toolbar command container
    instance pointer, and <code>CombinedCurve</code> is the identifier used to
    refer to it in the add-in resource files.<br>
    The Combined Curve toolbar default location is defined using the <code>AddToolbarView</code>
    macro, where <code>-1</code> means that the toolbar is invisible by default
    (<code>1</code> means visible), and <code>Right</code> means that the
    toolbar is docked at the right side of the application window.
  <li>Three macros are required for each command.&nbsp;
    <ol>
      <li>First, the command starter is created as a <i>CATCmdStarter</i>
        instance using the <code>NewAccess</code> macro. <code>pCombinedCurve</code>
        is the variable used to handle a pointer to that instance, and <code>CAAMmrCombinedCurveStr</code>
        is its identifier.
      <li>Then the Combined Curve command header is associated with this command
        starter using the <code>SetAccessCommand</code> macro.
      <li>Finally the Combined Curve command starter is set as the child of the
        Combined Curve toolbar.</li>
    </ol>
  </li>
</ul>
<p>Once again, refer to the use case describing how to create an add-in [<a href="#References">1</a>]
to get more details: for example about these macros and how insert the command
in the menu bar.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<h4><a name="Step4"></a>Providing the Resources</h4>
<p>You should provide the resources for the toolbar and for all its commands.</p>
<ul>
  <li><b>CAAEMmrCombinedCurveAdnHeader.CATRsc</b> contains information about the
    icon to display.
    <table class="code">
      <tr>
        <td>
          <pre>CAAEMmrCombinedCurveAdnHeader.CombinedCurve.Icon.Normal  = &quot;CAAMmr_I_CombinedCurve&quot;;</pre>
        </td>
      </tr>
    </table>
    <table>
      <tr>
        <td><img border="0" src="images/CAAMmr_I_CombinedCurve.jpg" width="22" height="22"></td>
        <td>You provide the &quot;normal&quot; icon. It must be located in the
          resources/graphic directory. The pressed and focused are automatically
          generated.</td>
      </tr>
    </table>
  </li>
  <li><b>CAAEMmrCombinedCurveAdnHeader.CATNls</b> contains text message in
    English if located in the CNext\Resources\msgcatalog directory.
    <table class="code">
      <tr>
        <td>
          <pre>CAAEMmrCombinedCurveAdnHeader.CombinedCurve.Title     = <b>&quot;CombinedCurve&quot;</b>;
CAAEMmrCombinedCurveAdnHeader.CombinedCurve.ShortHelp = <b>&quot;CAAMmrCombinedCurve&quot;</b>;
CAAEMmrCombinedCurveAdnHeader.CombinedCurve.Help      = <b>&quot;Creates a Combined Curve&quot;</b>;
CAAEMmrCombinedCurveAdnHeader.CombinedCurve.LongHelp  = <b>&quot;Combined Curve using two curves and two directions</b>&quot;;
CAAEMmrCombinedCurveAdnHeader.CombinedCurve.Category  = <b>&quot;Insert&quot;;</b></pre>
        </td>
      </tr>
    </table>
    <p>If you want to provide help for this new command in several languages,
    just copy (and translate!) this file in CNext\Resources\msgcatalog\German
    for German, CNext\Resources\msgcatalog\Japanese for Japanese,
    CNext\Resources\msgcatalog\French for French, etc.</li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="InShort"></a>In Short</h3>
<p>Thanks to the Add-in technology, this last use case of the Combined Curve Use
Case makes it possible to create a Combined Curve by Clicking on an icon of the
Shape Design Workbench. Combined Curve are now perfectly integrated among V5
Mechanical Design Applications.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="References"></a>References</h3>
<table width="100%">
  <tr>
    <td valign="top">[1]</td>
    <td><a href="../CAAAfrUseCases/CAAAfrSampleAddin.htm">Creating
      an Add-in</a></td>
  </tr>
  <tr>
    <td valign="top">[2]</td>
    <td><a href="CAAMmrCombinedCurveCATIEdit.htm">Editing Combined Curves</a></td>
  </tr>
  <tr>
    <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="History"></a>History</h3>
<table width="100%">
  <tr>
    <td valign="top">Version: <strong>1</strong> [Mar 2000]</td>
    <td valign="top">Document created</td>
  </tr>
  <tr>
    <td valign="top">Version: <strong>2</strong> [Jan 2003]</td>
    <td valign="top">Document updated</td>
  </tr>
  <tr>
    <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<p><i>Copyright © 2000, Dassault Systèmes. All rights reserved.</i></p>

</body>
