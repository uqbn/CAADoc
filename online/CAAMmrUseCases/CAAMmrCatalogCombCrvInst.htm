<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<link rel="Stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css">
<title>Instantiating a Catalog Component</title>
</head>

<body>

<table width="100%">
  <tr>
    <td valign="top">
      <h1>Catalog Modeler</h1>
    </td>
    <td valign="top">
      <h2></h2>
    </td>
    <td rowspan="2" align="right" valign="top">
      <h3><a name="Top"></a>Instantiating a Catalog Component</h3>
      <em>Using CATICatalogDescription to make an instantiation</em></td>
  </tr>
  <tr>
    <td class="use" colspan="2">Use Case</td>
  </tr>
</table>
<hr>

<!---------------------------------comment------------------------------------->

<table class="abstract">
  <tr>
    <td>
      <h3>Abstract</h3>
      <p>This use case shows how to instantiate a catalog component.</p>
      <ul>
        <li><a href="#Learn"><strong>What You Will Learn With This Use Case</strong></a></li>
        <li><a href="#UseCase"><strong>The CAAMmrCatalogInstantiation Use Case</strong></a>
          <ul>
            <li><a href="#What">What Does CAAMmrCatalogInstantiation Do</a></li>
            <li><a href="#How">How to Launch CAAMmrCatalogInstantiation</a></li>
            <li><a href="#Where">Where to Find the CAAMmrCatalogInstantiation
              Code</a></li>
          </ul>
        <li><a href="#Step"><strong>Step-by-Step</strong></a></li>
        <li><a href="#InShort"><strong>In Short</strong></a></li>
        <li><a href="#References"><strong>References</strong></a></li>
      </ul>
</table>
<hr>
<!---------------------------------comment------------------------------------->

<h3><a name="Learn"></a>What You Will Learn With This Use Case</h3>
<p>One interest of a catalog is to instantiate its components. A component can
be&nbsp;</p>
<ul>
  <li>a document (Part, Product,..)</li>
  <li>a feature</li>
  <li>a user feature, a power copy</li>
  <li>...</li>
</ul>
<p>If the use case CAAMmrCatalogIntegration [<a href="#References">1</a>]
explains how to integrate a new type of component in a catalog document, this
use case details how to instantiate it.</p>
<p>The instantiation must be done in using the <code>RunInstantiationCmd</code>
method of the <i>CATICatalogDescription</i> interface. In most cases this method
launches an interactive command to create the new component. It means that an
instantiation can only be done during an interactive session. For some
component, a &quot;direct&quot; instantiation can be done, in using its own
mechanism of instantiation.&nbsp;</p>
<p>Before getting to the use case itself, it is important to already be familiar
with the basic notions of Catalog. See the referenced article [<a href="#References">2</a>]
for a detailed overview.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h3><a name="UseCase"></a>The CAAMmrCatalogInstantiation Use Case</h3>
<p>CAAMmrCatalogInstantiation is a use case of the CAAMechanicalModeler.edu
framework that illustrates ComponentsCatalogsInterfaces framework capabilities.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="What"></a>What Does CAAMmrCatalogInstantiation Do</h4>
<p>This use case is an extract of the CAAMmrCatalogBrowser use case [<a href="#References">3</a>].
This use case creates a command which launches a dialog box [<a href="#Fig.1">Fig.1</a>]
to demonstrate the usage of the Catalog Browser. On this dialog box the last
frame &quot;<code>Current Selection</code>&quot; enables to display the selected
description, and when it is an instantiable component, the&nbsp;&quot;<code>Launch</code>&quot;
button is available. The aim of this use case is to explain the contents of the
callback method called when the end user clicks on the <code>Launch</code>
button.&nbsp;</p>
<table width="430">
  <caption><i><a name="Fig.1">Fig.</a>1 The Catalog Browser Demonstrator</i></caption>
  <tr>
    <td><img border="0" src="images/CAAMmrCatalogInstantiation.jpg" width="365" height="316">
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="How"></a>How to Launch CAAMmrCatalogInstantiation</h4>
<p>To launch CAAMmrCatalogInstantiation , you will need to</p>
<ul>
  <li>Set up the build time environment</li>
  <li>Compile the following modules of the CAAMechanicalModeler.edu framework
    with their prerequisites</li>
  <ul>
    <li>CAAMechanicalModelerEduUUID.m</li>
    <li>CAAMmrCatalogCombCrv.m</li>
    <li>CAAMmrCatalogProductAddin.m</li>
    <li>CAAMmrCatalogUI.m</li>
    <li>CAAMmrCombinedCurve.m</li>
  </ul>
  <ul>
    <li>CAAMmrCombinedCurveUI.m</li>
    <li>CAAMmrCreateCombCrvCatalog.m</li>
  </ul>
  <li>Set up the run time environment</li>
  <li>Edit the CAAMechanicalModeler.edu.dico and decomment these two lines:</li>
  <table class="code">
    <tr>
      <td>
        <pre>CAAMmrCatalogPrdAddin    CATIWorkbenchAddin                 libCAAMmrCatalogProductAddin
CAAMmrCatalogPrdAddin    CATIPrsConfigurationAddin          libCAAMmrCatalogProductAddin</pre>
      </td>
    </tr>
  </table>
  <li>Launch CATIA</li>
  <li>&nbsp;When the the application is ready:&nbsp;
    <ul>
      <li>On the <b>Start</b> menu click <b>Product Structure</b></li>
      <li>Launch the <b><img border="0" src="images/CAAMmr_I_CatalogBrowerDemo1.jpg" width="22" height="22">Catalog
        Browser Demonstrator</b> ... command</li>
      <li>In the <b>Catalog Browser Demonstrator</b> dialog box
        <ul>
          <li>click <b>Authorize Catalog Selection</b>&nbsp; in the <b>Catalog
            Browser Properties</b> frame</li>
          <li>Push <b>Open</b></li>
          <li>Select <img border="0" src="images/CAACciCatalogFileOpen.jpg" width="16" height="16"></li>
          <li>Select the <b>CAACombinedCurve</b> (*) catalog and Click <b>Open</b></li>
          <li>Double click on <b>Family </b>and click<b> CAACombinedCrv</b></li>
          <li>In the <b>Description </b>field, <b>CombineCrv </b>is
            displayed&nbsp;</li>
          <li>Push <b>Launch</b> button</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
<p>(*) The file is located in the directory <code>CAAMechanicalModeler.edu/InputData</code></p>
<ul>
  <li>Unix : <code>InstallRootDirectory/CAAMechanicalModeler.edu/InputData</code>
  <li>Windows : <code>InstallRootDirectory\CAAMechanicalModeler.edu\InputData</code></li>
</ul>
<p>where <code>InstallRootDirectory</code> is the directory where the CAA CD-ROM
is installed.</p>
<p align="right">[<a href="#Top">Top</a>]</p>

<!---------------------------------comment------------------------------------->

<h4><a name="Where"></a>Where to Find the CAAMmrCatalogInstantiation Code</h4>
<p>The CAAMmrCatalogInstantiation use case is an extract of the <i>CAAMmrBrowserCmdPanel</i>
class located in the CAAMmrCatalogUI.m module of the CAAMechanicalModeler.edu
framework:</p>
<table>
  <tr>
    <td><code>Windows</code></td>
    <td><code>InstallRootDirectory\CAAMechanicalModeler</code><code>.edu\CAAMmrCatalogUI.m\</code></td>
  </tr>
  <tr>
    <td>Unix</td>
    <td><code>InstallRootDirectory/CAAMechanicalModeler.edu/CAAMmrCatalogUI.m/</code></td>
  </tr>
</table>
<p>where <code>InstallRootDirectory</code> is the directory where the CAA CD-ROM
is installed.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h3><a name="Step"></a>Step-by-Step</h3>
<p><code>LaunchInstantiation </code>is a callback method on the <i>CAAMmrBrowserCmdPanel</i>
class [<a href="#References">1</a>]. This class contains <code>_pICatalogBrowser
</code>as data member. It is a <i>CATICatalogBrowser</i> interface pointer on
the current opened Catalog browser.&nbsp;</p>
<table class="code">
  <tr>
    <td>
      <pre>void CAAMmrBrowserCmdPanel::LaunchInstantiation(CATCommand* iFrom, CATNotification* iNotif, CATCommandClientData iData)
{
    if ( NULL != _pICatalogBrowser )
    {
       CATICatalogDescription * piCatalogDesc = NULL ;
       HRESULT rc = _pICatalogBrowser-&gt;<b>GetSelectedDescription</b> (piCatalogDesc);
       if (SUCCEEDED(rc))
       {
             int RepeatMode = 0 ;      
             int InstantiateMode = 1 ;   
                    
             rc = piCatalogDesc-&gt;<b>RunInstantiationCmd</b>(
                                              _pICatalogBrowser,
                                              InstantiateMode,
                                              RepeatMode);
                                              
             ...
}</pre>
    </td>
  </tr>
</table>
<p>On this <i>CATICatalogBrowser</i> interface pointer the selected description
is retrieved thanks to &nbsp;the <code>GetSelectedDescription</code> method. <code>piCatalogDesc</code>
is a <i>CATICatalogDescription</i> interface pointer on the selected description
in the Catalog browser.</p>
<p>Once we have this <i>CATICatalogDescription</i>&nbsp; interface pointer, call
the <code>RunInstantiationCmd</code> method to launch the instantiation.</p>
<p>In this use case, the arguments of this global function are the following:</p>
<ul>
  <li><b>piCatalogDesc</b>, the description which contains the object to
    instantiate.</li>
  <li><b>_pICatalogBrowser</b>, the Catalog browser itself,</li>
  <li><b>InstantiateMode</b> = 1 , it means that is an instantiation with link
    (recommended) (otherwise it is 0, for a creation)</li>
  <li><b>RepeatMode</b> = 0, it means that the interactive command will be not
    re-launched at the end (recommended). (otherwise it is 1)</li>
</ul>
<p>About the InstantiateMode value: In most case the instantiation mode is 0.
For a Part it is possible to choose between:</p>
<ul>
  <li>InstantiateMode =0 : The Part in the destination document is created by
    new From&nbsp;</li>
  <li>InstantiateMode =1 : The Part in the destination document is linked
    towards the Part component&nbsp;</li>
</ul>
<p><b>Advice</b>: If you are in an interactive session, but that you retrieve a
description outside a Catalog Browser selection, in the&nbsp; <code>CATCci</code><code>RunInstantiation</code>
global function set<code> NULL</code> for the&nbsp; <i>CATICatalogBrowser</i>
interface pointer.</p>
<p>The pseudo-code for the <code>RunInstantiationCmd</code> method is the
following:</p>
<table class="code">
  <tr>
    <td>
      <pre>NotDone = 1;
HESULT rc = <b>Current Workbench </b>-&gt; QI (CATICatalogInstantiation,pICatalogInstantiationOnCurrentWbench)

if ( OK)
{
   pICatalogInstantiationOnCurrentWbench-&gt;<b>RunInstantiationCmd</b>(...,NotDone)
}
if (NotDone)
{
   HESULT rc = <b>Current Workshop</b> -&gt; QI (CATICatalogInstantiation,pICatalogInstantiationOnCurrentWshop)

   if ( OK)
      pICatalogInstantiationOnCurrentWshop-&gt;<b>RunInstantiationCmd</b>(...,NotDone)
}
if (NotDone)
{
   HESULT rc = <b>DescriptionComponent</b> -&gt; QI (CATICatalogInstantiation,pICatalogInstantiationOnComponent)

   if ( OK)
      pICatalogInstantiationOnComponent-&gt;<b>RunInstantiationCmd</b>(...,NotDone)
}      </pre>
    </td>
  </tr>
</table>
<p>Before to call the <code>RunInstantiationCmd</code> method of the <i>CATICatalogInstantiation</i>
on the component contained in the description, the <code>CATICatalogDescription</code>::<code>RunInstantiationCmd</code>
method calls this method on the current workbench and the current workshop if
they implement this interface.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="InShort"></a>In Short</h3>
<p>This use case illustrates how to instantiate a component catalog in using the
<code>RunInstantiationCmd</code> method of the <i>CATICatalogDescription</i>
interface.
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<!---------------------------------comment------------------------------------->

<h3><a name="References"></a>References</h3>
<table width="896">
  <tr>
    <td valign="top" width="62">[1]</td>
    <td width="820"><a href="CAAMmrCatalogCombCrvIntegration.htm">Integrating a
      New Type of Component</a></td>
  </tr>
  <tr>
    <td valign="top" width="62">[2]</td>
    <td width="820"><a href="../CAACciTechArticles/CAACciCatalogOverview.htm">Catalog
      Overview</a></td>
  </tr>
  <tr>
    <td valign="top" width="62">[3]</td>
    <td width="820"><a href="CAAMmrCatalogUsing.htm">Using the Catalog Browser</a></td>
  </tr>
  <tr>
    <td valign="top" align="right" colspan="2" width="888">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="History"></a>History</h3>
<table width="100%">
  <tr>
    <td valign="top">Version: <strong>1</strong> [Jul 2002]</td>
    <td valign="top">Document created</td>
  </tr>
  <tr>
    <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<p><i>Copyright © 2002, Dassault Systèmes. All rights reserved.</i></p>

</body>

</html>
