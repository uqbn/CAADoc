<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<link rel="Stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css">
<title>Creating Combined Curve's Catalog</title>
</head>

<body>

<table width="100%">
  <tr>
    <td valign="top">
      <h1>Mechanical Modeler</h1>
    </td>
    <td valign="top">
      <h2></h2>
    </td>
    <td rowspan="2" align="right" valign="top">
      <h3><a name="Top"></a>Creating Combined Curve's Catalog</h3>
      <em>Defining a New StartUp in a catalog&nbsp;</em></td>
  </tr>
  <tr>
    <td class="use" colspan="2">Use Case</td>
  </tr>
  <tr>
    <td colspan="3"><a href="CAAMmrCombinedCurveSamplesOverview.htm">Creating a
      New Geometrical Feature: The Combined Curve</a> &gt; <b>Creating Combined
      Curve's Catalog</b></td>
    <td valign="top"></td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->

<table class="abstract">
  <tr>
    <td>
      <h3>Abstract</h3>
      <p> This
      use case explains how to generate a Catalog file including the Combined
      Curve Feature's Initial Definition: its StartUp.
      <ul>
        <li><strong><a href="#Learn">What You Will Learn With This Use Case</a></strong></li>
        <li><strong><a href="#UseCase">The CAAMmrCreateCombCrvCatalog Use Case</a></strong>
          <ul>
            <li><a href="#What">What Does CAAMmrCreateCombCrvCatalog Do</a></li>
            <li><a href="#How">How to Launch CAAMmrCreateCombCrvCatalog</a></li>
            <li><a href="#Where">Where to Find the CAAMmrCreateCombCrvCatalog
              Code</a></li>
          </ul>
        </li>
        <li><strong><a href="#Step">Step-by-Step</a></strong></li>
        <li><strong><a href="#InShort">In Short</a></strong></li>
        <li><strong><a href="#References">References</a></strong></li>
      </ul>
    </td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="Learn"></a>What You Will Learn With This Use Case</h3>
<p>This use case is intended to help you generate the <b>Catalog file</b>
containing the <b>Combined Curve</b><b> Feature StartUp</b>.
<p>More specifically, the CAAMmrCreateCombCrvCatalog use case shows how to:
<ul>
  <li>Create a new Catalog file</li>
  <li>Use the Generic Factory to create a StartUp deriving from an existing
    StartUp defining 3D geometrical elements</li>
  <li>Add your own Attributes to this StartUp</li>
  <li>Save the Catalog file.</li>
</ul>
<!---------------------------------comment------------------------------------->

<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h3><a name="UseCase"></a>The CAAMmrCreateCombCrvCatalog Use Case</h3>
<p>CAAMmrCreateCombCrvCatalog is a use case of the CAAMechanicalModeler.edu
framework that illustrates MechanicalModeler framework capabilities.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="What"></a>What Does CAAMmrCreateCombCrvCatalog Do</h4>
<p>The goal of this use case is to generate the Catalog file containing the
Combined Curve Feature's StartUp. As described in the technical article entitled
&quot;Creating a New StartUp from a Mechanical Feature&quot; [<a href="#References">1</a>], the first
thing is
to define the new StartUp:</p>
<ol>
  <li>Choosing the derived mechanical StartUp</li>
  <p>The Combined Curve is a wireframe geometrical object, so we have chosen to
  derive the CombinedCurve StartUp from the <b>GeometricalElement3D</b>
  mechanical StartUp.&nbsp;Derive from the GSMGeom StartUp can be also
  possible, but it is not possible to derive from MechanicalFormFeature and
  MechanicalContextualFeature since the Combined Curve is not a solid feature.&nbsp;</p>
  <p>The hieararchy of StartUp is the following:</p>
  <table border="0">
    <tr>
      <td><img border="0" src="images/CAAMmrCombinedCurveStartUps.jpg"></td>
    </tr>
  </table>
  <p>In so doing, you will automatically benefit from all standard behaviors
  already implemented for all geometrical features and more generally for all
  mechanical features. Refer to the article entitled &quot;Integrating a New
  Mechanical Feature in V5&quot; [<a href="#References">2</a>] for details about
  the standard behavior of a feature deriving from the GeometricalElement3D
  StartUp and the interfaces to implement to be fully integrated in V5.&nbsp;</p>
  <li>Defining the attributes of the new feature</li>
</ol>
<blockquote>
<p>Now that you have met the parents of the Combined Curve Feature, you still
have to define its own Attributes. Those Attributes will be added to those
inherited from its ancestors.</p>
<p>Since a Combined Curve is build using two curves and two directions, it is
straightforward to define <b>four new input Attributes</b>: &quot;Curve1&quot;,
&quot;Direction1&quot;, &quot;Curve2&quot; and &quot;Direction2&quot;.</p>
<p>These Attributes will be point to four other Features. This means they are of
type &quot;tk_specobject&quot;. From an update point of view, the input
Attributes have to be evaluated before building the Combined Curve. That's why
they are IN Attributes ( &quot;sp_IN&quot; type ) [<a href="#References">3</a>]</p>
</blockquote>
<p>Once the Combined Curve Feature's Inheritance and Attributes have been
defined, you are ready to generate the <b>Combined Curve Catalog file</b> that
will contain the Combine Feature's initial definition: The Combined Curve
Feature &quot;<b>StartUp</b>&quot;.</p>
<p>Catalogs are particular files in which StartUp are created, enhanced with new
Attributes and stored. These StartUps are then instantiated into run time
instances.</p>
<p>Here is a figure representing what the Combined Curve Catalog File will
&quot;look like&quot;:</p>
<table>
<caption><i><a name="Fig.1">Fig.1</a>: Extract of the CAAMmrCombinedCurveCatalog.CATfct file</i></caption>
  <tr>
    <td><img border="0" src="images/CAAMmrCombinedCurveStartUp.jpg" width="226" height="136"></td>
    <td>You can see the Combined Curve Feature StartUp - named
      &quot;CombinedCurve&quot; - and its four input Attributes, all
      included in the <i>CAAMmrCombinedCurveCatalog </i>catalog file. This file
      is located in the CNEXT/resources/graphic directory of the
      CAAMechanicalModeler.edu framework.</td>
  </tr>
</table>
<p>This <i>CAAMmrCombinedCurveCatalog </i>file will be created by a batch, the CAAMmrCreateCombCrvCatalog
batch. Refer to the &quot;<a href="#How">How to launch theCAAMmrCreateCombCrvCatalog
Code</a>&quot; section for details.&nbsp;</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="How"></a>How to Launch CAAMmrCreateCombCrvCatalog</h4>
<p>See the section entitled &quot;How to Launch the Combined Curve Use Case&quot; in the &quot;<a href="CAAMmrCombinedCurveSamplesOverview.htm">Creating
a New Geometrical Feature: The Combined Curve</a>&quot; use case for a detailed
description of how this use case should be launched.</p>
<p>The particular part of the use case described in this article is launched by
executing the following command:</p>
<pre>    mkrun -c &quot;CAAMmrCreateCombCrvCatalog CatalogPath&quot;</pre>
where <code>CatalogPath</code> is the directory of the catalog to be created. It
is recommended that the new catalog be stored in the CNext + resources + graphic
directory of the current framework; then, by updating the runtime view, the
catalog will be moved to the runtime directory and will be accessible by
subsequent programs.&nbsp;
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="Where"></a>Where to Find the CAAMmrCreateCombCrvCatalog Code</h4>
<p>The CAAMmrCreateCombCrvCatalog use case is made of one module,
CAAMmrCreateCombCrvCatalog.m,&nbsp; found in the the CAAMechanicalModeler.edu
framework and containing a single source program, CAAMmrCreateCombCrvCatalog.cpp:</p>
<table>
  <tr>
    <td>Windows</td>
    <td><code>InstallRootDirectory\CAAMechanicalModeler.edu\CAAMmrCreateCombCrvCatalog.m\</code></td>
  </tr>
  <tr>
    <td>Unix</td>
    <td><code>InstallRootDirectory/CAAMechanicalModeler.edu/CAAMmrCreateCombCrvCatalog.m/</code></td>
  </tr>
</table>
<p>where <code>InstallRootDirectory</code> is the directory where the CAA CD-ROM
is installed.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h3><a name="Step"></a>Step-by-Step</h3>
<p>There are six logical sections in the CAAMmrCreateCombCrvCatalog main code:</p>
<ol>
  <li><a href="#Step1">Creating a Path to the Combined Curve Catalog</a></li>
  <li><a href="#Step2">Creating the Combined Curve Catalog</a></li>
  <li><a href="#Step3">Adding a Client Identification to the Combined Curve
    Catalog</a></li>
  <li><a href="#Step5">Creating the Combined Curve StartUp</a></li>
  <li><a href="#Step6">Adding Attributes to this Startup</a></li>
  <li><a href="#Step7">Saving the Combined Curve Catalog</a></li>
</ol>
<p>We will now comment each of those sections by looking at the code.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="Step1"></a>Creating a Path to the Combined Curve Catalog</h4>
<p>Create a path to the catalog using <code>CATMakePath</code> of CATLib.h. To
work properly, this path should point to a resources/graphic directory.</p>
<table class="code">
  <tr>
    <td>
      <pre>...
const char *pDirName = argv[1];
const char *pFileName = <b>&quot;CAAMmrCombinedCurveCatalog&quot;</b>;
char StorageName[200];

<b>CATMakePath</b>( pDirName , pFileName , StorageName );</pre>
    </td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="Step2"></a>Creating the Combined Curve Catalog</h4>
<table class="code">
  <tr>
    <td>
      <pre>CATUnicodeString CombinedCurveCatalogStorageName = StorageName;
CATICatalog *piCombinedCurveCatalog = NULL;

rc = ::<b>CreateCatalog</b>( &amp;CombinedCurveCatalogStorageName ,
                          &amp;piCombinedCurveCatalog );</pre>
    </td>
  </tr>
</table>
<p align="left">Use the <code>CreateCatalog</code> global function to create a
new feature catalog. The arguments of this function are:</p>
<ul>
  <li>
    <p align="left"><b>CombinedCurveCatalogStorageName</b> - this is the entire
    pathname and name of the catalog. This parameter is the same as the one
    passed to the method that saves the catalog.</p>
  <li>
    <p align="left"><b>piCombinedCurveCatalog</b> - this is the returned <i>CATICatalog</i>
    pointer to the new catalog that has been created.</p>
  </li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="Step3"></a>Adding a Client Identification to the Combined Curve
Catalog</h4>
<p>A catalog file can not be used if it has no client identification.</p>
<table class="code">
  <tr>
    <td>
      <pre>CATUnicodeString ClientId = <b>&quot;SAMPLES&quot;</b>;

rc = piCombinedCurveCatalog-&gt;<b>SetClientId</b>( &amp;ClientId );</pre>
    </td>
  </tr>
</table>
<p>In order to protect your catalog from unwanted access, you must also assign a
client ID to it. This ID is needed in order to open the catalog to retrieve
StartUps from it. The client ID is set using the <code>SetClientId</code> method
of <i>CATICatalog</i> and passing a <i>CATUnicodeString</i> parameter
representing the client ID.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<h4><a name="Step5"></a>Creating the Combined Curve StartUp</h4>
<table class="code">
  <tr>
    <td>
      <pre>
    ...
    CATUnicodeString CombinedCurveStartUpType = &quot;<b>CombinedCurve</b>&quot;;   
    CATUnicodeString CatalogName = &quot;<b>MechMod</b>&quot; ;
    CATUnicodeString SuperTypeName = &quot;<b>GeometricalElement3D</b>&quot;;
    CATBoolean       publicSU = FALSE ;
    CATBoolean       derivableSU = FALSE ;
    CATISpecObject *piSpecOnCombinedCurveStartUp = NULL;

    rc = ::CATOsmSUFactory(&amp;piSpecOnCombinedCurveStartUp,
                           &amp;CombinedCurveStartUpType,
                           piCombinedCurveCatalog,
                           &amp;SuperTypeName,
                           &amp;CatalogName,
                           publicSU,
                           derivableSU) ;
     ...</pre>
    </td>
  </tr>
</table>
<p align="left">A new StartUp is created using the <i>CATOsmSUFactory</i> global function(
ObjectSpecsModeler framework). This function takes as input:</p>
<ul>
  <li><code><b>CombinedCurveStartUpType</b></code> - the late type of the new StartUp
    to be created</li>
  <li><code><b>piCombinedCurveCatalog</b></code> - the <i>CATICatalog</i> pointer to
    the catalog in which the new StartUp will be stored.</li>
  <li><code><b>SuperTypeName</b></code>- the type of the derived feature
    (GeometricalElement3D)</li>
  <li><code><b>CatalogName</b></code>- the name of the catalog which contains the derived feature
    (MechMod)</li>
  <li><code><b>publicSU</b></code>- precise if the new startup is public or not.
    If the StartUp is public a CATSpecs file is also provided.</li>
  <li><code><b>derivableSU</b></code>- precise if the new startup is derivable or not
    (information not pertinent if the new StartUp is private)</li>
</ul>
<p>It returns <code>piSpecOnCombinedCurveStartUp</code>, a <i>CATISpecObject</i>
pointer to the new StartUp.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="Step6"></a>Adding Attributes to this StartUp</h4>
<p>It is now time to add attributes to the StartUp. An attribute is defined by
its name, its type and update mode.</p>
<table class="code">
  <tr>
    <td>
      <pre><b>...</b>
<b>CATISpecObject</b> *piSpecOnCombinedCurveStartUp = NULL;
rc = pCombinedCurveStartUp-&gt;QueryInterface(IID_CATISpecObject,
                         (void**) &amp;piSpecOnCombinedCurveStartUp);

...
CATUnicodeString Curve1Name = <b>&quot;Curve1&quot;</b>;
CATISpecAttribute *piCurve1SpecAttribute =  NULL ;
piSpecOnCombinedCurveStartUp-&gt;<b>AddAttribute</b>( Curve1Name,
                                            tk_specobject,
                                            sp_IN);
...</pre>
    </td>
  </tr>
</table>
<p align="left">A new attribute of a StartUp is created using the <code>AddAttribute</code>
method of <i>CATISpecObject</i>. This method takes the following arguments:</p>
<ul>
  <li>
    <p align="left"><b>Curve1Name</b>- this argument is a <i>CATUnicodeString</i>
    variable representing the name of the new attribute.</p>
  <li>
    <p align="left"><b>tk_specobject </b>- this is the type of attribute
    to be added. In this case, the attribute is a referenced feature. [<a href="#References">3</a>]</p>
  <li>
    <p align="left"><b>sp_IN</b> - this is the &quot;quality&quot; of the
    attribute: it is used during the Update process to determine whether this
    feature is to be re-built or not.</p>
  </li>
</ul>
<p align="left">The attributes of the other StartUps are added the same way.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="Step7"></a>Saving the Combined Curve Catalog</h4>
<table class="code">
  <tr>
    <td>
      <pre>rc = ::<b>SaveCatalog</b>(&amp;piCombinedCurveCatalog,
                   &amp;CombinedCurveCatalogStorageName);
...</pre>
    </td>
  </tr>
</table>
<p>The Combined Curve Feature's Catalog is now filled in with a Combined Curve
Feature's StartUp with its four attributes. This is enough to define the
Combined Curve Feature. You can save the Catalog file using the <code>SaveCatalog</code>
global function.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="InShort"></a>In Short</h3>
<p>This use case has demonstrated how to create and define the Combined Curve
Feature's StartUp in a Catalog. This StartUp will later be used to <b>instantiate</b>
Combined Curve Instances through a factory interface [<a href="#References">4</a>].</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="References"></a>References</h3>
<table width="100%" height="87">
  <tr>
    <td valign="top" height="18">[1]</td>
    <td height="18"><a href="../CAAMmrTechArticles/CAAMmrCreatingNewFeat.htm">Creating
      a New StartUp Deriving from a Mechanical StartUp&nbsp;</a></td>
  </tr>
  <tr>
    <td valign="top" height="17">[2]</td>
    <td height="17"><a href="../CAAMmrTechArticles/CAAMmrFeatureIntegration.htm">Integrating a New
  Mechanical Feature in V5</a></td>
  </tr>
  <tr>
    <td valign="top" height="18">[3]</td>
    <td height="18"><a href="../CAAOsmQuickRefs/CAAOsmHome.htm">Feature
      Modeler Overview</a></td>
  </tr>
  <tr>
    <td valign="top" height="18">[4]</td>
    <td height="18"><a href="CAAMmrCombinedCurveFactory.htm">Creating Combined
      Curve's Factory Interface</a></td>
  </tr>
  <tr>
    <td valign="top" align="right" colspan="2" height="18">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="History"></a>History</h3>
<table width="100%">
  <tr>
    <td valign="top">Version: <strong>1</strong> [Mar 2000]</td>
    <td valign="top">Document created</td>
  </tr>
  <tr>
    <td valign="top">Version: <strong>2</strong> [Jan 2003]</td>
    <td valign="top">Document updated</td>
  </tr>
  <tr>
    <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<p><i>Copyright © 2000, Dassault Systèmes. All rights reserved.</i></p>

</body>

