<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>CAAAniPostProAcDesact.catvbs</title>
<link rel="stylesheet" type="text/css" href="../CAAScrBase/caav5.css">
</head>

<body>

<pre>
<font color="#008000">&#39; COPYRIGHT DASSAULT SYSTEMES 2000</font>

<font color="#008000">&#39; ***********************************************************************</font>
<font color="#008000">&#39;   Purpose:      To demonstrate activation and deactivation of image</font>
<font color="#008000">&#39;   Assumptions:   displacement symbol image exists in the document</font>
<font color="#008000">&#39;   Author:       bmw</font>
<font color="#008000">&#39;   Languages:    VBScript</font>
<font color="#008000">&#39;   Locales:      English </font>
<font color="#008000">&#39;   CATIA Level:  V5R16</font>
<font color="#008000">&#39; ***********************************************************************</font>

<font color="#0000FF">Sub </font>CATMain()
<font color="#008000">&#39; ----------------------------------------------------------- </font>
<font color="#008000">&#39; Optional: allows to find the sample wherever it&#39;s installed</font>
  sDocPath=CATIA.SystemService.Environ(&quot;CATDocView&quot;)

<font color="#0000FF">    If </font>(Not CATIA.FileSystem.FolderExists(sDocPath))<font color="#0000FF"> Then</font>
      Err.Raise 9999,,&quot;No Doc Path Defined&quot;
<font color="#0000FF">    End If</font>
<font color="#008000">&#39; ----------------------------------------------------------- </font>


<font color="#008000">&#39; Open the CATAnalysis Document</font>
sFilePath = CATIA.FileSystem.ConcatenatePaths(sDocPath, &quot;online\CAAScdAniUseCases\samples\Cube_R13_Freq.CATAnalysis&quot;)
<FONT COLOR="#0000FF">Set</FONT> oAnalysisDocument = CATIA.Documents.Open(sFilePath)


<font color="#008000">&#39; Retrieve the Analysis Manager</font>
<font color="#0000FF">Set </font>oAnalysisManager = oAnalysisDocument.Analysis

<font color="#008000">&#39; Retrieve the analysis model from the list of models</font>
<font color="#0000FF">Set </font>oAnalysisModels = oAnalysisManager.AnalysisModels
<font color="#0000FF">Set </font>oAnalysisModel = oAnalysisModels.Item(1)

<font color="#008000">&#39; Retrieve the analysis cases and the first analysis case</font>
<font color="#0000FF">Set </font>oAnalysisCases = oAnalysisModel.AnalysisCases
<font color="#0000FF">Set </font>oAnalysisCase = oAnalysisCases.Item(1)

<font color="#008000">&#39; Retrieve the analysis cases and the first analysis case</font>
<font color="#0000FF">Set </font>oAnalysisSets = oAnalysisCase.AnalysisSets
<font color="#0000FF">Set </font>oAnalysisSet = oAnalysisSets.Item(&quot;Frequency Case Solution.1&quot;, catAnalysisSetSearchAll)
<font color="#0000FF">Set </font>analysisImages1 = oAnalysisSet.AnalysisImages

<font color="#008000">&#39;activation of an  image</font>
<font color="#008000">&#39;==============</font>
<font color="#008000">&#39;we search image Disp_Symbol</font>
<font color="#0000FF">Set </font>oAnalysisImage = analysisImages1.Item(&quot;Disp_Symbol&quot;)

<font color="#008000">&#39;we Activate the image</font>
oAnalysisImage.SetActivationStatus true

<font color="#008000">&#39;we update the  image</font>
oAnalysisImage.Update

<font color="#008000">&#39;deactivation of an  image</font>
<font color="#008000">&#39;===============</font>
<font color="#008000">&#39;we deactivate the image</font>
oAnalysisImage.SetActivationStatus false

<font color="#008000">&#39;we update the  image</font>
oAnalysisImage.Update

<font color="#0000FF">End Sub</font>
</pre>

</body>

</html>
