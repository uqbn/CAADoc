<html>

 <head>
 <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
 <meta name="GENERATOR" content="Microsoft FrontPage 6.0">
 <meta name="ProgId" content="FrontPage.Editor.Document">
 <link rel="Stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css">
 <title>How to Read an Attribute</title>
 </head>

 <body>

 <table width="100%">
   <tr>
     <td valign="top">
     <h1>Geometric Modeler</h1>
     </td>
     <td valign="top">
     <h2>Geometry</h2>
     </td>
     <td rowspan="2" align="right" valign="top">
     <h3><a name="Top"></a>How to Read an Attribute</h3>
     <p><i>Reading a streamed attribute</i></td>
   </tr>
   <tr>
     <td class="use" colspan="2">Use Case</td>
   </tr>
 </table>
 <hr>
 <!---------------------------------comment------------------------------------->
 <table class="abstract">
   <tr>
     <td>
     <h3>Abstract</h3>
     <p>This use case explains how to read a CATCGMStreamAttribute. It is 
     associated with the <a href="CAAGobAttCreation.htm">How to Create an 
     Attribute</a> article. Run this use case after you have run the 
     CAAGobAttributeCreation use case. The file generated by the 
     CAAGobAttributeCreation use case is to be used as input file for the 
     CAAGobAttributeRead use case.</p>
     <ul>
       <li><a href="#Learn"><strong>What You Will Learn With This Use Case</strong></a></li>
       <li><a href="#UseCase"><strong>The CAAGobAttributeRead Use Case</strong></a>
       <ul>
         <li><a href="#What">What Does CAAGobAttributeRead Do</a></li>
         <li><a href="#How">How to Launch CAAGobAttributeRead</a></li>
         <li><a href="#Where">Where to Find the CAAGobAttributeRead Code</a></li>
       </ul>
       </li>
       <li><a href="#Step"><strong>Step-by-Step</strong></a></li>
       <li><strong><a href="#InShort">In Short</a></strong></li>
       <li><strong><a href="#References">References</a></strong></li>
     </ul>
     </td>
   </tr>
 </table>
 <hr>
 <!---------------------------------comment------------------------------------->
 <h3><a name="Learn"></a>What You Will Learn With This Use Case</h3>
 <p>The use case explains how to read a CATCGMStreamAttribute. The attribute 
 implementation is defined in the CAAGobAttribute.m module. The way it has to be 
 created is explained in <a href="CAAGobAttRead.htm">How to Create an Attribute</a>.</p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h3><a name="UseCase"></a>The CAAGobAttributeRead Use Case</h3>
 <p>CAAGobAttributeRead is a use case of the CAAGeometricObjects.edu framework 
 that illustrates GeometricObjects framework capabilities.</p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="What"></a>What Does CAAGobAttributeRead Do</h4>
 <p>This use case loads a file and scans the geometry to search for the 
 attributes of a given type (CAAGobAttributeManagement) on a geometry of a given 
 type (PLineType). </p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="How"></a>How to Launch CAAGobAttributeRead</h4>
 <p>To launch CAAGobAttributeRead, you will need to set up the build time 
 environment, then compile CAAGobAttributeRead.m and CAAGobAttribute.m along 
 with their prerequisites, set up the run time environment, and then execute the 
 use case [<a href="#References">1</a>].</p>
 <p>You must type CAAGobAttributeRead with an argument to execute the use case.</p>
 <p>With Windows <code>CAAGobCreation e:\AttToBeRead.NCGM</code></p>
 <p>With UNIX <code>CAAGobCreation /u/AttToBeRead.NCGM</code></p>
 <p>AttToBeRead.NCGM is the file generated by CAAGobAttributeCreation.m</p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="Where"></a>Where to Find the CAAGobAttributeRead Code</h4>
 <p>The CAAGobAttributeRead use case is made of a main named 
 CAAGobAttributeRead.cpp located in the CAAGobAttributeRead.m module of the 
 CAAGeometricObjects.edu framework:</p>
 <table>
   <tr>
     <td>Windows</td>
     <td><code>
     InstallRootDirectory\CAAGeometricObjects.edu\CAAGobAttributeRead.m\</code></td>
   </tr>
   <tr>
     <td>Unix</td>
     <td><code>
     InstallRootDirectory/CAAGeometricObjects.edu/CAAGobAttributeRead.m/</code></td>
   </tr>
 </table>
 <p>where <code>InstallRootDirectory</code> is the directory where the CAA 
 CD-ROM is installed.</p>
 <p>The use case uses a class defined in the CAAGobAttribute.m module.</p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h3><a name="Step"></a>Step-by-Step</h3>
 <p>The main program peforms the following steps: </p>
 <ul>
   <li><a href="#Creates the Geometry Factory">Loading the File to Be Read</a></li>
   <li><a href="#Creates a CATPLine">Looping though the Geometry</a></li>
   <li><a href="#Writes the Model and Closes the Factory">Closing the Input File 
     and the CGM Container</a></li>
 </ul>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="Creates the Geometry Factory"></a>Loading the File to Be Read</h4>
 <p>The geometry factory (CATGeoFactory) creates and manages all the 
 CATICGMObject (and the curves and surfaces in particular). In this use case, 
 the factory is defined by reading a NCGM file that was previously stored,&nbsp; 
 the global function <code>::CATLoadCGMContainer</code> must be used to retrieve 
 the factory.</p>
 <table class="code">
   <tr>
     <td>
     <pre>CATGeoFactory* piGeomFactory = CATLoadCGMContainer(filetoread);</pre>
     </td>
   </tr>
 </table>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="Creates a CATPLine"></a>Looping through the Geometry</h4>
 <p>Here are the step to follow in order to read specific attributes in a 
 geometry.</p>
 <ol>
   <li>scan the geometry by using the CATICGMContainer::Next method.</li>
   <li>for each objects sanned by the loop, retrieve the persistent tag by using 
     the CATGeometry::GetPersistentTag method.</li>
   <li>for each geometry, retrieve the CATICGMObject by using the 
     CATGeometry::FindObjectFromTag method</li>
   <li>for each CATICGMObject , retrieve the appropriate attribute by using the 
     CATICGMObject ::GetAttribute method.</li>
   <li>use the GetValue method applied to the retrieved attribute to read the 
     attribute value.</li>
 </ol>
 <table class="code">
   <tr>
     <td>
     <pre><font color="#008000">// (b) --- Loop through the geometry</font>
//
...
for (piCurG = piGeomFactory-&gt;Next(NULL,CATPLineType);
piCurG != NULL;
piCurG = piGeomFactory-&gt;Next(piCurG)) 
  {
    <font color="#008000">// Find the PLine from its persistent tag
    //</font>
    curtag = piCurG-&gt;GetPersistentTag();
    CATICGMObject * piCGMObj = piGeomFactory-&gt;FindObjectFromTag(curtag);
    if (piCGMObj == NULL)
	{
	  cout &lt;&lt; &quot;No object with the specified tag&quot; &lt;&lt;endl;
			return 1;
	}

    <font color="#008000">// Retrieve the CATCGMAttribute from its identifier
    //</font>
    CATCGMAttribute * piActAttr = piCGMObj-&gt;
    GetAttribute(UAIDPtr(CAAGobAttributeManagement));

    <font color="#008000">// No searched attribute found on the PLine 
    //</font>
   if (NULL == piActAttr)
	{
            cout &lt;&lt; &quot;------------------------------------------------- &quot; &lt;&lt; endl;
	   cout &lt;&lt; &quot;PLine with no CAAGobAttributeManagement attribute &quot; &lt;&lt; endl;
	}

    <font color="#008000">// The searched attribute found on the Pline
    //</font>
    else
	{
	   cout &lt;&lt; &quot;------------------------------------------------- &quot; &lt;&lt; endl;
	   cout &lt;&lt; &quot;PLine with CAAGobAttributeManagement attribute    &quot; &lt;&lt; endl; 
		
            CAAGobAttributeManagement * iPersAttr = NULL;
	   iPersAttr = (CAAGobAttributeManagement *) piActAttr;

            <font color="#008000">// Retrieve the attribute value 
            // See the CAAAttributeManagement module
	   // </font>
		if (iPersAttr)
		{
			long oPersval;
	          	iPersAttr-&gt;GetValue(oPersval);
		}
			else return 1;
           		cout &lt;&lt; &quot;----------------------------------- &quot; &lt;&lt; endl;		
		}
	}
	}</pre>
     </td>
   </tr>
 </table>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <!---------------------------------comment------------------------------------->
 <h4><a name="Writes the Model and Closes the Factory"></a>Closing the Input 
 File and the CGM Container</h4>
 <p>The use case ends with the closure of the file and the CGM container (done 
 by the <code>::CATCloseCGMContainer</code> global function).</p>
 <table class="code">
   <tr>
     <td>
     <pre>filetoread.close();
CATCloseCGMContainer(piGeomFactory);</pre>
     </td>
   </tr>
 </table>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <hr>
 <!---------------------------------comment------------------------------------->
 <h3><a name="InShort"></a>In Short</h3>
 <p>The use case illustrates how to read attributes.</p>
 <p align="right">[<a href="#Top">Top</a>]</p>
 <hr>
 <!---------------------------------comment------------------------------------->
 <h3><a name="References"></a>References</h3>
 <table width="100%">
   <tr>
     <td>[1]</td>
     <td>
     <a href="../CAADocUseCases/CAADocRunSample.htm">
     Building and Launching a CAA V5 Use Case</a></td>
   </tr>
   <tr>
     <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
   </tr>
 </table>
 <hr>
 <!---------------------------------comment------------------------------------->
 <h3><a name="History"></a>History</h3>
 <table width="100%">
   <tr>
     <td valign="top">Version: <strong>1</strong> [Apr 2000]</td>
     <td valign="top">Document created</td>
   </tr>
   <tr>
     <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
   </tr>
 </table>
 <hr>
 <!---------------------------------comment------------------------------------->
 <p><i>Copyright © 2000, Dassault Systèmes. All rights reserved.</i></p>

 </body>

</html>
