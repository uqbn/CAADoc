<html>

  <head>
  <meta http-equiv="Content-Language" content="fr">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="GENERATOR" content="Microsoft FrontPage 6.0">
  <meta name="ProgId" content="FrontPage.Editor.Document">
  <link rel="Stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css">
  <title>Loading a Document</title>
  </head>

  <body>

   <table width="100%">
     <tr>
       <td valign="top">
       <h1>3D PLM Enterprise Architecture</h1>
       </td>
       <td valign="top">
       <h2>Data Access - File</h2>
       </td>
       <td rowspan="2" align="right" valign="top">
       <h3><a name="Top"></a>Loading a Document</h3>
       <p><em>Working with existing documents</em></td>
     </tr>
     <tr>
       <td class="use" colspan="2">Use Case</td>
     </tr>
   </table>
   <hr>
   <!---------------------------------comment------------------------------------->
   <table class="abstract">
     <tr>
       <td>
       <h3>Abstract</h3>
       <p>This article accompanies the CAAOmbLoadDoc use case. This use case 
       explains how to load and save an existing document. </p>
       <ul>
         <li><strong><a href="#Learn">What You Will Learn With This Use Case</a></strong></li>
         <li><a href="#Important_Concepts"><strong>Some Important Concepts about 
         Documents</strong></a></li>
         <li><a href="#UseCase"><strong>The CAAOmbLoadDoc Use Case</strong></a>
         <ul>
           <li><a href="#What">What Does CAAOmbLoadDoc Do</a></li>
           <li><a href="#How">How to Launch CAAOmbLoadDoc</a></li>
           <li><a href="#Where">Where to Find the CAAOmbLoad Code</a></li>
         </ul>
         </li>
         <li><strong><a href="#Step">Step-by-Step</a></strong></li>
         <li><strong><a href="#InShort">In Short</a></strong></li>
         <li><strong><a href="#References">References</a></strong></li>
       </ul>
       </td>
     </tr>
   </table>
   <hr>
   <!---------------------------------comment------------------------------------->
   <h3><a name="Learn"></a>What You Will Learn With This Use Case</h3>
   <p>This use case is intended to help you make your first steps in working 
   with documents. Basically, you will learn how to: </p>
   <ul>
     <li>load an existing document</li>
     <li>save and remove the document from the session</li>
   </ul>
   <p>Before getting to the use case itself, it is important to get an 
   understanding of what documents are. This is the goal of the next section. 
   You can skip it and get directly to the <a href="#UseCase">use case</a> if 
   you are already familiar with these concepts.</p>
   <p align="right">[<a href="#Top">Top</a>]</p>
   <!---------------------------------comment------------------------------------->
   <h3><a name="Important_Concepts"></a>Some Important Concepts about Documents</h3>
   <p>The document concept allows users to gather objects which have something 
   in common, to display them in a document window when in interactive mode, and 
   to save them in a storage unit under a unique storage name for future 
   retrieval.</p>
   <p>Objects that are created and manipulated in similar ways are grouped in 
   the same type of document. In CAA V5 interactive mode, to create and 
   manipulate objects, you are provided with workshops. A document type is 
   associated with one or more workshops. For example, when you create a Part 
   document, you are provided with the Sketcher and PartDesign workshops by 
   which you can create and manipulate objects named &quot;parts&quot;. All these parts 
   are then regrouped within one or more graphic windows (when in interactive 
   mode) which symbolize a Part document.</p>
   <p>CATIA documents are not only the places where related objects reside, they 
   are also persistency units which can be exchanged between users.</p>
   <p><b>Attention</b>, If you load in session a none CATIA Document (STEP,IGES,3DXML,DXF,...) 
   , refer to the dedicated technical article [<a href="#References">1</a>]. You will find 
   additionaly information about the management of the loaded document(s). </p>
   <p align="right">[<a href="#Top">Top</a>]</p>
   <!---------------------------------comment------------------------------------->
   <h3><a name="UseCase"></a>The CAAOmbLoadDoc Use Case</h3>
   <p>CAAOmbLoadDoc is a use case of the CAAObjectModelerBase.edu framework that 
   illustrates ObjectModelerBase framework capabilities.</p>
   <p align="right">[<a href="#Top">Top</a>]</p>
   <!---------------------------------comment------------------------------------->
   <h4><a name="What"></a>What Does CAAOmbLoadDoc Do</h4>
   <p>The goal of CAAOmbLoadDoc is to load an existing document and to save and 
   remove it from the session. </p>
   <p align="right">[<a href="#Top">Top</a>]</p>
   <!---------------------------------comment------------------------------------->
   <h4><a name="How"></a>How to Launch CAAOmbLoadDoc</h4>
   <p>To launch CAAOmbLoadDoc, you will need to set up the build time 
   environment, then compile CAAOmbLoadDoc along with its prerequisites, set up 
   the run time environment, and then execute the sample. This is fully 
   described in the referenced article [<a href="#References">2</a>]. When 
   launching the use case, you must pass the following arguments:</p>
   <ul>
     <li><b>Input.CATPart</b> - entire pathname document to be loaded. The 
     document can be of any type, not necessarily CATPart.</li>
   </ul>
   <p align="right">[<a href="#Top">Top</a>]</p>
   <!---------------------------------comment------------------------------------->
   <h4><a name="Where"></a>Where to Find the CAAOmbLoadDoc Code</h4>
   <p>CAAOmbLoadDoc code is located in the CAAOmbLoadDoc.m use case module of 
   the CAAObjectModelerBase.edu framework:</p>
   <table>
     <tr>
       <td>Windows</td>
       <td><code>InstallRootDirectory\CAAObjectModelerBase.edu\CAAOmbLoadDoc.m</code></td>
     </tr>
     <tr>
       <td>Unix</td>
       <td><code>InstallRootDirectory/CAAObjectModelerBase.edu/CAAOmbLoadDoc.m</code></td>
     </tr>
   </table>
   <p>where <code>InstallRootDirectory</code> is the root directory of your CAA 
   V5 installation. It is made of a unique source file named CAAOmbLoadDoc.cpp.
   </p>
   <p align="right">[<a href="#Top">Top</a>]</p>
   <!---------------------------------comment------------------------------------->
   <h3><a name="Step"></a>Step-by-Step</h3>
   <p>There are two logical steps in <i>CAAOmbLoadDoc</i>:</p>
   <ol>
     <li><a href="#Load_doc">Loading an Existing Document</a></li>
     <li><a href="#Save_doc">Saving and Removing the Document</a></li>
   </ol>
   <p>We will now comment each of those sections by looking at the code.</p>
   <p align="right">[<a href="#Top">Top</a>]</p>
   <!---------------------------------comment------------------------------------->
   <h4><a name="Load_doc"></a>Loading an Existing Document</h4>
   <ol>
     <li>Create the session
     <table class="code">
       <tr>
         <td>
         <pre>char *sessionName = &quot;CAA2_Sample_Session&quot;;
CATSession *pSession = NULL;
HRESULT rc = <b>::Create_Session</b>(sessionName,
                              pSession);
if ((FAILED(rc)) || (NULL == pSession))
{
   cout &lt;&lt; &quot;ERROR in creating session&quot; &lt;&lt; endl &lt;&lt; flush;
   <b>return </b>1;
}</pre>
         </td>
       </tr>
     </table>
     <p>Since this is a batch program, it is first necessary to open a new 
     session before beginning to work with documents. Do not forget that this 
     session needs to be deleted at the end of the program. Never open more than 
     one session for any given batch program! To open a new session, use the
     <font face="Courier New" size="3"><code>Create_Session</code></font> global 
     function.</li>
     <li>Load the document
     <table class="code">
       <tr>
         <td>
         <pre>CATDocument *pDoc = NULL;
rc = <b>CATDocumentServices::OpenDocument</b>(argv[1], 
                               pDoc);
if (SUCCEEDED(rc) &amp;&amp; (NULL != pDoc)) cout &lt;&lt; &quot;Document opened OK&quot; &lt;&lt; endl &lt;&lt; flush;
else
{
   cout &lt;&lt; &quot;ERROR in opening an existing document&quot; &lt;&lt; endl &lt;&lt; flush;
   <b>return</b> 2;
}</pre>
         </td>
       </tr>
     </table>
     <p>Now that the session is opened, you can load an existing document using 
     the <code>OpenDocument</code> static method of <i>CATDocumentServices</i>. 
     This method <b>requires</b>, as a first parameter, the <b>entire</b> 
     storage path name and document name of the existing document that we want 
     to load into the session. In this use case, we enter this information as an 
     argument to the program. The second parameter of the <code>Open</code> 
     method returns a <i>CATDocument</i> pointer to the document it has loaded.</p>
     <p>Once the document exists in the session, you can work with objects 
     within it, using specific interfaces external to the ObjectModelerBase 
     framework.</li>
   </ol>
   <p align="right">[<a href="#Top">Top</a>]</p>
   <!---------------------------------comment------------------------------------->
   <h4><a name="Save_doc"></a>Saving and Removing the Document</h4>
   <ol>
     <li>Save the document
     <table class="code">
       <tr>
         <td>
         <pre>rc = <b>CATDocumentServices::Save</b> (*pDoc);
if (SUCCEEDED(rc)) cout &lt;&lt; &quot;Document saved OK&quot; &lt;&lt; endl &lt;&lt; flush;
else
{
   cout &lt;&lt; &quot;ERROR in saving document&quot; &lt;&lt; endl &lt;&lt; flush;
   <b>return</b> 3;
}</pre>
         </td>
       </tr>
     </table>
     <p>To save the new document under the same name, use the <code>Save</code> 
     static method of <i>CATDocumentServices</i>. This method takes the <i>
     CATDocument</i> pointer to the document as the only parameter.</li>
     <li>Remove the document
     <table class="code">
       <tr>
         <td>
         <pre>rc = <b>CATDocumentServices::Remove </b>(*pDoc);
if (SUCCEEDED(rc)) cout &lt;&lt; &quot;Document removed OK&quot; &lt;&lt; endl &lt;&lt; flush;
else
{
   cout &lt;&lt; &quot;ERROR in removing document&quot; &lt;&lt; endl &lt;&lt; flush;
   <b>return</b> 4;
}</pre>
         </td>
       </tr>
     </table>
     <p>&lt;&gt;If you ever needed to re-open the document during this same session, 
     it would then be necessary to also remove it from the session after having 
     saved it. Otherwise, you need not worry about it since deleting the session 
     will automatically remove the document as well. To remove the document, you 
     should use the <code>Remove</code> static method of <i>CATDocumentServices</i>.</li>
     <li>Delete the session
     <table class="code">
       <tr>
         <td>
         <pre>rc = <b>::Delete_Session</b>(sessionName);
if (SUCCEEDED(rc)) cout &lt;&lt; &quot;Session deleted OK&quot; &lt;&lt; endl &lt;&lt; flush;
else
{
   cout &lt;&lt; &quot;ERROR in deleting session&quot; &lt;&lt; endl &lt;&lt; flush;
   <b>return</b> 5;
}</pre>
         </td>
       </tr>
     </table>
     <p>Do not forget to delete the session at the end of the program using the
     <code>Delete_Session</code> global function!</li>
   </ol>
   <p align="right">[<a href="#Top">Top</a>]</p>
   <hr>
   <!---------------------------------comment------------------------------------->
   <h3><a name="InShort"></a>In Short</h3>
   <p>This use case has demonstrated how to:</p>
   <ul>
     <li>Load an existing document using the <code>Open</code> static method of
     <i>CATDocumentServices</i></li>
     <li>Save and remove the document using the <code>Save</code> and <code>
     Remove</code> static methods of <i>CATDocumentServices</i>.</li>
   </ul>
   <p align="right">[<a href="#Top">Top</a>]</p>
   <hr>
   <!---------------------------------comment------------------------------------->
   <h3><a name="References"></a>References</h3>
   <table width="100%">
   <tr>
       <td valign="top">[1]</td>
       <td>
       <a href="../CAAOmbTechArticles/CAAOmbDocumentUnderstanding.htm">
       Document Understanding</a></td>
     </tr>
     <tr>
       <td valign="top">[2]</td>
       <td>
       <a href="../CAADocUseCases/CAADocRunSample.htm">
       Building and Launching a CAA V5 Use Case</a></td>
     </tr>
     
     <tr>
       <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
     </tr>
   </table>
   <hr>
   <!---------------------------------comment------------------------------------->
   <h3><a name="History"></a>History</h3>
   <table width="100%">
     <tr>
       <td valign="top">Version: <strong>1</strong> [Feb 2000]</td>
       <td valign="top">Document created</td>
     </tr>
     <tr>
       <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
     </tr>
   </table>
   <hr>
   <!---------------------------------comment------------------------------------->
   <p><i>Copyright © 2000, Dassault Systèmes. All rights reserved.</i></p>

  </body>

</html>

