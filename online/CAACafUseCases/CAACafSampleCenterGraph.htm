<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 6.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<link rel="Stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css">
<title>Center Specification Tree Nodes</title>
</head>

<body>

<table width="100%">
  <tr>
    <td valign="top">
      <h1>3D PLM Enterprise Architecture</h1>
    </td>
    <td valign="top">
      <h2>User Interface - Frame</h2>
    </td>
    <td rowspan="2" align="right" valign="top">
      <h3><a name="Top"></a>Center Specification Tree Nodes</h3>
      <em>How to center specification tree nodes ?</em></td>
  </tr>
  <tr>
    <td class="use" colspan="2">Use Case</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->

<table class="abstract">
  <tr>
    <td>
      <h3>Abstract</h3>
      <p>This article shows how to center nodes of the specification tree.
      <ul>
        <li><a href="#Learn"><strong>What You Will Learn With This Use Case</strong></a></li>
        <li><a href="#UseCase"><strong>The CAACafCenterGraph Use Case</strong></a>
          <ul>
            <li><a href="#What">What Does CAACafCenterGraph Do</a></li>
            <li><a href="#How">How to Launch CAACafCenterGraph</a></li>
            <li><a href="#Where">Where to Find the CAACafCenterGraph Code</a></li>
          </ul>
        <li><a href="#Step"><strong>Step-by-Step</strong></a></li>
        <li><a href="#InShort"><strong>In Short</strong></a></li>
        <li><a href="#References"><strong>References</strong></a></li>
      </ul>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="Learn"></a>What You Will Learn With This Use Case</h3>
<p>This use case is intended to show you how to use the CATCafCenterGraph class 
that is used to center the node of a specification tree. </p>
<p align="right"><a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h3><a name="UseCase"></a>The CAACafCenterGraph Use Case</h3>
<p>CAACafCenterGraph is a use case of the CAACATIAApplicationFrame.edu framework
that illustrates CATIAApplicationFrame and ObjectModelerBase framework
capabilities.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h4><a name="What"></a>What Does CAACafCenterGraph Do</h4>
<p>CAACafCenterGraph contains a command that illustrates usage of the 
CATCafCenterGraph class. Once launched the command waits for a selection in the 
geometry, then makes use of the CATCafCenterGraph class to find and center the 
node associated to the selection in the geometry. The process can be repeated as 
long as the command is active.</p>
<p></p>
<table border="0">
  <caption><i><a name="Fig.1">Fig.1</a>: In this example &quot;Pad.1&quot; is centered in 
	the window as a result of pad selection</i></caption>
  <tr>
    <td>
	<img border="0" src="images/CAACafSampleCenterGraph1.jpg" width="645" height="499"></td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="How"></a>How to Launch CAACafCenterGraph</h4>
<p>To launch CAACafCenterGraph, you will need to set up the build time environment,
then compile CAACafCenterGraph along with its prerequisites, set up the run time
environment, and then execute the use case [<a href="#References">4</a>].&nbsp;</p>
<p>But just before launching the execution, edit the 
CAAApplicationFrame.edu.dico interface dictionary file located in the dictionary 
directory of the CAAApplicationFrame.edu framework:<br>
<br></p>
<table width="100%">
  <tbody>
    <tr>
      <td>Windows</td>
      <td><code>InstallRootDirectory\CAADoc\CAAApplicationFrame.edu\CNext\code\dictionary\</code></td>
    </tr>
    <tr>
      <td>UNIX</td>
      <td><code>InstallRootDirectory/CAADoc/CAAApplicationFrame.edu/CNext/code/dictionary/</code></td>
    </tr>
  </tbody>
</table>
<p>where <code>InstallRootDirectory</code> is the directory where the CAA CD-ROM
is installed.</p>
<p>In this file, remove the &quot;<b>#</b>&quot; character before the two
following lines, and then run mkCreateRuntimeView.</p>
<table class="code">
  <tbody>
    <tr>
      <td>
        <pre>...
#CAAAfrGeneralWksAddin          CATIWorkbenchAddin              libCAAAfrGeneralWksAddin
#CAAAfrGeneralWksAddin          CATIAfrGeneralWksAddin          libCAAAfrGeneralWksAddin
...</pre>
      </td>
    </tr>
  </tbody>
</table>
<p>The two lines deal with the General workshop add-in described in the 
CAAAfrGeneralWksAddin use case [<a href="#References">3</a>] located in the 
CAAAfrGeneralWksAddin.m module (CAAApplicationFrame.edu framework)</p>
<p>Then, in the window where you run the mkrun command, do not type the module
name on the command line, but type CNEXT instead. When the application is ready,
do the following:</p>
<ol>
  <li>On the <b>File </b>menu, click <b>New</b>
  <li><b>File New </b>Dialog box click <b>Part</b>&nbsp; and click <b>OK</b>
  <li>Create<b> Point, Line, Pad,</b> ....</li>
  <li>On the power input type &quot;c:Center Graph Demonstrator&quot;
  <li>Select objects in 3D, see the effect in specification tree</li>
  <li>On the <b>Start </b>menu, click <b>Exit</b></li>
</ol>
<p align="right">[<a href="#Top">Top</a>]</p>

<!---------------------------------comment------------------------------------->

<h4><a name="Where"></a>Where to Find the CAACafCenterGraph Code</h4>
<p>The CAACafCenterGraph use case is made of two classes:</p>
<ul>
  <li><i><b>CAACafCenterGraphCmd</b></i> class located in the
    CAACafCenterGraph.m module of the CAACATIAApplicationFrm.edu framework:</li>
  <p>This <i>CATStateCommand</i> class enables the end user to expand and center nodes 
	of the specification tree. The header file (.h)
  and the source file (.cpp) are located in the LocalInterfaces and src
  directories respectively. The source file is amply commented in this article.</p>
  <table>
    <tr>
      <td>Windows</td>
      <td><code>InstallRootDirectory\CAADoc\CAACATIAApplicationFrm.edu\CAACafCenterGraph.m\</code></td>
    </tr>
    <tr>
      <td>Unix</td>
      <td><code>InstallRootDirectory/CAADoc/CAACATIAApplicationFrm.edu/CAACafCenterGraph.m/</code></td>
    </tr>
  </table>
  <p>where <code>InstallRootDirectory</code> is the directory where the CAA
  CD-ROM is installed.</p>
	<p>&nbsp;</p>
  <li><i><b>CAAAfrGeneralWksAdn </b></i>class located in the 
	CAAAfrGeneralWksAddin.m
    module of the CAAApplicationFrame.edu framework</li>
  <p>This class, not detailed there, defines add-in of the General workshop. 
	This add-in contains the Center Graph Demonstrator command.Refer to the 
	Where to Find the CAAAfrGeneralWksAddin Code section of the 
	CAAAfrGeneralWksAddin [<a href="#References">3</a>] use case for details.</p>
  </ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->

<h3><a name="Step"></a>Step-by-Step</h3>
<p>There are two logical steps in CAACafCenterGraph :</p>
<ol>
  <li><a href="#Implementing the BuildGraph Method">Implementing the BuildGraph method</a></li>
  <li><a href="#Centering the graph on the Selected Object">Centering the graph on the Selected Object</a></li>
</ol>
<p align="right">[<a href="#Top">Top</a>]</p>
<h4><a name="Implementing the BuildGraph Method"></a>Implementing the BuildGraph
Method</h4>
<p>As usual the <code>BuildGraph</code> method is divided in three parts:</p>
<ol>
  <li>Creating the agents</li>
  <li>Creating the states</li>
  <li>Creating the transitions between states according to the agents.</li>
</ol>
<table class="code">
  <tr>
    <td>
      <pre>...</pre>
		<pre>   _daObjectToCenterNode = new CATPathElementAgent(&quot;SelObjectToCenterNodeId&quot;);
   _daObjectToCenterNode-&gt;AddElementType(IID_CATINavigateObject);
   _daObjectToCenterNode-&gt;SetBehavior(CATDlgEngRepeat | CATDlgEngNewHSOManager | CATDlgEngWithPSOHSO );

   CATDialogState *stGetObjState = GetInitialState(&quot;stGetObjStateId&quot;);
   stGetObjState-&gt;AddDialogAgent(_daObjectToCenterNode);

   CATDialogTransition *pTransition = AddTransition
   (
       stGetObjState,
       stGetObjState,
       IsLastModifiedAgentCondition(_daObjectToCenterNode) , 
       Action((ActionMethod) &amp; CAACafCenterGraphCmd::CenterGraphOnObject)
   ); 

...</pre>
    </td>
  </tr>
</table>
<p><code>_daObjectToCenterNode</code> is an acquisition agent to select an
object in the specification tree or in 3D. After the selection, the object is highlighted (specify by the <code>CATDlgEngWithPSOHSO</code>
behavior). The <code>CATDlgEngRepeat</code> behavior enables you to re-use the
agent without reinitializing it.&nbsp;The <code>CATDlgEngNewHSOManager</code> empties the HSO 
before each selection.</p>
<p>This state command has only one state, <code>stGetObjState</code> ,
whose name is <code>stGetObjStateId</code>.&nbsp;</p>
<p>When the end user selects a valid element, the unique transition is triggered
and the <code>CenterGraphOnObject</code> method is called.&nbsp;</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<h4 align="left"><a name="Centering the graph on the Selected Object"></a>
Centering the graph on the Selected Object</h4>
<p align="left">The first part of the <code>CenterGraphOnObject</code> method consists
in retrieving the <code>CATNavigBox</code> instance corresponding to the tree 
you want to center. In the case of this sample it is the specification tree of 
the window.</p>
<table class="code">
  <tr>
    <td>
      <pre>...</pre>
		<pre> // Retrieves the current window 
CATFrmLayout * pLayout = CATFrmLayout::GetCurrentLayout();
if ( NULL == pLayout ) return TRUE;

CATFrmWindow * pCurrentWindow = pLayout-&gt;GetCurrentWindow();
if ( NULL == pCurrentWindow ) return TRUE;

// If it is a CATFrmNavigGraphicWindow, it is possible to
// retrieve a CATNavigBox pointer
//
if ( 1 != pCurrentWindow-&gt;IsAKindOf(&quot;CATFrmNavigGraphicWindow&quot;) ) return TRUE;

CATFrmNavigGraphicWindow * pFrmNavigGraphicWindow = 
(CATFrmNavigGraphicWindow*) pCurrentWindow ;

CATNavigBox * pNavigBox = NULL ;
pNavigBox = pFrmNavigGraphicWindow-&gt;GetNavigBox();

...</pre>
    </td>
  </tr>
</table>
<p align="left">Then the actual job is done by instanciating a <code>CATCafCenterGraph</code> 
class and calling the CenterGraph method on it.</p>
<table class="code">
  <tr>
    <td>
      <pre>...</pre>
		<pre>CATCafCenterGraph CenterGraphObj;
CenterGraphObj.CenterGraph(&quot;OnHSO&quot;,pNavigBox);

...</pre>
    </td>
  </tr>
</table>

<p align="left">The first argument is &quot;OnHSO&quot; because we want to center 
the tree on the 
highlighted object. The second argument is the pointer to the <code>CATNavigBox</code> instance 
that was retrieved in the first part of the method. </p>
<p align="left">For information, please note that actual code run by the 
&quot;CenterGraph&quot; method is the same as the one run by the interactive command 
&quot;Center Graph&quot; that can be found in V5 in object contextual menu.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="InShort"></a>In Short</h3>
<p>This use case explains how to find and center an element of the specification 
tree in the window.&nbsp;&nbsp;</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<!---------------------------------comment------------------------------------->

<h3><a name="References"></a>References</h3>
<table width="100%">
  <tr>
    <td valign="top">[1]</td>
    <td><a href="../CAAOmbUseCases/CAAOmbGeoNavigate.htm">The
      Object Navigator</a></td>
  </tr>
  <tr>
    <td valign="top">[2]</td>
    <td><a href="../CAADegTechArticles/CAADegGettingStarted.htm">Getting
      Started with State Dialog Commands</a></td>
  </tr>
  <tr>
    <td valign="top">[3]</td>
    <td>
	<a href="../CAAAfrUseCases/CAAAfrSampleGeneralWksAddin.htm">
	Making Your Document Independent Command Available in All Workbenches</a></td>
  </tr>
  <tr>
    <td valign="top">[4]</td>
    <td><a href="../CAADocUseCases/CAADocRunSample.htm">Building
      and Launching a CAA V5 Use Case</a></td>
  </tr>
  <tr>
    <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="History"></a>History</h3>
<table width="100%">
  <tr>
    <td valign="top">Version: <strong>1</strong> [March 2006]</td>
    <td valign="top">Document created</td>
  </tr>
  <tr>
    <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<p><i>Copyright © 2006, Dassault Systèmes. All rights reserved.</i></p>

</body>

</html>
