<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<link rel="Stylesheet" type="text/css" href="../CAADocStyleSheets/caav5.css">
<title>Customizing Opposite Hand Machining</title>
</head>

<body>

<table width="100%">
  <tr>
    <td valign="top">
      <h1>Machining</h1>
    </td>
    <td valign="top">
      <h2>NC Review</h2>
    </td>
    <td rowspan="2" align="right" valign="top">
      <h3><a name="Top"></a>User Opposite Hand Machining</h3>
      Implementing <i>CATIMfgUserReverseMachiningConditions</i>, <i>CATIMfgUserOppositeHandMachiningOptions</i> and 
	  <i>CATICreateInstance</i></td>
  </tr>
  <tr>
    <td class="use" colspan="2">Use Case</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<table class="abstract">
  <tr>
    <td>
      <h3>Abstract</h3>
      <p>This article discusses the CAAMaiUserOppositeHandMachining use case.</p>
      <ul>
        <li><a href="#Learn"><strong>What You Will Learn With This Use Case</strong></a></li>
        <li><a href="#UseCase"><strong>The CAAMaiUserOppositeHandMachining Use Case</strong></a>
          <ul>
            <li><a href="#What">What Does CAAMaiUserOppositeHandMachining Do</a></li>
            <li><a href="#How">How to Launch CAAMaiUserOppositeHandMachining</a></li>
            <li><a href="#Where">Where to Find the CAAMaiUserOppositeHandMachining
              Code</a></li>
          </ul>
        <li><a href="#Step"><strong>Step-by-Step</strong></a></li>
        <li><b><a href="#InShort">In Short</a></b></li>
        <li><b><a href="#References">References</a></b></li>
      </ul>
    </td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="Learn"></a>What You Will Learn With This Use Case</h3>
<p>This use case helps you to define reverse machining conditions for
a user-operation (<i>CATIMfgUserReverseMachiningConditions</i>), and to set its check-box name 
and associated setting names of the <i>Opposite Hand Machining Options</i> panel 
(<i>CATIMfgUserOppositeHandMachiningOptions</i> and <i>CATICreateInstance</i>).</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h3><a name="UseCase"></a>The CAAMaiUserOppositeHandMachining Use Case</h3>
<p>CAAMaiUserOppositeHandMachining is a use case of the CAAManufacturingItf.edu
framework that illustrates ManufacturingInterfaces framework capabilities.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="What"></a>What Does CAAMaiUserOppositeHandMachining Do</h4>
<p>CAAMaiUserOppositeHandMachining provides an implementation of <i>CATIMfgUserReverseMachiningConditions</i> 
for a Profile Contouring operation, and an implementation of <i>CATIMfgUserOppositeHandMachiningOptions</i> 
and <i>CATICreateInstance</i> to set its check-box name (<i>CAA Profile Contouring</i>) and associated setting names 
of the <i>Opposite Hand Machining Options</i> panel.
.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="How"></a>How to Launch CAAMaiUserOppositeHandMachining</h4>
<p>To launch CAAMaiUserOppositeHandMachining, you will need to :</p>
<ul>
  <li>Set up the build time environment, then compile
    CAAMaiUserOppositeHandMachining.m module along with its prerequisites [<a href="#References">1</a>]</li>
  <li>Edit the interface dictionary, that is, the CAAManufacturingItf.edu.dico
    file located in:
    <table width="100%">
      <tr>
        <td>Windows</td>
        <td><code>InstallRootDirectory\CAADoc\CAAManufacturingItf.edu\CNext\code\dictionary\</code></td>
      </tr>
      <tr>
        <td>Unix</td>
        <td><code>InstallRootDirectory/CAADoc/CAAManufacturingItf.edu/CNext/code/dictionary/</code></td>
      </tr>
    </table>
    <p>where <code>InstallRootDirectory</code> is the directory where the CAA
    CD-ROM is installed, and decomment the following line by removing the '#CAA#'
    character:</p>
    <pre>ProfileContouring                       CATIMfgUserReverseMachiningConditions   libCAAMaiUserOppositeHandMachining</pre>
    <pre>CAAEMaiUserOppositeHandMachiningOptions CATIMfgUserOppositeHandMachiningOptions libCAAMaiUserOppositeHandMachining</pre>
    <pre>CAAEMaiUserOppositeHandMachiningOptions CATICreateInstance                      libCAAMaiUserOppositeHandMachining</pre>
  </li>
  <li>Set up the run time environment</li>
  <li>Launch a CATIA V5 session</li>
  <li>Open the CAAMaiUserOHM.CATProcess file located in:
    <table width="100%">
      <tr>
        <td>Windows</td>
        <td><code>InstallRootDirectory\CAADoc\CAAManufacturingItf.edu\CNext\resources\graphic\</code></td>
      </tr>
      <tr>
        <td>Unix</td>
        <td><code>InstallRootDirectory/CAADoc/CAAManufacturingItf.edu/CNext/resources/graphic/</code></td>
      </tr>
    </table>
  </li>
  <li>Click on the <i>Opposite Hand Machining Options</i> icon of the <i>Auxiliary Operations</i> toolbar :
  <p><img border="0" src="images/CAAMaiOHMOptionsIcon.jpg" width="40" height="40"></p>
  Notice the <i>CAA Profile Contouring</i> check-box at the end of the list :
  <p><img border="0" src="images/CAAMaiUserOHMOptions.jpg" width="300" height="250"></p>
  </li>
  <li>In the PPR Tree, select/edit Profile Contouring.1, and notice the relimiting elements
  <i>Limit1</i> and <i>Limit2</i> :
  <p><img border="0" src="images/CAAMaiUserRMC01.jpg" width="600" height="500"></p>
  </li>
  <li>Click on the <i>Reverse Machining Conditions</i> icon of the <i>Auxiliary Operations</i> toolbar :
  <p><img border="0" src="images/CAAMaiRMCIcon.jpg" width="40" height="40"></p>
  Notice that the relimiting elements have been swaped :
  <p><img border="0" src="images/CAAMaiUserRMC02.jpg" width="600" height="500"></p>
  </li>
</ul>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Where"></a>Where to Find the CAAMaiUserOppositeHandMachining Code</h4>
<p>The CAAMaiUserOppositeHandMachining use case is located in :</p>
<table width="100%">
  <tr>
    <td>Windows</td>
    <td><code>InstallRootDirectory\CAADoc\CAAManufacturingItf.edu\CAAMaiUserOppositeHandMachining.m</code></td>
  </tr>
  <tr>
    <td>Unix</td>
    <td><code>InstallRootDirectory/CAADoc/CAAManufacturingItf.edu/CAAMaiUserOppositeHandMachining.m</code></td>
  </tr>
</table>
<p>where <code>InstallRootDirectory</code> is the directory where the CAA CD-ROM
is installed.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step"></a>Step-by-Step</h4>
<p>There are three logical steps in CAAMaiUserOppositeHandMachining:</p>
<ol>
  <li>Create an extension class to implement <i>CATIMfgUserReverseMachiningConditions</i> for a user-operation</li>
  <li>Create an implementation class of <i>CATIMfgUserOppositeHandMachiningOptions</i></li>
  <li>Create an extension class to implement <i>CATICreateInstance</i></li>
</ol>
<p>We now comment these sections by looking at the code.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<!---------------------------------comment------------------------------------->
<h4><a name="Step1"></a>Create an extension class to implement <i>CATIMfgUserReverseMachiningConditions</i> for a user-operation</h4>
<p>The sample extension class of a Profile Contouring implementing <i>CATIMfgUserReverseMachiningConditions</i> 
is named <i>CAAEMaiUserReverseMachiningConditions</i> :</p>
<table class="code">
  <tr>
    <td>
      <pre>
#include &quot;CAAEMaiUserReverseMachiningConditions.h&quot;

#include &quot;CATBaseUnknown.h&quot;
#include &quot;CATIMfgActivity.h&quot;
#include &quot;CATSettingRepository.h&quot;
#include &quot;CATListOfCATBaseUnknown.h&quot;
#include &quot;CATIMfgProfileContouringRelimitingElement.h&quot;

//-----------------------------------------------------------------------------
// Supported Interface
//-----------------------------------------------------------------------------
#include &quot;TIE_CATIMfgUserReverseMachiningConditions.h&quot;
TIE_CATIMfgUserReverseMachiningConditions(CAAEMaiUserReverseMachiningConditions);
CATImplementClass(CAAEMaiUserReverseMachiningConditions,DataExtension,CATBaseUnknown,ProfileContouring);

//-----------------------------------------------------------------------------
// Constructor
//-----------------------------------------------------------------------------
CAAEMaiUserReverseMachiningConditions::CAAEMaiUserReverseMachiningConditions() {}

//-----------------------------------------------------------------------------
// Destructor
//-----------------------------------------------------------------------------
CAAEMaiUserReverseMachiningConditions::~CAAEMaiUserReverseMachiningConditions() {}

//-----------------------------------------------------------------------------
// ReverseMachiningConditions
//-----------------------------------------------------------------------------
HRESULT CAAEMaiUserReverseMachiningConditions::ReverseMachiningConditions()
{
	HRESULT RC = S_OK;
	{
		int SettingsOKForReverseCAAProfileContouring=0;
		CATSettingRepository* pOperation = CATSettingRepository::GetRepository(&quot;NCMfgOperation&quot;);
		if (NULL!=pOperation)
		{
			pOperation -&gt; ReadSetting(&quot;ReverseMO_CAAProfileContouring&quot;,&amp;SettingsOKForReverseCAAProfileContouring);
		}

		if (SettingsOKForReverseCAAProfileContouring==1)
		{
			CATIMfgActivity_var hActivity(GetImpl());
			if (NULL_var!=hActivity)
			{
				CATBaseUnknown_var hFeature = hActivity -&gt; GetFeatureInContext();
				if (NULL_var!=hFeature)
				{
					CATIMfgProfileContouringRelimitingElement_var hPCRE(hFeature);
					if (NULL_var!=hPCRE)
					{
						// Swap start/end relimiting geometry
						CATUnicodeString StartPos,EndPos;
						double StartOffset=0.,EndOffset=0.;
						CATBaseUnknown_var hStartProduct,hEndProduct;
						CATLISTP(CATBaseUnknown) LOStartElt,LOEndElt;
						CATUnicodeString UStart(&quot;StartElement&quot;),UEnd(&quot;EndElement&quot;);

						RC = hPCRE -&gt; GetRelimitingGeometry(UStart,LOStartElt,hStartProduct,StartOffset,StartPos);
						if (FAILED(RC)) goto LABEL_END;
						RC = hPCRE -&gt; GetRelimitingGeometry(UEnd  ,LOEndElt  ,hEndProduct  ,EndOffset  ,EndPos);
						if (FAILED(RC)) goto LABEL_END;

						RC = hPCRE -&gt; SetRelimitingGeometry(UStart,LOEndElt  ,hEndProduct  ,EndOffset  ,EndPos);
						if (FAILED(RC)) goto LABEL_END;
						RC = hPCRE -&gt; SetRelimitingGeometry(UEnd  ,LOStartElt,hStartProduct,StartOffset,StartPos);
						if (FAILED(RC)) goto LABEL_END;
					}
				}
			}
		}
	}
LABEL_END:
	return RC;
}
      </pre>
    </td>
  </tr>
</table>
<!---------------------------------comment------------------------------------->
<h4><a name="Step2"></a>Create an implementation class of <i>CATIMfgUserOppositeHandMachiningOptions</i></h4>
<p>The sample implementation class of <i>CATIMfgUserOppositeHandMachiningOptions</i> is named <i>CAAEMaiUserOppositeHandMachiningOptions</i> :</p>
<table class="code">
  <tr>
    <td>
      <pre>
#include &quot;CAAEMaiUserOppositeHandMachiningOptions.h&quot;

#include &quot;CATBaseUnknown.h&quot;

//-----------------------------------------------------------------------------
// Supported Interface
//-----------------------------------------------------------------------------
#include &quot;TIE_CATIMfgUserOppositeHandMachiningOptions.h&quot;
TIE_CATIMfgUserOppositeHandMachiningOptions(CAAEMaiUserOppositeHandMachiningOptions);
CATImplementClass(CAAEMaiUserOppositeHandMachiningOptions,Implementation,CATBaseUnknown,CATNull);

//-----------------------------------------------------------------------------
// Constructor
//-----------------------------------------------------------------------------
CAAEMaiUserOppositeHandMachiningOptions::CAAEMaiUserOppositeHandMachiningOptions(): CATBaseUnknown() {}

//-----------------------------------------------------------------------------
// Destructor
//-----------------------------------------------------------------------------
CAAEMaiUserOppositeHandMachiningOptions::~CAAEMaiUserOppositeHandMachiningOptions() {}

//-----------------------------------------------------------------------------
// GetNames
//-----------------------------------------------------------------------------
HRESULT CAAEMaiUserOppositeHandMachiningOptions::GetNames(CATUnicodeString &amp; oOperationName, CATUnicodeString &amp; oSettingName, CATUnicodeString &amp; oRepositoryName)
{
	HRESULT RC=S_OK;
	{
		oOperationName  = &quot;CAA Profile Contouring&quot;;
		oSettingName    = &quot;ReverseMO_CAAProfileContouring&quot;;
		oRepositoryName = &quot;NCMfgOperation&quot;;
	}
	return RC;
}
      </pre>
    </td>
  </tr>
</table>
<!---------------------------------comment------------------------------------->
<h4><a name="Step3"></a>Create an implementation class to implement <i>CATICreateInstance</i></h4>
<p>The sample extension class of CAAEMaiUserOppositeHandMachiningOptions implementing <i>CATICreateInstance</i> 
is named <i>CAAEMaiUserOppositeHandMachiningOptionsInst</i> :</p>
<table class="code">
  <tr>
    <td>
      <pre>
#include &quot;CAAEMaiUserOppositeHandMachiningOptionsInst.h&quot;

#include &quot;CAAEMaiUserOppositeHandMachiningOptions.h&quot;

//-----------------------------------------------------------------------------
// Supported Interface
//-----------------------------------------------------------------------------
#include &quot;TIE_CATICreateInstance.h&quot;
TIE_CATICreateInstance( CAAEMaiUserOppositeHandMachiningOptionsInst);
CATImplementClass(CAAEMaiUserOppositeHandMachiningOptionsInst,CodeExtension,CATNull,CAAEMaiUserOppositeHandMachiningOptions);
 
//-----------------------------------------------------------------------------
// Constructor
//-----------------------------------------------------------------------------
CAAEMaiUserOppositeHandMachiningOptionsInst::CAAEMaiUserOppositeHandMachiningOptionsInst(): CATBaseUnknown() {}

//-----------------------------------------------------------------------------
// Destructor
//-----------------------------------------------------------------------------
CAAEMaiUserOppositeHandMachiningOptionsInst::~CAAEMaiUserOppositeHandMachiningOptionsInst() {}

//-----------------------------------------------------------------------------
// CreateInstance
//-----------------------------------------------------------------------------
HRESULT __stdcall CAAEMaiUserOppositeHandMachiningOptionsInst::CreateInstance (void ** oPPV)
{
    CAAEMaiUserOppositeHandMachiningOptions * pt = new CAAEMaiUserOppositeHandMachiningOptions();
    
    *oPPV = (void*) pt;
    
    if (NULL != pt)
        return S_OK;
    else
        return E_FAIL;
}
      </pre>
    </td>
  </tr>
</table>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="InShort"></a>In Short</h3>
<p>This article provides an example on how to use the manufacturing interface
classes to customize <i>Opposite Hand Machining</i>.</p>
<p align="right">[<a href="#Top">Top</a>]</p>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="References"></a>References</h3>
<table width="100%">
  <tr>
    <td valign="top">[1]</td>
    <td><a href="../CAADocUseCases/CAADocRunSample.htm">Building
      and Launching a CAA V5 Use Case</a></td>
  </tr>
  <tr>
    <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<h3><a name="History"></a>History</h3>
<table width="100%">
  <tr>
    <td valign="top">Version: <strong>1</strong> [September 2004]</td>
    <td valign="top">Document created</td>
  </tr>
  <tr>
    <td valign="top" align="right" colspan="2">[<a href="#Top">Top</a>]</td>
  </tr>
</table>
<hr>
<!---------------------------------comment------------------------------------->
<p><i>Copyright © 2000, Dassault Systèmes. All rights reserved.</i></p>

</body>

</html>
